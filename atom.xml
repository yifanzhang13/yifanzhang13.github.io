<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Flog</title>
  
  <subtitle>é˜¿é…±æ—¥å¸¸å†™ç çš„ç¢ç¢å¿µ</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yifanzhang13.github.io/"/>
  <updated>2020-07-30T08:05:19.247Z</updated>
  <id>http://yifanzhang13.github.io/</id>
  
  <author>
    <name>é˜¿é…± a.k.a. Yifan Zhang</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ã€Œå‰‘æŒ‡Offerç³»åˆ—é¢˜è§£ã€</title>
    <link href="http://yifanzhang13.github.io/2020/07/20/%E5%89%91%E6%8C%87Offer_%E8%A7%A3%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    <id>http://yifanzhang13.github.io/2020/07/20/%E5%89%91%E6%8C%87Offer_%E8%A7%A3%E9%A2%98%E8%AE%B0%E5%BD%95/</id>
    <published>2020-07-20T08:29:34.000Z</published>
    <updated>2020-07-30T08:05:19.247Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰‘æŒ‡Offer-è§£é¢˜è®°å½•"><a href="#å‰‘æŒ‡Offer-è§£é¢˜è®°å½•" class="headerlink" title="å‰‘æŒ‡Offer_è§£é¢˜è®°å½•"></a>å‰‘æŒ‡Offer_è§£é¢˜è®°å½•</h1><ul><li>ğŸ“åˆ†äº«å’Œè®°å½•åšé¢˜çš„æ€è·¯</li><li>å“ˆå“ˆ</li></ul><a id="more"></a><h2 id="Common-Used-Class"><a href="#Common-Used-Class" class="headerlink" title="Common Used Class"></a>Common Used Class</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Definition of a single-linked list node</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span> </span>&#123;</span><br><span class="line"> <span class="keyword">int</span> val;</span><br><span class="line"> ListNode next;</span><br><span class="line"> ListNode(<span class="keyword">int</span> x) &#123; val = x; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> val;</span><br><span class="line">    Node next;</span><br><span class="line">    Node random;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.val = val;</span><br><span class="line">        <span class="keyword">this</span>.next = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">this</span>.random = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> val;</span><br><span class="line">    <span class="keyword">public</span> Node left;</span><br><span class="line">    <span class="keyword">public</span> Node right;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(<span class="keyword">int</span> _val)</span> </span>&#123;</span><br><span class="line">        val = _val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(<span class="keyword">int</span> _val,Node _left,Node _right)</span> </span>&#123;</span><br><span class="line">        val = _val;</span><br><span class="line">        left = _left;</span><br><span class="line">        right = _right;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="LinkedList"><a href="#LinkedList" class="headerlink" title="LinkedList"></a><strong>LinkedList</strong></h2><h3 id="06-ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨"><a href="#06-ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨" class="headerlink" title="06-ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨ "></a><a href="https://leetcode-cn.com/problems/cong-wei-dao-tou-da-yin-lian-biao-lcof/">06-ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨ </a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeadTailLinkedNode_06</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œä»å°¾åˆ°å¤´åè¿‡æ¥è¿”å›æ¯ä¸ªèŠ‚ç‚¹çš„å€¼ï¼ˆç”¨æ•°ç»„è¿”å›ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">     * ç¤ºä¾‹ 1ï¼š</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * è¾“å…¥ï¼šhead = [1,3,2]</span></span><br><span class="line"><span class="comment">     * è¾“å‡ºï¼š[2,3,1]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_06_0</span></span>&#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºä¸€ä¸ªarraylistæ¥å‚¨å­˜ä»å°¾åˆ°å¤´çš„element</span></span><br><span class="line">    ArrayList&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] reversePrint(ListNode head) &#123;</span><br><span class="line">        recur(head);</span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªlistå¤§å°çš„æ•°ç»„</span></span><br><span class="line">        <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[list.size()];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;list.size();i++)&#123;</span><br><span class="line">            res[i] = list.get(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">recur</span><span class="params">(ListNode node)</span></span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è¿™æ˜¯ä¸€ä¸ªé€’å½’æ–¹æ³•</span></span><br><span class="line"><span class="comment">         * ç»ˆæ­¢æ¡ä»¶ï¼šå½“nodeä¸ºnullçš„æ—¶å€™è¯´æ˜å·²ç»åˆ°å°¾å·´äº†</span></span><br><span class="line"><span class="comment">         * å½“ç»ˆæ­¢é€’å½’çš„æ—¶å€™å¼€å§‹å›æœ”</span></span><br><span class="line"><span class="comment">         * å›æœ”ä¼šä»å°¾å·´åˆ°å¤´ä¸€ä¸ªä¸€ä¸ªçš„é€šè¿‡list.add(node.val)æŠŠå€¼åŠ åˆ°listä¸­</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span>(node == <span class="keyword">null</span>) <span class="keyword">return</span>;</span><br><span class="line">        recur(node.next);</span><br><span class="line">        list.add(node.val);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="22-é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªç»“ç‚¹"><a href="#22-é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªç»“ç‚¹" class="headerlink" title="22-é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªç»“ç‚¹ "></a><a href="https://leetcode-cn.com/problems/lian-biao-zhong-dao-shu-di-kge-jie-dian-lcof/">22-é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªç»“ç‚¹ </a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">getKthFromEnd_22</span> </span>&#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¾“å…¥ä¸€ä¸ªé“¾è¡¨ï¼Œè¾“å‡ºè¯¥é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹ã€‚ä¸ºäº†ç¬¦åˆå¤§å¤šæ•°äººçš„ä¹ æƒ¯ï¼Œæœ¬é¢˜ä»1å¼€å§‹è®¡æ•°ï¼Œå³é“¾è¡¨çš„å°¾èŠ‚ç‚¹æ˜¯å€’æ•°ç¬¬1ä¸ªèŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªé“¾è¡¨æœ‰6ä¸ªèŠ‚ç‚¹ï¼Œä»å¤´èŠ‚ç‚¹å¼€å§‹ï¼Œå®ƒä»¬çš„å€¼ä¾æ¬¡æ˜¯1ã€2ã€3ã€4ã€5ã€6ã€‚è¿™ä¸ªé“¾è¡¨çš„å€’æ•°ç¬¬3ä¸ªèŠ‚ç‚¹æ˜¯å€¼ä¸º4çš„èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ç¤ºä¾‹ï¼š</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ç»™å®šä¸€ä¸ªé“¾è¡¨: 1-&gt;2-&gt;3-&gt;4-&gt;5, å’Œ k = 2.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * è¿”å›é“¾è¡¨ 4-&gt;5.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_22_0</span></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿™ä¸ªæ˜¯é€’å½’çš„è§£æ³•</span></span><br><span class="line"><span class="comment">     * é€šè¿‡é€’å½’å¾—åˆ°ä¸€ä¸ªå‚¨å­˜ä»å°¾åˆ°å¤´çš„å…ƒç´ çš„list</span></span><br><span class="line"><span class="comment">     * ç„¶åç›´æ¥é€šè¿‡index k æ¥å¾—åˆ°ç­”æ¡ˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    ArrayList&lt;ListNode&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">boolean</span> FindOrNot = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">int</span> count=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">getKthFromEnd</span><span class="params">(ListNode head, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å…ˆé€’å½’ï¼ŒæŠŠelementä»å°¾å·´åˆ°å¤´å‚¨å­˜åˆ°listä¸­</span></span><br><span class="line">        recur(head);</span><br><span class="line">        <span class="keyword">return</span> list.get(k-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">recur</span><span class="params">(ListNode node)</span></span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * é€’å½’è§£å†³</span></span><br><span class="line"><span class="comment">         * ä»å°¾å·´åˆ°å¤´ä¾æ¬¡æŠŠelementåŠ åˆ°listä¸­</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (node==<span class="keyword">null</span>) <span class="keyword">return</span>;</span><br><span class="line">        recur(node.next);</span><br><span class="line">        list.add(node);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">solution_22_1</span></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿™é¢˜ç”¨åŒæŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">     * ç®—æ³•æµç¨‹ï¼š</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * åˆå§‹åŒ–ï¼š å‰æŒ‡é’ˆ former ã€åæŒ‡é’ˆ latter ï¼ŒåŒæŒ‡é’ˆéƒ½æŒ‡å‘å¤´èŠ‚ç‚¹ headâ€‹ ã€‚</span></span><br><span class="line"><span class="comment">     * æ„å»ºåŒæŒ‡é’ˆè·ç¦»ï¼š å‰æŒ‡é’ˆ former å…ˆå‘å‰èµ° kkk æ­¥ï¼ˆç»“æŸåï¼ŒåŒæŒ‡é’ˆ former å’Œ latter é—´ç›¸è· kkk æ­¥ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">     * åŒæŒ‡é’ˆå…±åŒç§»åŠ¨ï¼š å¾ªç¯ä¸­ï¼ŒåŒæŒ‡é’ˆ former å’Œ latter æ¯è½®éƒ½å‘å‰èµ°ä¸€æ­¥ï¼Œç›´è‡³ former èµ°è¿‡é“¾è¡¨ å°¾èŠ‚ç‚¹ æ—¶è·³å‡ºï¼ˆè·³å‡ºåï¼Œ latter ä¸å°¾èŠ‚ç‚¹è·ç¦»ä¸º kâˆ’1k-1kâˆ’1ï¼Œå³ latter æŒ‡å‘å€’æ•°ç¬¬ kkk ä¸ªèŠ‚ç‚¹ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">     * è¿”å›å€¼ï¼š è¿”å› latter å³å¯ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">getKthFromEnd</span><span class="params">(ListNode head, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ä¸¤ä¸ªæŒ‡é’ˆæœ€åˆéƒ½æŒ‡å‘head</span></span><br><span class="line">        ListNode former=head, latter=head;</span><br><span class="line">        <span class="comment">//å…ˆè®©formeræŒ‡é’ˆç§»åŠ¨kä¸ªä½ç½®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;i++)&#123;</span><br><span class="line">            <span class="comment">//å¦‚æœåªæœ‰ä¸€ä¸ªnodeå°±æ˜¯headï¼Œåˆ™ç›´æ¥è¿”å›latter</span></span><br><span class="line">            <span class="keyword">if</span> (former==<span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            former = former.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å½“formerç§»åŠ¨åˆ°å¤´ï¼Œä¹Ÿå°±æ˜¯å½“formerç­‰äºnullçš„æ—¶å€™ï¼Œlatterå°±åˆ°è¾¾å€’æ•°ç¬¬kä¸ªelementï¼Œè¿™æ—¶å†è¿”å›latter</span></span><br><span class="line">        <span class="keyword">while</span>(former!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            former = former.next;</span><br><span class="line">            latter = latter.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> latter;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="24-åè½¬é“¾è¡¨"><a href="#24-åè½¬é“¾è¡¨" class="headerlink" title="24-åè½¬é“¾è¡¨"></a><a href="https://leetcode-cn.com/problems/fan-zhuan-lian-biao-lcof/">24-åè½¬é“¾è¡¨</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">reverseList_24</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œåè½¬è¯¥é“¾è¡¨å¹¶è¾“å‡ºåè½¬åé“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ç¤ºä¾‹:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * è¾“å…¥: 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULL</span></span><br><span class="line"><span class="comment">     * è¾“å‡º: 5-&gt;4-&gt;3-&gt;2-&gt;1-&gt;NULL</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_24_0</span></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿™æ˜¯ä¸€ä¸ªåœŸåŠæ³•</span></span><br><span class="line"><span class="comment">     * å…ˆç”¨listä»å°¾åˆ°å¤´æ¥å‚¨å­˜nodeçš„å€¼</span></span><br><span class="line"><span class="comment">     * ç„¶ååˆ©ç”¨é€’å½’æŠŠæ¯ä¸€ä¸ªnodeçš„valæ›´æ¢ä¸ºlistä¸­å·²ç»åè½¬çš„å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ArrayList&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">reverseList</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">        recur(head);</span><br><span class="line">        recur1(head);</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">recur</span><span class="params">(ListNode node)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å…ˆç”¨é€’å½’æŠŠæ‰€æœ‰çš„nodeå­˜èµ·æ¥</span></span><br><span class="line">        <span class="keyword">if</span> (node==<span class="keyword">null</span>) <span class="keyword">return</span>;</span><br><span class="line">        recur(node.next);</span><br><span class="line">        list.add(node.val);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">recur1</span><span class="params">(ListNode node)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (node==<span class="keyword">null</span>) <span class="keyword">return</span>;</span><br><span class="line">        node.val=list.get(i++);</span><br><span class="line">        recur1(node.next);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="25-åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨"><a href="#25-åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨" class="headerlink" title="25-åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨"></a><a href="https://leetcode-cn.com/problems/he-bing-liang-ge-pai-xu-de-lian-biao-lcof/">25-åˆå¹¶ä¸¤ä¸ªæ’åºçš„é“¾è¡¨</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">mergeTwoLists_25</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¾“å…¥ä¸¤ä¸ªé€’å¢æ’åºçš„é“¾è¡¨ï¼Œåˆå¹¶è¿™ä¸¤ä¸ªé“¾è¡¨å¹¶ä½¿æ–°é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ä»ç„¶æ˜¯é€’å¢æ’åºçš„ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ç¤ºä¾‹1ï¼š</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * è¾“å…¥ï¼š1-&gt;2-&gt;4, 1-&gt;3-&gt;4</span></span><br><span class="line"><span class="comment">     * è¾“å‡ºï¼š1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_25_0</span></span>&#123;</span><br><span class="line">    <span class="comment">//ä¼ªå¤´ç‚¹</span></span><br><span class="line">    ListNode dum = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">//curå…ˆæŒ‡å‘dum</span></span><br><span class="line">    ListNode cur = dum;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">mergeTwoLists</span><span class="params">(ListNode l1, ListNode l2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (l1 != <span class="keyword">null</span> &amp;&amp; l2 != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (l1.val&lt;l2.val)&#123;</span><br><span class="line">                cur.next = l1;</span><br><span class="line">                l1 = l1.next;</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                cur.next = l2;</span><br><span class="line">                l2 = l2.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//curå¾€å‰æ›´æ–°ä¸€æ­¥</span></span><br><span class="line">            cur = cur.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l1!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            cur.next=l1;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            cur.next=l2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dum.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="35-å¤æ‚é“¾è¡¨çš„å¤åˆ¶"><a href="#35-å¤æ‚é“¾è¡¨çš„å¤åˆ¶" class="headerlink" title="35-å¤æ‚é“¾è¡¨çš„å¤åˆ¶"></a><a href="https://leetcode-cn.com/problems/fu-za-lian-biao-de-fu-zhi-lcof/">35-å¤æ‚é“¾è¡¨çš„å¤åˆ¶</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">copyRandomList_35</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯·å®ç° copyRandomList å‡½æ•°ï¼Œå¤åˆ¶ä¸€ä¸ªå¤æ‚é“¾è¡¨ã€‚åœ¨å¤æ‚é“¾è¡¨ä¸­ï¼Œ</span></span><br><span class="line"><span class="comment">     * æ¯ä¸ªèŠ‚ç‚¹é™¤äº†æœ‰ä¸€ä¸ª next æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿˜æœ‰ä¸€ä¸ª random æŒ‡é’ˆæŒ‡å‘é“¾è¡¨ä¸­çš„ä»»æ„èŠ‚ç‚¹æˆ–è€… nullã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_35_0</span></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä½¿ç”¨HashMapæ¥è§£é¢˜</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Node <span class="title">copyRandomList</span><span class="params">(Node head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (head==<span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">//åˆ›å»ºmap</span></span><br><span class="line">        HashMap&lt;Node,Node&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="comment">//æŒ‡å‘head</span></span><br><span class="line">        Node cur = head;</span><br><span class="line">        <span class="comment">//å¤åˆ¶Node</span></span><br><span class="line">        <span class="keyword">while</span> (cur!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            map.put(cur,<span class="keyword">new</span> Node(cur.val));</span><br><span class="line">            cur = cur.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å†æ¬¡æŒ‡å‘head</span></span><br><span class="line">        cur = head;</span><br><span class="line">        <span class="comment">//å¤åˆ¶Nodeçš„randomå’Œnext</span></span><br><span class="line">        <span class="keyword">while</span> (cur!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            map.get(cur).next = map.get(cur.next);</span><br><span class="line">            map.get(cur).random = map.get(cur.random);</span><br><span class="line">            cur = cur.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> map.get(head);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="52-ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹"><a href="#52-ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹" class="headerlink" title="52-ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹"></a><a href="https://leetcode-cn.com/problems/liang-ge-lian-biao-de-di-yi-ge-gong-gong-jie-dian-lcof/">52-ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">getIntersectionNode_52</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¾“å…¥ï¼šintersectVal = 8, listA = [4,1,8,4,5], listB = [5,0,1,8,4,5], skipA = 2, skipB = 3</span></span><br><span class="line"><span class="comment">     * è¾“å‡ºï¼šReference of the node with value = 8</span></span><br><span class="line"><span class="comment">     * è¾“å…¥è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º 8 ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªåˆ—è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º 0ï¼‰ã€‚ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ A ä¸º [4,1,8,4,5]ï¼Œé“¾è¡¨ B ä¸º [5,0,1,8,4,5]ã€‚åœ¨ A ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 2 ä¸ªèŠ‚ç‚¹ï¼›åœ¨ B ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 3 ä¸ªèŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_52_0</span></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¦‚æœä¸¤ä¸ªæ— ç¯é“¾è¡¨ç›¸äº¤,é‚£ä¹ˆä»ç›¸äº¤èŠ‚ç‚¹å¼€å§‹,ä¸€ç›´åˆ°ä¸¤ä¸ªé“¾è¡¨ç»ˆæ­¢çš„è¿™ä¸€æ®µ,æ˜¯ä¸¤ä¸ªé“¾è¡¨å…±äº«çš„ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * å› æ­¤è§£å†³è¯¥é—®é¢˜çš„å…·ä½“è¿‡ç¨‹å¦‚ä¸‹:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *     é“¾è¡¨1ä»å¤´èŠ‚ç‚¹å¼€å§‹ï¼Œèµ°åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹(ä¸æ˜¯ç»“æŸ)ï¼Œç»Ÿè®¡é“¾è¡¨1çš„é•¿åº¦è®°ä¸ºlen1ï¼ŒåŒæ—¶è®°å½•é“¾è¡¨1çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹è®°ä¸ºend1</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *     é“¾è¡¨2ä»å¤´èŠ‚ç‚¹å¼€å§‹ï¼Œèµ°åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹(ä¸æ˜¯ç»“æŸ)ï¼Œç»Ÿè®¡é“¾è¡¨2çš„é•¿åº¦è®°ä¸ºlen2ï¼ŒåŒæ—¶è®°å½•é“¾è¡¨2çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹è®°ä¸ºend2ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *     å¦‚æœend1!=end2ï¼Œè¯´æ˜ä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œè¿”å›nulå³å¯ã€‚å¦‚æœend=end2ï¼Œè¯´æ˜ä¸¤ä¸ªé“¾è¡¨ç›¸äº¤ï¼Œè¿›å…¥æ­¥éª¤4æ¥æ‰¾å¯»ç¬¬ä¸€ä¸ªç›¸äº¤èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *     å¦‚æœé“¾è¡¨1æ¯”è¾ƒé•¿ï¼Œé“¾è¡¨1å°±å…ˆèµ°len1-len2æ­¥ã€‚å¦‚æœé“¾è¡¨2æ¯”è¾ƒé•¿ï¼Œé“¾è¡¨2å°±å…ˆèµ°len2-len1æ­¥ã€‚ç„¶åä¸¤ä¸ªé“¾è¡¨ä¸€èµ·èµ°ï¼Œä¸€èµ·èµ°çš„è¿‡ç¨‹ä¸­ï¼Œä¸¤ä¸ªé“¾è¡¨ç¬¬ä¸€æ¬¡èµ°åˆ°ä¸€èµ·çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œå°±æ˜¯ç¬¬ä¸€ä¸ªç›¸äº¤çš„èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">getIntersectionNode</span><span class="params">(ListNode headA, ListNode headB)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (headA==<span class="keyword">null</span> || headB==<span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">int</span> lenA=<span class="number">0</span>, lenB=<span class="number">0</span>;</span><br><span class="line">        ListNode curA = headA, curB = headB;</span><br><span class="line">        <span class="comment">//è®¡ç®—lenA</span></span><br><span class="line">        <span class="keyword">while</span>(curA!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            lenA++;</span><br><span class="line">            curA = curA.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//è®¡ç®—lenB</span></span><br><span class="line">        <span class="keyword">while</span> (curB!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            lenB++;</span><br><span class="line">            curB = curB.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å¦‚æœend1!=end2ï¼Œè¯´æ˜ä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œè¿”å›nulå³å¯ã€‚å¦‚æœend=end2ï¼Œè¯´æ˜ä¸¤ä¸ªé“¾è¡¨ç›¸äº¤ï¼Œè¿›å…¥æ­¥éª¤4æ¥æ‰¾å¯»ç¬¬ä¸€ä¸ªç›¸äº¤èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        <span class="keyword">int</span> dif = (lenA-lenB);</span><br><span class="line">        curA = dif&gt;<span class="number">0</span> ? headA : headB;</span><br><span class="line">        curB = curA==headA ? headB : headA;</span><br><span class="line">        dif = Math.abs(dif);</span><br><span class="line">        <span class="keyword">if</span> (dif&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">while</span> (dif &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                curA = curA.next;</span><br><span class="line">                dif--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ç°åœ¨ä¸¤ä¸ªé“¾è¡¨ä¸€èµ·èµ°ï¼Œç­‰ä¸¤ä¸ªnodeç›¸ç­‰çš„æ—¶å€™å°±è¿”å›ï¼Œå› ä¸ºæ‰¾åˆ°äº†intersect point</span></span><br><span class="line">        <span class="keyword">while</span>(curA!=curB)&#123;</span><br><span class="line">            curA = curA.next;</span><br><span class="line">            curB = curB.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//è¿”å›curA curBéƒ½è¡Œï¼Œå› ä¸ºç›¸åŒ</span></span><br><span class="line">        <span class="keyword">return</span> curA;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="18-åˆ é™¤é“¾è¡¨çš„èŠ‚ç‚¹"><a href="#18-åˆ é™¤é“¾è¡¨çš„èŠ‚ç‚¹" class="headerlink" title="18-åˆ é™¤é“¾è¡¨çš„èŠ‚ç‚¹ "></a><a href="https://leetcode-cn.com/problems/shan-chu-lian-biao-de-jie-dian-lcof/">18-åˆ é™¤é“¾è¡¨çš„èŠ‚ç‚¹ </a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">deleteNode_18</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»™å®šå•å‘é“¾è¡¨çš„å¤´æŒ‡é’ˆå’Œä¸€ä¸ªè¦åˆ é™¤çš„èŠ‚ç‚¹çš„å€¼ï¼Œå®šä¹‰ä¸€ä¸ªå‡½æ•°åˆ é™¤è¯¥èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * è¿”å›åˆ é™¤åçš„é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * æ³¨æ„ï¼šæ­¤é¢˜å¯¹æ¯”åŸé¢˜æœ‰æ”¹åŠ¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ç¤ºä¾‹ 1:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * è¾“å…¥: head = [4,5,1,9], val = 5</span></span><br><span class="line"><span class="comment">     * è¾“å‡º: [4,1,9]</span></span><br><span class="line"><span class="comment">     * è§£é‡Š: ç»™å®šä½ é“¾è¡¨ä¸­å€¼ä¸º 5 çš„ç¬¬äºŒä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨äº†ä½ çš„å‡½æ•°ä¹‹åï¼Œè¯¥é“¾è¡¨åº”å˜ä¸º 4 -&gt; 1 -&gt; 9.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ç¤ºä¾‹ 2:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * è¾“å…¥: head = [4,5,1,9], val = 1</span></span><br><span class="line"><span class="comment">     * è¾“å‡º: [4,5,9]</span></span><br><span class="line"><span class="comment">     * è§£é‡Š: ç»™å®šä½ é“¾è¡¨ä¸­å€¼ä¸º 1 çš„ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨äº†ä½ çš„å‡½æ•°ä¹‹åï¼Œè¯¥é“¾è¡¨åº”å˜ä¸º 4 -&gt; 5 -&gt; 9.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_18_0</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">deleteNode</span><span class="params">(ListNode head, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         *     åˆ é™¤å€¼ä¸º val çš„èŠ‚ç‚¹å¯åˆ†ä¸ºä¸¤æ­¥ï¼šå®šä½èŠ‚ç‚¹ã€ä¿®æ”¹å¼•ç”¨ã€‚</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         *     å®šä½èŠ‚ç‚¹ï¼š éå†é“¾è¡¨ï¼Œç›´åˆ° head.val == val æ—¶è·³å‡ºï¼Œå³å¯å®šä½ç›®æ ‡èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">         *     ä¿®æ”¹å¼•ç”¨ï¼š è®¾èŠ‚ç‚¹ cur çš„å‰é©±èŠ‚ç‚¹ä¸º pre ï¼Œåç»§èŠ‚ç‚¹ä¸º cur.next ï¼›åˆ™æ‰§è¡Œ pre.next = cur.next ï¼Œå³å¯å®ç°åˆ é™¤ cur èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (head.val==val) <span class="keyword">return</span> head.next;</span><br><span class="line">        <span class="comment">//åˆ›å»ºæŒ‡é’ˆ</span></span><br><span class="line">        ListNode cur = head, pre = head;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">while</span> (cur.val!=val)&#123;</span><br><span class="line">            cur = cur.next;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹å‰é¢çš„ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;(count-<span class="number">1</span>);i++)&#123;</span><br><span class="line">            pre = pre.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//åˆ é™¤ç›®æ ‡èŠ‚ç‚¹</span></span><br><span class="line">        pre.next = cur.next;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Stack-amp-Queue"><a href="#Stack-amp-Queue" class="headerlink" title="Stack &amp; Queue"></a>Stack &amp; Queue</h2><h3 id="09-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—"><a href="#09-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—" class="headerlink" title="09-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—"></a><a href="https://leetcode-cn.com/problems/yong-liang-ge-zhan-shi-xian-dui-lie-lcof/submissions/">09-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—çš„å£°æ˜å¦‚ä¸‹ï¼Œè¯·å®ç°å®ƒçš„ä¸¤ä¸ªå‡½æ•° appendTail å’Œ deleteHead ï¼Œåˆ†åˆ«å®Œæˆåœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥æ•´æ•°å’Œåœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤æ•´æ•°çš„åŠŸèƒ½ã€‚(è‹¥é˜Ÿåˆ—ä¸­æ²¡æœ‰å…ƒç´ ï¼ŒdeleteHead æ“ä½œè¿”å› -1 )</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ç¤ºä¾‹ 1ï¼š</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * è¾“å…¥ï¼š</span></span><br><span class="line"><span class="comment"> * ["CQueue","appendTail","deleteHead","deleteHead"]</span></span><br><span class="line"><span class="comment"> * [[],[3],[],[]]</span></span><br><span class="line"><span class="comment"> * è¾“å‡ºï¼š[null,null,3,-1]</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ç¤ºä¾‹ 2ï¼š</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * è¾“å…¥ï¼š</span></span><br><span class="line"><span class="comment"> * ["CQueue","deleteHead","appendTail","appendTail","deleteHead","deleteHead"]</span></span><br><span class="line"><span class="comment"> * [[],[],[5],[2],[],[]]</span></span><br><span class="line"><span class="comment"> * è¾“å‡ºï¼š[null,-1,null,null,5,2]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CQueue_09</span> </span>&#123;</span><br><span class="line">    LinkedList&lt;Integer&gt; A,B;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CQueue_09</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * é¢˜ç›®åªè¦æ±‚å®ç° åŠ å…¥é˜Ÿå°¾appendTail() å’Œ åˆ é™¤é˜Ÿé¦–deleteHead() ä¸¤ä¸ªå‡½æ•°çš„æ­£å¸¸å·¥ä½œï¼Œ</span></span><br><span class="line"><span class="comment">         * å› æ­¤æˆ‘ä»¬å¯ä»¥è®¾è®¡æ ˆ A ç”¨äºåŠ å…¥é˜Ÿå°¾æ“ä½œï¼Œ</span></span><br><span class="line"><span class="comment">         * æ ˆ B ç”¨äºå°†å…ƒç´ å€’åºï¼Œä»è€Œå®ç°åˆ é™¤é˜Ÿé¦–å…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        A = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">        B = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">appendTail</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//Aç”¨äºåŠ å…¥é˜Ÿå°¾</span></span><br><span class="line">        <span class="comment">//63</span></span><br><span class="line">        A.addLast(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteHead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * åˆ é™¤é˜Ÿé¦–deleteHead()å‡½æ•°ï¼š æœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µã€‚</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         *     å½“æ ˆ B ä¸ä¸ºç©ºï¼š Bä¸­ä»æœ‰å·²å®Œæˆå€’åºçš„å…ƒç´ ï¼Œå› æ­¤ç›´æ¥è¿”å› B çš„æ ˆé¡¶å…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">         *     å¦åˆ™ï¼Œå½“ A ä¸ºç©ºï¼š å³ä¸¤ä¸ªæ ˆéƒ½ä¸ºç©ºï¼Œæ— å…ƒç´ ï¼Œå› æ­¤è¿”å› âˆ’1 ã€‚</span></span><br><span class="line"><span class="comment">         *     å¦åˆ™ï¼š å°†æ ˆ A å…ƒç´ å…¨éƒ¨è½¬ç§»è‡³æ ˆ B ä¸­ï¼Œå®ç°å…ƒç´ å€’åºï¼Œå¹¶è¿”å›æ ˆ B çš„æ ˆé¡¶å…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (A.isEmpty() &amp;&amp; B.isEmpty()) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (B.isEmpty())&#123;</span><br><span class="line">            <span class="keyword">while</span> (!A.isEmpty())&#123;</span><br><span class="line">                <span class="comment">//è¿™é‡Œç”¨addFirstæ¥å®ç°å€’åº</span></span><br><span class="line">                <span class="comment">//36</span></span><br><span class="line">                B.addLast(A.removeLast());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//6</span></span><br><span class="line">            <span class="keyword">return</span> B.removeLast();</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">return</span> B.removeLast();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your CQueue object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * CQueue obj = new CQueue();</span></span><br><span class="line"><span class="comment"> * obj.appendTail(value);</span></span><br><span class="line"><span class="comment"> * int param_2 = obj.deleteHead();</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h3 id="30-åŒ…å«minå‡½æ•°çš„æ ˆ"><a href="#30-åŒ…å«minå‡½æ•°çš„æ ˆ" class="headerlink" title="30-åŒ…å«minå‡½æ•°çš„æ ˆ"></a><a href="http://link.zhihu.com/?target=https%3A//leetcode-cn.com/problems/bao-han-minhan-shu-de-zhan-lcof">30-åŒ…å«minå‡½æ•°çš„æ ˆ</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MinStack_30</span> </span>&#123;</span><br><span class="line">    Stack&lt;Integer&gt; A,B;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** initialize your data structure here. */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MinStack_30</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        A = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">        B = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å‡½æ•°è®¾è®¡ï¼š</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         *     push(x) å‡½æ•°ï¼š é‡ç‚¹ä¸ºä¿æŒæ ˆ B çš„å…ƒç´ æ˜¯ éä¸¥æ ¼é™åº çš„ã€‚</span></span><br><span class="line"><span class="comment">         *         å°† xxx å‹å…¥æ ˆ AAA ï¼ˆå³ A.add(x) ï¼‰ï¼›</span></span><br><span class="line"><span class="comment">         *         è‹¥ â‘  æ ˆ BBB ä¸ºç©º æˆ– â‘¡ xxx å°äºç­‰äº æ ˆ BBB çš„æ ˆé¡¶å…ƒç´ ï¼Œåˆ™å°† xxx å‹å…¥æ ˆ BBB ï¼ˆå³ B.add(x) ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         *     pop() å‡½æ•°ï¼š é‡ç‚¹ä¸ºä¿æŒæ ˆ A,B çš„ å…ƒç´ ä¸€è‡´æ€§ ã€‚</span></span><br><span class="line"><span class="comment">         *         æ‰§è¡Œæ ˆ AAA å‡ºæ ˆï¼ˆå³ A.pop() ï¼‰ï¼Œå°†å‡ºæ ˆå…ƒç´ è®°ä¸º yyy ï¼›</span></span><br><span class="line"><span class="comment">         *         è‹¥ yyy ç­‰äºæ ˆ BBB çš„æ ˆé¡¶å…ƒç´ ï¼Œåˆ™æ‰§è¡Œæ ˆ B å‡ºæ ˆï¼ˆå³ B.pop() ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         *     top() å‡½æ•°ï¼š ç›´æ¥è¿”å›æ ˆ AAA çš„æ ˆé¡¶å…ƒç´ å³å¯ï¼Œå³è¿”å› A.peek() ã€‚</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         *     min() å‡½æ•°ï¼š ç›´æ¥è¿”å›æ ˆ BBB çš„æ ˆé¡¶å…ƒç´ å³å¯ï¼Œå³è¿”å› B.peek() ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">      <span class="comment">//æŠŠx pushåˆ°A</span></span><br><span class="line">      A.add(x);</span><br><span class="line">        <span class="comment">//éœ€è¦ä¿æŒ Bæ ˆ æ˜¯éä¸¥æ ¼é™åº</span></span><br><span class="line">      <span class="comment">//Stackç±»ä¸€å®šè¦ç”¨empty()åˆ«ç”¨é”™ï¼Œç”¨é”™æˆisEmpty()ä¼šæŠ¥é”™</span></span><br><span class="line">        <span class="keyword">if</span> (B.Empty() || x&lt;=B.peek())&#123;</span><br><span class="line">            <span class="comment">//å¦‚æœBæ˜¯ç©º åˆ™æŠŠx pushåˆ°B</span></span><br><span class="line">            B.add(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Integer popedInt = A.pop();</span><br><span class="line">        <span class="keyword">if</span> (popedInt.equals(B.peek())) B.pop();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">top</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> A.peek();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">min</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> B.peek();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="31-æ ˆçš„å‹å…¥ã€å¼¹å‡ºåºåˆ—"><a href="#31-æ ˆçš„å‹å…¥ã€å¼¹å‡ºåºåˆ—" class="headerlink" title="31-æ ˆçš„å‹å…¥ã€å¼¹å‡ºåºåˆ— "></a><a href="">31-æ ˆçš„å‹å…¥ã€å¼¹å‡ºåºåˆ— </a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">validateStackSequences_31</span> </span>&#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¾“å…¥ä¸¤ä¸ªæ•´æ•°åºåˆ—ï¼Œç¬¬ä¸€ä¸ªåºåˆ—è¡¨ç¤ºæ ˆçš„å‹å…¥é¡ºåºï¼Œè¯·åˆ¤æ–­ç¬¬äºŒä¸ªåºåˆ—æ˜¯å¦ä¸ºè¯¥æ ˆçš„å¼¹å‡ºé¡ºåºã€‚å‡è®¾å‹å…¥æ ˆçš„æ‰€æœ‰æ•°å­—å‡ä¸ç›¸ç­‰ã€‚ä¾‹å¦‚ï¼Œåºåˆ— &#123;1,2,3,4,5&#125; æ˜¯æŸæ ˆçš„å‹æ ˆåºåˆ—ï¼Œåºåˆ— &#123;4,5,3,2,1&#125; æ˜¯è¯¥å‹æ ˆåºåˆ—å¯¹åº”çš„ä¸€ä¸ªå¼¹å‡ºåºåˆ—ï¼Œä½† &#123;4,3,5,1,2&#125; å°±ä¸å¯èƒ½æ˜¯è¯¥å‹æ ˆåºåˆ—çš„å¼¹å‡ºåºåˆ—ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ç¤ºä¾‹ 1ï¼š</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * è¾“å…¥ï¼špushed = [1,2,3,4,5], popped = [4,5,3,2,1]</span></span><br><span class="line"><span class="comment"> * è¾“å‡ºï¼štrue</span></span><br><span class="line"><span class="comment"> * è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æŒ‰ä»¥ä¸‹é¡ºåºæ‰§è¡Œï¼š</span></span><br><span class="line"><span class="comment"> * push(1), push(2), push(3), push(4), pop() -&gt; 4,</span></span><br><span class="line"><span class="comment"> * push(5), pop() -&gt; 5, pop() -&gt; 3, pop() -&gt; 2, pop() -&gt; 1</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ç¤ºä¾‹ 2ï¼š</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * è¾“å…¥ï¼špushed = [1,2,3,4,5], popped = [4,3,5,1,2]</span></span><br><span class="line"><span class="comment"> * è¾“å‡ºï¼šfalse</span></span><br><span class="line"><span class="comment"> * è§£é‡Šï¼š1 ä¸èƒ½åœ¨ 2 ä¹‹å‰å¼¹å‡ºã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_31_0</span></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è€ƒè™‘å€Ÿç”¨ä¸€ä¸ªè¾…åŠ©æ ˆ stack ï¼Œæ¨¡æ‹Ÿ å‹å…¥ / å¼¹å‡ºæ“ä½œçš„æ’åˆ—ã€‚æ ¹æ®æ˜¯å¦æ¨¡æ‹ŸæˆåŠŸï¼Œå³å¯å¾—åˆ°ç»“æœã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *     å…¥æ ˆæ“ä½œï¼š æŒ‰ç…§å‹æ ˆåºåˆ—çš„é¡ºåºæ‰§è¡Œã€‚</span></span><br><span class="line"><span class="comment">     *     å‡ºæ ˆæ“ä½œï¼š æ¯æ¬¡å…¥æ ˆåï¼Œå¾ªç¯åˆ¤æ–­ â€œæ ˆé¡¶å…ƒç´  === å¼¹å‡ºåºåˆ—çš„å½“å‰å…ƒç´ â€ æ˜¯å¦æˆç«‹ï¼Œå°†ç¬¦åˆå¼¹å‡ºåºåˆ—é¡ºåºçš„æ ˆé¡¶å…ƒç´ å…¨éƒ¨å¼¹å‡ºã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *     ç”±äºé¢˜ç›®è§„å®š æ ˆçš„æ‰€æœ‰æ•°å­—å‡ä¸ç›¸ç­‰ ï¼Œå› æ­¤åœ¨å¾ªç¯å…¥æ ˆä¸­ï¼Œæ¯ä¸ªå…ƒç´ å‡ºæ ˆçš„ä½ç½®çš„å¯èƒ½æ€§æ˜¯å”¯ä¸€çš„ï¼ˆè‹¥æœ‰é‡å¤æ•°å­—ï¼Œåˆ™å…·æœ‰å¤šä¸ªå¯å‡ºæ ˆçš„ä½ç½®ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">     *     å› è€Œï¼Œåœ¨é‡åˆ° â€œæ ˆé¡¶å…ƒç´  === å¼¹å‡ºåºåˆ—çš„å½“å‰å…ƒç´ â€ å°±åº”ç«‹å³æ‰§è¡Œå‡ºæ ˆã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ç®—æ³•æµç¨‹ï¼š</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *     åˆå§‹åŒ–ï¼š è¾…åŠ©æ ˆ stackstackstack ï¼Œå¼¹å‡ºåºåˆ—çš„ç´¢å¼• iii ï¼›</span></span><br><span class="line"><span class="comment">     *     éå†å‹æ ˆåºåˆ—ï¼š å„å…ƒç´ è®°ä¸º numnumnum ï¼›</span></span><br><span class="line"><span class="comment">     *         å…ƒç´  numnumnum å…¥æ ˆï¼›</span></span><br><span class="line"><span class="comment">     *         å¾ªç¯å‡ºæ ˆï¼šè‹¥ stackstackstack çš„æ ˆé¡¶å…ƒç´  === å¼¹å‡ºåºåˆ—å…ƒç´  popped[i]popped[i]popped[i] ï¼Œåˆ™æ‰§è¡Œå‡ºæ ˆä¸ i++i++i++ ï¼›</span></span><br><span class="line"><span class="comment">     *     è¿”å›å€¼ï¼š è‹¥ stackstackstack ä¸ºç©ºï¼Œåˆ™æ­¤å¼¹å‡ºåºåˆ—åˆæ³•ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">validateStackSequences</span><span class="params">(<span class="keyword">int</span>[] pushed, <span class="keyword">int</span>[] popped)</span> </span>&#123;</span><br><span class="line">        Stack&lt;Integer&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">        <span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//æŒ‰ç…§é¡ºåºä¾æ¬¡push element</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> num : pushed)&#123;</span><br><span class="line">            stack.push(num);</span><br><span class="line">            <span class="keyword">while</span>(!stack.empty() &amp;&amp; stack.peek().equals(popped[n]))&#123;</span><br><span class="line">                stack.pop();</span><br><span class="line">                n++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> stack.empty();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="58-1-ç¿»è½¬å•è¯é¡ºåº"><a href="#58-1-ç¿»è½¬å•è¯é¡ºåº" class="headerlink" title="58-1-ç¿»è½¬å•è¯é¡ºåº"></a><a href="https://leetcode-cn.com/problems/fan-zhuan-dan-ci-shun-xu-lcof/">58-1-ç¿»è½¬å•è¯é¡ºåº</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">reverseWords_58_1</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¾“å…¥ä¸€ä¸ªè‹±æ–‡å¥å­ï¼Œç¿»è½¬å¥å­ä¸­å•è¯çš„é¡ºåºï¼Œä½†å•è¯å†…å­—ç¬¦çš„é¡ºåºä¸å˜ã€‚ä¸ºç®€å•èµ·è§ï¼Œæ ‡ç‚¹ç¬¦å·å’Œæ™®é€šå­—æ¯ä¸€æ ·å¤„ç†ã€‚ä¾‹å¦‚è¾“å…¥å­—ç¬¦ä¸²"I am a student. "ï¼Œåˆ™è¾“å‡º"student. a am I"ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ç¤ºä¾‹ 1ï¼š</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * è¾“å…¥: "the sky is blue"</span></span><br><span class="line"><span class="comment">     * è¾“å‡º: "blue is sky the"</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ç¤ºä¾‹ 2ï¼š</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * è¾“å…¥: "  hello world!  "</span></span><br><span class="line"><span class="comment">     * è¾“å‡º: "world! hello"</span></span><br><span class="line"><span class="comment">     * è§£é‡Š: è¾“å…¥å­—ç¬¦ä¸²å¯ä»¥åœ¨å‰é¢æˆ–è€…åé¢åŒ…å«å¤šä½™çš„ç©ºæ ¼ï¼Œä½†æ˜¯åè½¬åçš„å­—ç¬¦ä¸èƒ½åŒ…æ‹¬ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * ç¤ºä¾‹ 3ï¼š</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * è¾“å…¥: "a good   example"</span></span><br><span class="line"><span class="comment">     * è¾“å‡º: "example good a"</span></span><br><span class="line"><span class="comment">     * è§£é‡Š: å¦‚æœä¸¤ä¸ªå•è¯é—´æœ‰å¤šä½™çš„ç©ºæ ¼ï¼Œå°†åè½¬åå•è¯é—´çš„ç©ºæ ¼å‡å°‘åˆ°åªå«ä¸€ä¸ªã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰</span></span><br><span class="line"><span class="comment">     * é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/fan-zhuan-dan-ci-shun-xu-lcof</span></span><br><span class="line"><span class="comment">     * è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_58_1_0</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">reverseWords</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//trim()åˆ é™¤é¦–å°¾ç©ºæ ¼ split(" ")ç”¨ç©ºæ ¼åˆ†å‰²å­—ç¬¦ä¸²</span></span><br><span class="line">        String[] strings = s.trim().split(<span class="string">" "</span>);</span><br><span class="line">        StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=strings.length-<span class="number">1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">            <span class="comment">//å¦‚æœstringbuilderé‡Œçš„stringæ˜¯ç©ºå•è¯ å°±è·³è¿‡è¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯</span></span><br><span class="line">            <span class="keyword">if</span> (strings[i].equals(<span class="string">""</span>)) <span class="keyword">continue</span>;</span><br><span class="line">            stringBuilder.append(strings[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> stringBuilder.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="59-I-æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼"><a href="#59-I-æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼" class="headerlink" title="59 - I. æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼"></a><a href="https://leetcode-cn.com/problems/hua-dong-chuang-kou-de-zui-da-zhi-lcof/">59 - I. æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Deque;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">maxSlidingWindow_59_1</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_59_1_0</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] maxSlidingWindow(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums.length==<span class="number">0</span> || k==<span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">0</span>];</span><br><span class="line">        Deque&lt;Integer&gt; deque = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">        <span class="comment">//åˆå§‹åŒ–è¿”å›çš„ç»“æœ</span></span><br><span class="line">        <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length-k+<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>-k,j=<span class="number">0</span>;j&lt;nums.length; i++,j++)&#123;</span><br><span class="line">            <span class="comment">//é€šè¿‡removefirstæ¥åˆ é™¤dequeä¸­å’Œnumså¯¹åº”çš„element</span></span><br><span class="line">            <span class="keyword">if</span> (i&gt;<span class="number">0</span> &amp;&amp; deque.peekFirst()==nums[i-<span class="number">1</span>]) deque.removeFirst();</span><br><span class="line">            <span class="comment">//whileé€’å‡deque</span></span><br><span class="line">            <span class="keyword">while</span> (!deque.isEmpty() &amp;&amp; deque.peekLast()&lt;nums[j]) deque.removeLast();</span><br><span class="line">            deque.addLast(nums[j]);</span><br><span class="line">            <span class="comment">//è®°å½•æœ€å¤§å€¼</span></span><br><span class="line">            <span class="keyword">if</span> (i&gt;=<span class="number">0</span>) res[i]=deque.peekFirst();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Heap"><a href="#Heap" class="headerlink" title="Heap"></a>Heap</h2><h3 id="40-æœ€å°çš„Kä¸ªæ•°"><a href="#40-æœ€å°çš„Kä¸ªæ•°" class="headerlink" title="40-æœ€å°çš„Kä¸ªæ•°"></a><a href="https://leetcode-cn.com/problems/zui-xiao-de-kge-shu-lcof/">40-æœ€å°çš„Kä¸ªæ•°</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.PriorityQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.Queue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">getLeastNumbers_40</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] getLeastNumbers(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums.length==<span class="number">0</span> || k==<span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ä¸€ä¸ªæœ€å¤§å †ï¼ˆå¤§é¡¶å †ï¼‰</span></span><br><span class="line">        <span class="comment">// Java çš„ PriorityQueue é»˜è®¤æ˜¯å°é¡¶å †ï¼Œæ·»åŠ  comparator å‚æ•°ä½¿å…¶å˜æˆæœ€å¤§å †</span></span><br><span class="line">        Queue&lt;Integer&gt; heap = <span class="keyword">new</span> PriorityQueue&lt;&gt;(k,<span class="keyword">new</span> Comparator&lt;Integer&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Integer o1, Integer o2)</span> </span>&#123;</span><br><span class="line">                <span class="comment">/**</span></span><br><span class="line"><span class="comment">                 * This method returns the value zero if (x==y),</span></span><br><span class="line"><span class="comment">                 * if (x &lt; y) then it returns a value less than zero</span></span><br><span class="line"><span class="comment">                 * and if (x &gt; y) then it returns a value greater than zero.</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                <span class="keyword">return</span> Integer.compare(o2,o1);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> e : nums)&#123;</span><br><span class="line">            <span class="comment">//å¦‚æœeå°äºå½“å‰heapä¸­æ ˆé¡¶çš„æœ€å¤§çš„å…ƒç´ æ‰æ·»åŠ e</span></span><br><span class="line">            <span class="keyword">if</span> (heap.isEmpty() || heap.size()&lt;k || heap.peek()&gt;e) heap.offer(e);</span><br><span class="line">            <span class="comment">//å¦‚æœå½“å‰heapçš„sizeå¤§äºkåˆ™æŠŠæ ˆé¡¶å…ƒç´ å¼¹å‡ºå»</span></span><br><span class="line">            <span class="keyword">if</span> (heap.size()&gt;k) heap.poll();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å°†heapä¸­æœ€å°çš„kä¸ªæ•°åŠ å…¥åˆ°resæ•°ç»„é‡Œå¹¶return</span></span><br><span class="line">        <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[heap.size()];</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> e : heap)&#123;</span><br><span class="line">            res[i++] = e;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Hash-Table"><a href="#Hash-Table" class="headerlink" title="Hash Table"></a>Hash Table</h2><h3 id="50-ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦"><a href="#50-ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦" class="headerlink" title="50-ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦"></a><a href="https://leetcode-cn.com/problems/di-yi-ge-zhi-chu-xian-yi-ci-de-zi-fu-lcof/">50-ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">char</span> <span class="title">firstUniqChar</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">  HashMap&lt;Character, Boolean&gt; dic = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  <span class="keyword">char</span>[] sc = s.toCharArray();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">char</span> c:sc)&#123;</span><br><span class="line">    <span class="comment">//!dic.containsKey(c)å¯¼è‡´ç¬¬ä¸€æ¬¡æ·»åŠ keyçš„æ—¶å€™ï¼Œvalueæ˜¯trueï¼Œä½†æ˜¯å†æ¬¡æ·»åŠ çš„æ—¶å€™å°±æ˜¯false</span></span><br><span class="line">    <span class="comment">//è·Ÿæœ¬é¢˜ç¬¦åˆï¼Œå› ä¸ºåªéœ€è¦å‡ºç°ä¾æ¬¡çš„charï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœvalueä¸ºfalseåˆ™ä¸æ˜¯åªå‡ºç°ä¸€æ¬¡çš„char</span></span><br><span class="line">    dic.put(c,!dic.containsKey(c));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">char</span> c:sc)</span><br><span class="line">    <span class="comment">//åªå‡ºç°ä¸€æ¬¡çš„keyçš„valueæ˜¯trueï¼Œå¦‚æœdic,get()è¿”å›trueï¼Œè¯´æ˜æ˜¯æˆ‘ä»¬è¦æ‰¾çš„char</span></span><br><span class="line">    <span class="keyword">if</span> (dic.get(c)) <span class="keyword">return</span> c;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">' '</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Graph-DFS-amp-BFS"><a href="#Graph-DFS-amp-BFS" class="headerlink" title="Graph (DFS &amp; BFS)"></a>Graph (DFS &amp; BFS)</h2><h3 id="12-çŸ©é˜µä¸­çš„è·¯å¾„-DFS"><a href="#12-çŸ©é˜µä¸­çš„è·¯å¾„-DFS" class="headerlink" title="12-çŸ©é˜µä¸­çš„è·¯å¾„(DFS)"></a><a href="https://leetcode-cn.com/problems/ju-zhen-zhong-de-lu-jing-lcof/">12-çŸ©é˜µä¸­çš„è·¯å¾„(DFS)</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_12_0</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">exist</span><span class="params">(<span class="keyword">char</span>[][] board, String word)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span>[] words = word.toCharArray();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;board.length;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;board[<span class="number">0</span>].length;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (dfs(board,words,i,j,<span class="number">0</span>)) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">dfs</span><span class="params">(<span class="keyword">char</span>[][] board, <span class="keyword">char</span>[] word, <span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">        <span class="comment">//â‘  è¡Œæˆ–åˆ—ç´¢å¼•è¶Šç•Œ æˆ– â‘¡ å½“å‰çŸ©é˜µå…ƒç´ ä¸ç›®æ ‡å­—ç¬¦ä¸åŒ æˆ– â‘¢ å½“å‰çŸ©é˜µå…ƒç´ å·²è®¿é—®è¿‡ ï¼ˆâ‘¢ å¯åˆå¹¶è‡³ â‘¡</span></span><br><span class="line">        <span class="keyword">if</span> (i&gt;=board.length || i&lt;<span class="number">0</span> || j&gt;=board[<span class="number">0</span>].length || j&lt;<span class="number">0</span> || board[i][j]!=word[k]) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="comment">//å­—ç¬¦ä¸² word å·²å…¨éƒ¨åŒ¹é…ï¼Œå³ k = len(word) - 1 ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (k==word.length-<span class="number">1</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="comment">//å°†å½“å‰charå­˜èµ·æ¥</span></span><br><span class="line">        <span class="keyword">char</span> tmp = board[i][j];</span><br><span class="line">        <span class="comment">//å°†å½“å‰charçš„ä½ç½®æ ‡è®°ä¸º/ï¼Œé˜²æ²»å†æ¬¡éå†å½“å‰çš„charï¼Œèµ°å›å¤´è·¯</span></span><br><span class="line">        board[i][j] = <span class="string">'/'</span>;</span><br><span class="line">        <span class="comment">//å¯ä»¥ä¸Šä¸‹å·¦å³ç§»åŠ¨ï¼Œåªè¦æœ‰ä¸€ä¸ªæ–¹å‘ç¬¦åˆè¦æ±‚å°±å¯ä»¥</span></span><br><span class="line">        <span class="keyword">boolean</span> res = dfs(board,word,i,j+<span class="number">1</span>,k+<span class="number">1</span>) || dfs(board, word, i, j-<span class="number">1</span>, k+<span class="number">1</span>) || dfs(board, word, i-<span class="number">1</span>, j, k+<span class="number">1</span>)</span><br><span class="line">                || dfs(board, word, i+<span class="number">1</span>, j, k+<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//æ¢å¤charï¼Œå› ä¸ºå…¶ä»–é€’å½’é‡Œè¿˜éœ€è¦èµ°è¿‡è¿™ä¸ªchar</span></span><br><span class="line">        board[i][j] = tmp;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="13-æœºå™¨äººçš„è¿åŠ¨èŒƒå›´-DFS"><a href="#13-æœºå™¨äººçš„è¿åŠ¨èŒƒå›´-DFS" class="headerlink" title="13-æœºå™¨äººçš„è¿åŠ¨èŒƒå›´(DFS)"></a><a href="https://leetcode-cn.com/problems/ji-qi-ren-de-yun-dong-fan-wei-lcof/">13-æœºå™¨äººçš„è¿åŠ¨èŒƒå›´(DFS)</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_13_0</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m,n,k;</span><br><span class="line">    <span class="comment">//è¾…åŠ©çŸ©é˜µ</span></span><br><span class="line">    <span class="keyword">boolean</span>[][] visited;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">movingCount</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.m=m;</span><br><span class="line">        <span class="keyword">this</span>.n=n;</span><br><span class="line">        <span class="keyword">this</span>.k=k;</span><br><span class="line">        <span class="keyword">this</span>.visited = <span class="keyword">new</span> <span class="keyword">boolean</span>[m][n];</span><br><span class="line">        <span class="keyword">return</span> dfs(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> si, <span class="keyword">int</span> sj)</span></span>&#123;</span><br><span class="line">        <span class="comment">//å½“ â‘  è¡Œåˆ—ç´¢å¼•è¶Šç•Œ æˆ– â‘¡ æ•°ä½å’Œè¶…å‡ºç›®æ ‡å€¼ k æˆ– â‘¢ å½“å‰å…ƒç´ å·²è®¿é—®è¿‡ æ—¶ï¼Œè¿”å› 0 ï¼Œä»£è¡¨ä¸è®¡å…¥å¯è¾¾è§£ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (i&gt;=m || j&gt;=n || si+sj&gt;k || visited[i][j]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        visited[i][j] = <span class="keyword">true</span>;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * é€’æ¨å·¥ä½œï¼š</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         *     æ ‡è®°å½“å‰å•å…ƒæ ¼ ï¼šå°†ç´¢å¼• (i, j) å­˜å…¥ Set visited ä¸­ï¼Œä»£è¡¨æ­¤å•å…ƒæ ¼å·²è¢«è®¿é—®è¿‡ã€‚</span></span><br><span class="line"><span class="comment">         *     æœç´¢ä¸‹ä¸€å•å…ƒæ ¼ï¼š è®¡ç®—å½“å‰å…ƒç´ çš„ ä¸‹ã€å³ ä¸¤ä¸ªæ–¹å‘å…ƒç´ çš„æ•°ä½å’Œï¼Œå¹¶å¼€å¯ä¸‹å±‚é€’å½’ ã€‚</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * å›æº¯è¿”å›å€¼ï¼š è¿”å› 1 + å³æ–¹æœç´¢çš„å¯è¾¾è§£æ€»æ•° + ä¸‹æ–¹æœç´¢çš„å¯è¾¾è§£æ€»æ•°ï¼Œä»£è¡¨ä»æœ¬å•å…ƒæ ¼é€’å½’æœç´¢çš„å¯è¾¾è§£æ€»æ•°ã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">      <span class="comment">//æ³¨æ„æ•°ä½å’Œçš„å¢é‡å…¬å¼</span></span><br><span class="line">        <span class="comment">//(x + 1) % 10 != 0 ? s_x + 1 : s_x - 8</span></span><br><span class="line">        <span class="comment">//s_xä¸ºxçš„æ•°ä½å’Œ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>+dfs(i+<span class="number">1</span>, j, (i + <span class="number">1</span>) % <span class="number">10</span> != <span class="number">0</span> ? si + <span class="number">1</span> : si - <span class="number">8</span>, sj)+dfs(i,j+<span class="number">1</span>,si,(j+<span class="number">1</span>)%<span class="number">10</span>!=<span class="number">0</span>?sj+<span class="number">1</span>:sj-<span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Fibonacci-Dynamic-Programming"><a href="#Fibonacci-Dynamic-Programming" class="headerlink" title="Fibonacci (Dynamic Programming)"></a>Fibonacci (Dynamic Programming)</h2><h3 id="10-1-æ–æ³¢æ‹‰å¥‘æ•°åˆ—"><a href="#10-1-æ–æ³¢æ‹‰å¥‘æ•°åˆ—" class="headerlink" title="10-1-æ–æ³¢æ‹‰å¥‘æ•°åˆ—"></a><a href="https://leetcode-cn.com/problems/fei-bo-na-qi-shu-lie-lcof/">10-1-æ–æ³¢æ‹‰å¥‘æ•°åˆ—</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fib_10_1</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¦‚æœä»…ä»…æ˜¯ç”¨ç®€å•é€’å½’ï¼Œåœ¨æ—¶é—´å¤æ‚åº¦é—ªå°±ä¼šWAï¼Œç„¶åå°±éœ€è¦ç”¨åŠ¨æ€è§„åˆ’çš„æƒ³æ³•å»ç®€åŒ–è®¡ç®—é‡ã€‚</span></span><br><span class="line"><span class="comment">     * å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘çš„æ€è·¯æ˜¯ä»å°åˆ°å¤§ç®—å›å»ï¼ŒæŠŠæ²¿é€”çš„ç»“æœè¿›è¡Œè®°å½•ï¼Œæ¨åˆ°nã€‚</span></span><br><span class="line"><span class="comment">     * å…³äºé¢˜ç›®æè¿°ä¸­çš„å–æ¨¡è¿™é‡Œæä¸€å¥ï¼Œè¦åœ¨è®¡ç®—ä¸­å°±å–ï¼Œä¸è¦ç­‰åˆ°ç»“æœå†å–ï¼Œåœ¨è®¡ç®—è¿‡ç¨‹ä¸­å°±å·²ç»è¾¾åˆ°å–æ¨¡è¦æ±‚äº†ï¼Œå¦‚æœæ²¡æœ‰å–ï¼Œå¯èƒ½ä¼šæº¢å‡ºã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ¨æ€è§„åˆ’è§£æï¼š</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *     çŠ¶æ€å®šä¹‰ï¼š è®¾ dp ä¸ºä¸€ç»´æ•°ç»„ï¼Œå…¶ä¸­ dp[i]dp[i]dp[i] çš„å€¼ä»£è¡¨ æ–æ³¢é‚£å¥‘æ•°åˆ—ç¬¬ i ä¸ªæ•°å­— ã€‚</span></span><br><span class="line"><span class="comment">     *     è½¬ç§»æ–¹ç¨‹ï¼š dp[i]=dp[i-1]+dp[iâˆ’2]ï¼Œå³å¯¹åº”æ•°åˆ—å®šä¹‰ F(N) = F(N - 1) + F(N - 2)</span></span><br><span class="line"><span class="comment">     *     åˆå§‹çŠ¶æ€ï¼š dp[0]=1 dp[1]=1 ï¼Œå³åˆå§‹åŒ–å‰ä¸¤ä¸ªæ•°å­—ï¼›</span></span><br><span class="line"><span class="comment">     *     è¿”å›å€¼ï¼š dp[n]] ï¼Œå³æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬ n ä¸ªæ•°å­—ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_10_1_0</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">fib</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span> || n==<span class="number">1</span>) <span class="keyword">return</span> n;</span><br><span class="line">        <span class="keyword">long</span>[] dp = <span class="keyword">new</span> <span class="keyword">long</span>[n+<span class="number">1</span>];</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        dp[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            dp[i] = dp[i-<span class="number">1</span>] + dp[i-<span class="number">2</span>];</span><br><span class="line">            <span class="comment">//åœ¨è®¡ç®—ä¸­å°±æ›²æ‘¸ï¼Œä¸ç„¶ä¼šæº¢å‡º</span></span><br><span class="line">            dp[i] = dp[i]%<span class="number">1000000007</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="10-2-é’è›™è·³å°é˜¶é—®é¢˜"><a href="#10-2-é’è›™è·³å°é˜¶é—®é¢˜" class="headerlink" title="10-2-é’è›™è·³å°é˜¶é—®é¢˜ "></a><a href="https://leetcode-cn.com/problems/qing-wa-tiao-tai-jie-wen-ti-lcof/">10-2-é’è›™è·³å°é˜¶é—®é¢˜ </a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">numWays_10_2</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ¨æ€è§„åˆ’è§£æï¼š</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *     çŠ¶æ€å®šä¹‰ï¼š è®¾ dp ä¸ºä¸€ç»´æ•°ç»„ï¼Œå…¶ä¸­ dp[i]dp[i]dp[i] çš„å€¼ä»£è¡¨ æ–æ³¢é‚£å¥‘æ•°åˆ—ç¬¬ i ä¸ªæ•°å­— ã€‚</span></span><br><span class="line"><span class="comment">     *     è½¬ç§»æ–¹ç¨‹ï¼š dp[i]=dp[i-1]+dp[iâˆ’2]ï¼Œå³å¯¹åº”æ•°åˆ—å®šä¹‰ F(N) = F(N - 1) + F(N - 2)</span></span><br><span class="line"><span class="comment">     *     åˆå§‹çŠ¶æ€ï¼š dp[0]=1 dp[1]=1 dp[2]=2 ï¼Œå³åˆå§‹åŒ–å‰ä¸‰ä¸ªæ•°å­—ï¼›</span></span><br><span class="line"><span class="comment">     *     è¿”å›å€¼ï¼š dp[n]] ï¼Œå³æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬ n ä¸ªæ•°å­—ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_10_2_0</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">numWays</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span> || n==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (n==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">long</span>[] dp = <span class="keyword">new</span> <span class="keyword">long</span>[n+<span class="number">1</span>];</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        dp[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        dp[<span class="number">2</span>] = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">3</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            dp[i] = (dp[i-<span class="number">1</span>] + dp[i-<span class="number">2</span>]) % <span class="number">1000000007</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Searching-Algorithms-Binary-Search"><a href="#Searching-Algorithms-Binary-Search" class="headerlink" title="Searching Algorithms (Binary Search)"></a>Searching Algorithms (Binary Search)</h2><h3 id="04-äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾"><a href="#04-äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾" class="headerlink" title="04-äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾ "></a><a href="https://leetcode-cn.com/problems/er-wei-shu-zu-zhong-de-cha-zhao-lcof/">04-äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾ </a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">findNumberIn2DArray_04</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_04_0</span></span>&#123;</span><br><span class="line">    <span class="comment">//çº¿æ€§æŸ¥æ‰¾ Linear Search</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">findNumberIn2DArray</span><span class="params">(<span class="keyword">int</span>[][] matrix, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è¡Œæ•°</span></span><br><span class="line">        <span class="keyword">int</span> i = matrix.length-<span class="number">1</span>;</span><br><span class="line">        <span class="comment">//åˆ—æ•°</span></span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * åˆ™ int flag = matrix[i][j] ä»£è¡¨å·¦ä¸‹è§’å…ƒç´ ï¼ˆæ ‡å¿—æ•°ï¼‰</span></span><br><span class="line"><span class="comment">         * å·¦ä¸‹è§’å…ƒç´ ï¼š ä¸ºæ‰€åœ¨åˆ—æœ€å¤§å…ƒç´ ï¼Œæ‰€åœ¨è¡Œæœ€å°å…ƒç´ </span></span><br><span class="line"><span class="comment">         * å¦‚æœflagå¤§äºtargetï¼Œå°±åˆ°ä¸Šä¸€è¡Œæ‰¾ï¼Œä¹Ÿå°±æ˜¯i--ï¼Œå› ä¸ºå·²çŸ¥flagæ˜¯æ‰€åœ¨è¡Œæœ€å°çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">         * å¦‚æœflagå°äºtargetï¼Œå°±åˆ°ä¸‹ä¸€åˆ—ï¼Œj++ï¼Œå› ä¸ºflagæ˜¯è¿™ä¸€åˆ—æœ€å¤§çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">         * å¦‚æœflag ==  targetï¼Œåˆ™return true</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">while</span> (i&gt;=<span class="number">0</span> &amp;&amp; j&lt;matrix[<span class="number">0</span>].length)&#123;</span><br><span class="line">            <span class="keyword">if</span> (matrix[i][j]&gt;target) i--;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (matrix[i][j]&lt;target) j++;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_04_1</span></span>&#123;</span><br><span class="line">    <span class="comment">//äºŒåˆ†æŸ¥æ‰¾  Binary Search</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">findNumberIn2DArray</span><span class="params">(<span class="keyword">int</span>[][] matrix, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ€è·¯åˆ†æï¼š</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * è¦æŸ¥æ‰¾çŸ©é˜µä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå…ƒç´ ï¼Œå¹¶ä¸”è¡¨ç¤ºçŸ©é˜µæ¯ä¸€è¡Œçš„æ•°ç»„éƒ½æ˜¯æœ‰åºçš„ï¼Œå¯ä»¥å¯¹æ¯ä¸€è¡Œè¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œå¦‚æœæ¯ä¸€è¡Œéƒ½æ²¡æœ‰æŸ¥æ‰¾åˆ°ç»“æœï¼Œå°±è¿”å›falseã€‚</span></span><br><span class="line"><span class="comment">         *     ä½¿ç”¨javaåº“å‡½æ•°Arrays.binarySearch(matrix[i], target)ï¼Œè¿”å›å€¼éè´Ÿè¯´æ˜æŸ¥æ‰¾åˆ°targetã€‚</span></span><br><span class="line"><span class="comment">         * è¿˜éœ€è¦å¤„ç†ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼š</span></span><br><span class="line"><span class="comment">         *     ç»™å®šçš„çŸ©é˜µä¸ºnullæˆ–è€…ç»™å®šçš„çŸ©é˜µä¸å­˜åœ¨ä»»ä½•å…ƒç´ matrix.length == 0 || matrix[0].length == 0ï¼Œè‚¯å®šæ‰¾ä¸åˆ°ç›®æ ‡å…ƒç´ ï¼Œç›´æ¥è¿”å›ã€‚</span></span><br><span class="line"><span class="comment">         *     çŸ©é˜µçš„æ¯ä¸€åˆ—ä¹Ÿæ˜¯ä»å°åˆ°è¾¾æ’åˆ—çš„ï¼Œæ‰€ä»¥åœ¨å¯¹æ¯ä¸€è¡Œè¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾çš„å¾ªç¯æ˜¯ï¼Œå¦‚æœmatrix[i][0] &gt; targetï¼Œ</span></span><br><span class="line"><span class="comment">         *     è¿™ä¸€è¡Œè‚¯å®šæ²¡æœ‰æŒ‡å®šå…ƒç´ ï¼Œæ›´ä¸‹é¢çš„æ¯ä¸€è¡Œçš„æ‰€æœ‰å…ƒç´ éƒ½å¤§äºmatrix[i][0]ä¹Ÿä¸€å®šæ‰¾ä¸åˆ°æŒ‡å®šå…ƒç´ ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¿”å›falseã€‚</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (matrix==<span class="keyword">null</span> || matrix.length==<span class="number">0</span> || matrix[<span class="number">0</span>].length==<span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;matrix.length;i++)&#123;</span><br><span class="line">            <span class="comment">//å¦‚æœArrays.binarySearch(matrix[i],target)æ˜¯éé›¶æ•°åˆ™è¡¨ç¤ºè¯¥è¡Œå«æœ‰target</span></span><br><span class="line">            <span class="keyword">if</span> (Arrays.binarySearch(matrix[i],target)&gt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            <span class="comment">//å¦‚æœmatrix[i][0]&gt;targetè¿™ä¸€è¡Œå°±ä¸åŒ…æ‹¬targetï¼Œå› ä¸ºmatrix[i][0]æ˜¯è¯¥è¡Œç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ¯ä¸€åˆ—å’Œæ¯ä¸€è¡Œéƒ½æ˜¯é€’å¢çš„ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">            <span class="comment">//éƒ½æ¯”targetå¤§ï¼Œé‚£è¯´æ˜è¯¥è¡Œä¸åŒ…å«è¯¥å…ƒç´ ï¼Œä¸”å› ä¸ºé€’å¢ï¼Œä¸‹ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸€å®šæ¯”targetå¤§ï¼Œæ‰€ä»¥return falseç»“æŸå¾ªç¯</span></span><br><span class="line">            <span class="keyword">if</span> (matrix[i][<span class="number">0</span>]&gt;target) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="11-æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—ï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰"><a href="#11-æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—ï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰" class="headerlink" title="11-æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—ï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰"></a><a href="https://leetcode-cn.com/problems/xuan-zhuan-shu-zu-de-zui-xiao-shu-zi-lcof/">11-æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—ï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">minArray_11</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_11_0</span></span>&#123;</span><br><span class="line">    <span class="comment">//æ²™é›•åšæ³•</span></span><br><span class="line">    <span class="comment">//ç¬”è¯•çš„æ—¶å€™å¯ä»¥ç”¨ï¼Œé¢è¯•åˆ«ç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minArray</span><span class="params">(<span class="keyword">int</span>[] numbers)</span> </span>&#123;</span><br><span class="line">        Arrays.sort(numbers);</span><br><span class="line">        <span class="keyword">return</span> numbers[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_11_1</span></span>&#123;</span><br><span class="line">    <span class="comment">//äºŒåˆ†æœç´¢ Binary Search</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minArray</span><span class="params">(<span class="keyword">int</span>[] numbers)</span></span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * è®¾è®¡ä¸¤ä¸ªæŒ‡é’ˆiå’Œjåˆ†åˆ«æŒ‡å‘0å’Œnumbers.length-1</span></span><br><span class="line"><span class="comment">         * m = (i+j)/2 æ˜¯ä¸­é—´æ•°ï¼Œé‚£ä¹ˆä¼šæœ‰ä¸‰ç§æƒ…å†µ</span></span><br><span class="line"><span class="comment">         * 1ï¼šnumbers[m]&lt;numbers[j] è¯´æ˜måœ¨å³è¾¹æ•°ç»„[m+1,j]ï¼Œæ—‹è½¬ç‚¹åœ¨[i,m], æ‰€ä»¥æ›´æ–°j=mï¼Œm=(i+j)/2</span></span><br><span class="line"><span class="comment">         * 2ï¼šnumber[m]&gt;numbers[j] è¯´æ˜måœ¨å·¦è¾¹æ•°ç»„,æ—‹è½¬ç‚¹åœ¨[m+1,j]ï¼Œæ‰€ä»¥æ›´æ–°i=m+1,m=(i+j)/2</span></span><br><span class="line"><span class="comment">         * 3ï¼šnumber[m]==numbers[j] æ— æ³•åˆ¤æ–­ mmm åœ¨å“ªä¸ªæ’åºæ•°ç»„ä¸­ï¼Œå³æ— æ³•åˆ¤æ–­æ—‹è½¬ç‚¹åœ¨ [i,m] è¿˜æ˜¯ [m+1,j] åŒºé—´ä¸­ã€‚</span></span><br><span class="line"><span class="comment">         * è§£å†³æ–¹æ¡ˆï¼š æ‰§è¡Œ j=jâˆ’1 ç¼©å°åˆ¤æ–­èŒƒå›´</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">0</span>, j= numbers.length-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (i&lt;j)&#123;</span><br><span class="line">            <span class="keyword">int</span> m = (i+j)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (numbers[m]&lt;numbers[j])&#123;</span><br><span class="line">                j=m;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span> (numbers[m]&gt;numbers[j])&#123;</span><br><span class="line">                i=m+<span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span> (numbers[m]==numbers[j])&#123;</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> numbers[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_11_2</span></span>&#123;</span><br><span class="line">    <span class="comment">//æš´åŠ›æ³• å±…ç„¶æ˜¯è¿™ä¸‰ç§åŠæ³•é‡Œæœ€å¿«çš„QAQ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minArray</span><span class="params">(<span class="keyword">int</span>[] numbers)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;numbers.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (numbers[i]&lt;numbers[<span class="number">0</span>])&#123;</span><br><span class="line">                <span class="keyword">return</span> numbers[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> numbers[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="56-1-æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•°"><a href="#56-1-æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•°" class="headerlink" title="56-1-æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•°"></a><a href="https://leetcode-cn.com/problems/shu-zu-zhong-shu-zi-chu-xian-de-ci-shu-lcof/">56-1-æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•°</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">singleNumbers_56_1</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * éš¾ç‚¹ä¸»è¦åœ¨äºå¯¹maskçš„ç†è§£ã€‚maskæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ•°ï¼Œä¸”å…¶ä¸­åªæœ‰ä¸€ä½æ˜¯1ï¼Œå…¶ä»–ä½å…¨æ˜¯0ï¼Œ</span></span><br><span class="line"><span class="comment">     * æ¯”å¦‚000010ï¼Œè¡¨ç¤ºæˆ‘ä»¬ç”¨å€’æ•°ç¬¬äºŒä½ä½œä¸ºåˆ†ç»„æ ‡å‡†ï¼Œå€’æ•°ç¬¬äºŒä½æ˜¯0çš„æ•°å­—åˆ†åˆ°ä¸€ç»„ï¼Œå€’æ•°ç¬¬äºŒä½æ˜¯1çš„åˆ†åˆ°å¦ä¸€ç»„ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * é‚£ä¹ˆå¦‚ä½•å¾—åˆ°è¿™ä¸ªmask?å› ä¸ºæˆ‘ä»¬åˆ†ç»„çš„ç›®çš„å°±æ˜¯å°†ä¸¤ä¸ªä¸é‡å¤æ•°å­—åˆ†å¼€ï¼Œ</span></span><br><span class="line"><span class="comment">     * è¿™ä¸¤ä¸ªä¸é‡å¤æ•°å­—çš„äºŒè¿›åˆ¶è¡¨ç¤ºè‚¯å®šæ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡å¿…è¦ä¸€ä½ä¸€ä½åœ°æ¯”è¾ƒï¼Œæˆ‘ä»¬å¯ä»¥ä»å³åˆ°å·¦ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸ç›¸åŒçš„ä½ï¼Œå°†maskå½“ä¸­è¿™ä¸€ä½å˜æˆ1,å°±å¾—åˆ°äº†maskã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * æ¯”å¦‚[2,2,3,3,4,6]ä¸­ï¼Œä¸é‡å¤çš„ä¸¤ä¸ªæ•°å­—æ˜¯4ï¼Œ6ï¼Œ4å’Œ6çš„å¼‚æˆ–ç»“æœï¼ˆä¹Ÿæ˜¯æ•´ä¸ªæ•°ç»„çš„å¼‚æˆ–ç»“æœï¼‰æ˜¯010ï¼Œ</span></span><br><span class="line"><span class="comment">     * è¡¨ç¤ºä»å³åˆ°å·¦ï¼Œç¬¬ä¸€æ¬¡å‡ºç°ä¸åŒæ˜¯åœ¨å€’æ•°ç¬¬äºŒä½ï¼Œé‚£ä¹ˆå¯ä»¥ç¡®å®šï¼Œmaskçš„å€’æ•°ç¬¬äºŒä½æ˜¯1ï¼Œå…¶ä»–ä½æ˜¯0ï¼Œå³</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution_56_1_0</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] singleNumbers(<span class="keyword">int</span>[] nums) &#123;</span><br><span class="line">        <span class="comment">//xorç”¨æ¥è®¡ç®—numsçš„å¼‚æˆ–å’Œ</span></span><br><span class="line">        <span class="keyword">int</span> xor = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¡ç®—å¼‚æˆ–å’Œ å¹¶å­˜åˆ°xor</span></span><br><span class="line">        <span class="comment">// e.g. [2,4,2,3,3,6] å¼‚æˆ–å’Œï¼š(2^2)^(3^3)^(4^6)=2=010</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> num : nums) xor ^= num;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®maskä¸º1ï¼Œåˆ™äºŒè¿›åˆ¶ä¸º0001</span></span><br><span class="line">        <span class="comment">// maskæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ•°ï¼Œä¸”å…¶ä¸­åªæœ‰ä¸€ä½æ˜¯1ï¼Œå…¶ä»–ä½å…¨æ˜¯0ï¼Œæ¯”å¦‚000010ï¼Œ</span></span><br><span class="line">        <span class="comment">// è¡¨ç¤ºæˆ‘ä»¬ç”¨å€’æ•°ç¬¬äºŒä½ä½œä¸ºåˆ†ç»„æ ‡å‡†ï¼Œå€’æ•°ç¬¬äºŒä½æ˜¯0çš„æ•°å­—åˆ†åˆ°ä¸€ç»„ï¼Œå€’æ•°ç¬¬äºŒä½æ˜¯1çš„åˆ†åˆ°å¦ä¸€ç»„</span></span><br><span class="line">        <span class="keyword">int</span> mask = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &amp; operatoråªæœ‰1&amp;1æ—¶ç­‰äº1 å…¶ä½™ç­‰äº0</span></span><br><span class="line">        <span class="comment">// ç”¨ä¸Šé¢çš„e.g. 4å’Œ6çš„äºŒè¿›åˆ¶æ˜¯ä¸åŒçš„ æˆ‘ä»¬ä»å³åˆ°å·¦æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸åŒçš„ä½å°±å¯ä»¥åˆ†ç»„ 4=0100 6=0110</span></span><br><span class="line">        <span class="comment">// æ ¹æ®e.g. 010 &amp; 001 = 000 = 0åˆ™ mask=010</span></span><br><span class="line">        <span class="comment">// 010 &amp; 010 != 0 æ‰€ä»¥mask=010</span></span><br><span class="line">        <span class="comment">// ä¹‹åå°±å¯ä»¥ç”¨maskæ¥å°†æ•°ç»„é‡Œçš„ä¸¤ä¸ªæ•°åˆ†åŒºåˆ†å¼€</span></span><br><span class="line">        <span class="keyword">while</span>((xor &amp; mask)==<span class="number">0</span>)&#123;</span><br><span class="line">            mask &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸¤ä¸ªåªå‡ºç°ä¸€æ¬¡çš„æ•°å­—</span></span><br><span class="line">        <span class="keyword">int</span> a=<span class="number">0</span>, b=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> num : nums)&#123;</span><br><span class="line">            <span class="comment">//æ ¹æ®&amp;æ˜¯å¦ä¸º0åŒºåˆ†å°†ä¸¤ä¸ªæ•°å­—åˆ†åŒºï¼Œå¹¶åˆ†åˆ«æ±‚å¼‚æˆ–å’Œ</span></span><br><span class="line">            <span class="keyword">if</span>((num &amp; mask)==<span class="number">0</span>) a ^= num;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                b ^= num;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;a,b&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å‰‘æŒ‡Offer-è§£é¢˜è®°å½•&quot;&gt;&lt;a href=&quot;#å‰‘æŒ‡Offer-è§£é¢˜è®°å½•&quot; class=&quot;headerlink&quot; title=&quot;å‰‘æŒ‡Offer_è§£é¢˜è®°å½•&quot;&gt;&lt;/a&gt;å‰‘æŒ‡Offer_è§£é¢˜è®°å½•&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;ğŸ“åˆ†äº«å’Œè®°å½•åšé¢˜çš„æ€è·¯&lt;/li&gt;
&lt;li&gt;å“ˆå“ˆ&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Notes" scheme="http://yifanzhang13.github.io/categories/Notes/"/>
    
    
      <category term="LeetCode" scheme="http://yifanzhang13.github.io/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>MachineLearning_Notes</title>
    <link href="http://yifanzhang13.github.io/2020/06/14/MachineLearning-Notes/"/>
    <id>http://yifanzhang13.github.io/2020/06/14/MachineLearning-Notes/</id>
    <published>2020-06-14T09:15:38.000Z</published>
    <updated>2020-06-16T02:15:46.102Z</updated>
    
    <content type="html"><![CDATA[<p>This is a study note for <a href="https://www.coursera.org/learn/machine-learning"><strong>Machine Learning_Andrew Ng</strong></a>:</p><p>It includes notes from Internet and my own notes.</p><a id="more"></a><h1 id="Week-1"><a href="#Week-1" class="headerlink" title="Week 1"></a>Week 1</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><h3 id="What-is-machine-learning"><a href="#What-is-machine-learning" class="headerlink" title="What is machine learning?"></a>What is machine learning?</h3><p>There are 2 definitions:</p><ol><li><p><strong>Arthur Samuel</strong> described it as: â€œ<strong>the field of study that gives computers  the ability to learn without being explicitly programmed</strong>.â€ This is an  older, informal definition.</p></li><li><p><strong>Tom Mitchell</strong> provides a more modern definition: â€œ<strong>A computer program  is said to learn from experience E with respect to some class of tasks T and performance measure P, if its performance at tasks in T, as  measured by P, improves with experience E.</strong>â€œ</p><p>Example: playing checkers.</p><p>E = the experience of playing many games of checkers</p><p>T = the task of playing checkers.</p><p>P = the probability that the program will win the next game.</p><p>In general, any machine learning problem can be assigned to one of two broad classifications:</p><p>Supervised learning and Unsupervised learning.</p></li></ol><h3 id="Supervied-Learning"><a href="#Supervied-Learning" class="headerlink" title="Supervied Learning"></a>Supervied Learning</h3><p>In supervised learning, we are <strong>given a data set</strong> and <strong>already know what our  correct output should look like</strong>, having the idea that there is a  relationship between the input and the output.</p><p>Supervised learning problems are categorized into â€œ<strong>regression</strong>â€œ and â€œ<strong>classification</strong>â€œ  problems:</p><ol><li><p>In a regression problem, we are trying to predict results  within a <strong>continuous output</strong>, meaning that we are trying to <strong>map input  variables to some</strong> <strong>continuous function</strong>.</p></li><li><p>In a classification problem, we  are instead trying to predict results in a <strong>discrete output</strong>. In other  words, we are trying to <strong>map input variables into discrete categories</strong>. </p></li></ol><p><strong>Example 1:</strong></p><p>Given data about the size of houses on the real estate market, try to predict their price. Price as a function of size is a continuous output, so  this is a regression problem.</p><p>We could turn this example into a  classification problem by instead making our output about whether the  house â€œsells for more or less than the asking price.â€ Here we are  classifying the houses based on price into two discrete categories.</p><p><strong>Example 2</strong>:</p><p>(a) Regression - Given a picture of a person, we have to predict their age on the basis of the given picture</p><p>(b) Classification - Given a patient with a tumor, we have to predict whether the tumor is malignant or benign. </p><h3 id="Unsupervised-Learning"><a href="#Unsupervised-Learning" class="headerlink" title="Unsupervised Learning"></a>Unsupervised Learning</h3><p>Unsupervised learning allows us to approach problems with <strong>little or no idea what our results should look like</strong>. We can <strong>derive structure from data</strong> where we  donâ€™t necessarily know the effect of the variables.</p><p>We can derive this structure by <strong>clustering the data</strong> based on relationships among the variables in the data.</p><p>With unsupervised learning there is <strong>no feedback</strong> based on the prediction results.</p><p><strong>Example:</strong></p><p>Clustering: Take a collection of 1,000,000 different genes, and find a way to  automatically group these genes into groups that are somehow similar or  related by different variables, such as lifespan, location, roles, and  so on.</p><p>Non-clustering: The â€œCocktail Party Algorithmâ€, allows you  to find structure in a chaotic environment. (i.e. identifying individual voices and music from a mesh of sounds at a <a href="https://en.wikipedia.org/wiki/Cocktail_party_effect">cocktail party</a>).</p><h2 id="Model-and-Cost-Function"><a href="#Model-and-Cost-Function" class="headerlink" title="Model and Cost Function"></a>Model and Cost Function</h2><h3 id="Model-Representation"><a href="#Model-Representation" class="headerlink" title="Model Representation"></a>Model Representation</h3><p>![image-20200615170301978](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200615170301978.png)</p><h3 id="Cost-Function-1-0"><a href="#Cost-Function-1-0" class="headerlink" title="Cost Function 1.0"></a>Cost Function 1.0</h3><p>![image-20200615172340058](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200615172340058.png)</p><p>![image-20200615172530793](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200615172530793.png)</p><h3 id="Cost-Function-1-1"><a href="#Cost-Function-1-1" class="headerlink" title="Cost Function 1.1"></a>Cost Function 1.1</h3><p>![image-20200615204145231](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200615204145231.png)</p><p>![image-20200615204157751](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200615204157751.png)</p><p>![image-20200615204236086](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200615204236086.png)</p><h3 id="Cost-Function-1-2"><a href="#Cost-Function-1-2" class="headerlink" title="Cost Function 1.2"></a>Cost Function 1.2</h3><p>![image-20200615205454678](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200615205454678.png)</p><p>![image-20200615205549667](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200615205549667.png)</p><p>![image-20200615205601781](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200615205601781.png)</p><h2 id="Parameter-Learning"><a href="#Parameter-Learning" class="headerlink" title="Parameter Learning"></a>Parameter Learning</h2><h3 id="Gradient-Descent-Algorithm-1-0"><a href="#Gradient-Descent-Algorithm-1-0" class="headerlink" title="Gradient Descent Algorithm 1.0"></a>Gradient Descent Algorithm 1.0</h3><p>![image-20200615225814617](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200615225814617.png)</p><p>![image-20200615225826171](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200615225826171.png)</p><h3 id="Gradient-Descent-Algorithm-1-1"><a href="#Gradient-Descent-Algorithm-1-1" class="headerlink" title="Gradient Descent Algorithm 1.1"></a>Gradient Descent Algorithm 1.1</h3><p>![image-20200616095147861](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200616095147861.png)</p><p>![image-20200616095158666](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200616095158666.png)</p><p>![image-20200616095206864](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200616095206864.png)</p><h3 id="Gradient-Descent-Algorithm-1-2"><a href="#Gradient-Descent-Algorithm-1-2" class="headerlink" title="Gradient Descent Algorithm 1.2"></a>Gradient Descent Algorithm 1.2</h3><p>![image-20200616101447288](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200616101447288.png)</p><p>![image-20200616101544398](/Users/yifancheung/Library/Application Support/typora-user-images/image-20200616101544398.png)</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;This is a study note for &lt;a href=&quot;https://www.coursera.org/learn/machine-learning&quot;&gt;&lt;strong&gt;Machine Learning_Andrew Ng&lt;/strong&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;It includes notes from Internet and my own notes.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Note" scheme="http://yifanzhang13.github.io/categories/Note/"/>
    
    
      <category term="Machine Learning" scheme="http://yifanzhang13.github.io/tags/Machine-Learning/"/>
    
  </entry>
  
  <entry>
    <title>CyclicBarrier-æºç åˆ†æ</title>
    <link href="http://yifanzhang13.github.io/2020/05/29/CyclicBarrier-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
    <id>http://yifanzhang13.github.io/2020/05/29/CyclicBarrier-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</id>
    <published>2020-05-29T06:09:57.000Z</published>
    <updated>2020-05-29T06:13:58.205Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1 å‰è¨€"></a>1 å‰è¨€</h1><p>CyclicBarrieræ˜¯ä¸€ä¸ªåŒæ­¥è¾…åŠ©ç±»ï¼Œå®ƒå…è®¸ä¸€ç»„çº¿ç¨‹äº’ç›¸ç­‰å¾…ï¼Œç›´åˆ°åˆ°è¾¾æŸä¸ªå…¬å…±å±éšœç‚¹(common barrier  point)ã€‚åœ¨æ¶‰åŠä¸€ç»„å›ºå®šå¤§å°çš„çº¿ç¨‹çš„ç¨‹åºä¸­ï¼Œè¿™äº›çº¿ç¨‹å¿…é¡»ä¸æ—¶åœ°äº’ç›¸ç­‰å¾…ï¼Œæ­¤æ—¶CyclicBarrierå¾ˆæœ‰ç”¨ã€‚å› ä¸ºè¯¥barrieråœ¨é‡Šæ”¾ç­‰å¾…çº¿ç¨‹åå¯ä»¥é‡ç”¨ï¼Œæ‰€ä»¥ç§°å®ƒä¸ºå¾ªç¯çš„barrier</p><a id="more"></a><h1 id="2-å†…éƒ¨ç±»"><a href="#2-å†…éƒ¨ç±»" class="headerlink" title="2 å†…éƒ¨ç±»"></a>2 å†…éƒ¨ç±»</h1><p>è¯¥å†…éƒ¨ç±»ç”¨äºæ ‡è®°ä¸€æ¬¡Barrierç”Ÿå‘½å‘¨æœŸçš„çŠ¶æ€</p><ol><li>trueï¼šBarrierè¢«æ‰“æ–­ï¼Œè°ƒç”¨await()æ–¹æ³•å°†ä¼šæŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸</li><li>falseï¼šBarrieræœ‰æ•ˆ</li></ol><p>ä¸€æ¬¡Barrierç”Ÿå‘½å‘¨æœŸä¸­Barrierçš„çŠ¶æ€ä¸ä¼šå½±å“åˆ°ä¸‹ä¸€æ¬¡ç”Ÿå‘½å‘¨æœŸ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Each use of the barrier is represented as a generation instance.</span></span><br><span class="line"><span class="comment"> * The generation changes whenever the barrier is tripped, or</span></span><br><span class="line"><span class="comment"> * is reset. There can be many generations associated with threads</span></span><br><span class="line"><span class="comment"> * using the barrier - due to the non-deterministic way the lock</span></span><br><span class="line"><span class="comment"> * may be allocated to waiting threads - but only one of these</span></span><br><span class="line"><span class="comment"> * can be active at a time (the one to which &#123;<span class="doctag">@code</span> count&#125; applies)</span></span><br><span class="line"><span class="comment"> * and all the rest are either broken or tripped.</span></span><br><span class="line"><span class="comment"> * There need not be an active generation if there has been a break</span></span><br><span class="line"><span class="comment"> * but no subsequent reset.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Generation</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> broken = <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="3-å­—æ®µ"><a href="#3-å­—æ®µ" class="headerlink" title="3 å­—æ®µ"></a>3 å­—æ®µ</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/** The lock for guarding barrier entry */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> ReentrantLock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"><span class="comment">/** Condition to wait on until tripped */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Condition trip = lock.newCondition();</span><br><span class="line"><span class="comment">/** The number of parties */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> parties;</span><br><span class="line"><span class="comment">/* The command to run when tripped */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Runnable barrierCommand;</span><br><span class="line"><span class="comment">/** The current generation */</span></span><br><span class="line"><span class="keyword">private</span> Generation generation = <span class="keyword">new</span> Generation();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Number of parties still waiting. Counts down from parties to 0</span></span><br><span class="line"><span class="comment"> * on each generation.  It is reset to parties on each new</span></span><br><span class="line"><span class="comment"> * generation or when broken.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> count;</span><br></pre></td></tr></table></figure><ul><li><strong>lock</strong>ï¼šé‡å…¥é”</li><li><strong>trip</strong>ï¼šæ¡ä»¶å¯¹è±¡ï¼Œæ˜¯AQS-ConditionObjectå†…éƒ¨ç±»</li><li><strong>parties</strong>ï¼šåˆ°è¾¾barrierçš„ç‰©ä½“æ•°é‡</li><li><strong>barrierCommand</strong>ï¼šä¸ºäº†å¢åŠ CyclicBarrierçš„ç”Ÿå‘½å‘¨æœŸï¼Œå½“è¶³å¤Ÿå¤šçš„çº¿ç¨‹é€šè¿‡å±éšœæ—¶ï¼Œè°ƒç”¨ç›¸åº”çš„å¤„ç†é€»è¾‘ï¼Œå¯ç”±æ„é€ æ–¹æ³•ä¼ å…¥</li><li><strong>generation</strong>ï¼šæ ‡è®°æœ¬æ¬¡ç”Ÿå‘½å‘¨æœŸçš„Barrierçš„çŠ¶æ€ï¼Œå¦‚æœä¸ºtrueï¼Œåˆ™Barrierå¤±æ•ˆã€‚åˆ°äº†next Generationåï¼Œåˆä¼šé‡æ–°æŒ‡å‘ä¸€ä¸ªæ–°çš„Generationå¯¹è±¡</li><li><strong>count</strong>ï¼šè®¡æ•°å€¼</li></ul><h1 id="4-é‡è¦æ–¹æ³•"><a href="#4-é‡è¦æ–¹æ³•" class="headerlink" title="4 é‡è¦æ–¹æ³•"></a>4 é‡è¦æ–¹æ³•</h1><h2 id="4-1-æ„é€ æ–¹æ³•"><a href="#4-1-æ„é€ æ–¹æ³•" class="headerlink" title="4.1 æ„é€ æ–¹æ³•"></a>4.1 æ„é€ æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Creates a new &#123;<span class="doctag">@code</span> CyclicBarrier&#125; that will trip when the</span></span><br><span class="line"><span class="comment"> * given number of parties (threads) are waiting upon it, and</span></span><br><span class="line"><span class="comment"> * does not perform a predefined action when the barrier is tripped.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> parties the number of threads that must invoke &#123;<span class="doctag">@link</span> #await&#125;</span></span><br><span class="line"><span class="comment"> *        before the barrier is tripped</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> parties&#125; is less than 1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">CyclicBarrier</span><span class="params">(<span class="keyword">int</span> parties)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>(parties, <span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Creates a new &#123;<span class="doctag">@code</span> CyclicBarrier&#125; that will trip when the</span></span><br><span class="line"><span class="comment"> * given number of parties (threads) are waiting upon it, and which</span></span><br><span class="line"><span class="comment"> * will execute the given barrier action when the barrier is tripped,</span></span><br><span class="line"><span class="comment"> * performed by the last thread entering the barrier.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> parties the number of threads that must invoke &#123;<span class="doctag">@link</span> #await&#125;</span></span><br><span class="line"><span class="comment"> *        before the barrier is tripped</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> barrierAction the command to execute when the barrier is</span></span><br><span class="line"><span class="comment"> *        tripped, or &#123;<span class="doctag">@code</span> null&#125; if there is no action</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> IllegalArgumentException if &#123;<span class="doctag">@code</span> parties&#125; is less than 1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">CyclicBarrier</span><span class="params">(<span class="keyword">int</span> parties, Runnable barrierAction)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (parties &lt;= <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</span><br><span class="line">    <span class="keyword">this</span>.parties = parties;</span><br><span class="line">    <span class="keyword">this</span>.count = parties;</span><br><span class="line">    <span class="keyword">this</span>.barrierCommand = barrierAction;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-2-await"><a href="#4-2-await" class="headerlink" title="4.2 await"></a>4.2 await</h2><p>awaitæ–¹æ³•é˜»å¡å½“å‰çº¿ç¨‹ç›´è‡³ç´¯è®¡æœ‰countï¼ˆæ„é€ æ–¹æ³•çš„å‚æ•°ï¼‰ä¸ªçº¿ç¨‹é˜»å¡åœ¨äº†awaitæ–¹æ³•ä¸Š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Waits until all &#123;<span class="doctag">@linkplain</span> #getParties parties&#125; have invoked</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> await&#125; on this barrier.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;If the current thread is not the last to arrive then it is</span></span><br><span class="line"><span class="comment"> * disabled for thread scheduling purposes and lies dormant until</span></span><br><span class="line"><span class="comment"> * one of the following things happens:</span></span><br><span class="line"><span class="comment"> * &lt;ul&gt;</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;The last thread arrives; or</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;Some other thread &#123;<span class="doctag">@linkplain</span> Thread#interrupt interrupts&#125;</span></span><br><span class="line"><span class="comment"> * the current thread; or</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;Some other thread &#123;<span class="doctag">@linkplain</span> Thread#interrupt interrupts&#125;</span></span><br><span class="line"><span class="comment"> * one of the other waiting threads; or</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;Some other thread times out while waiting for barrier; or</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;Some other thread invokes &#123;<span class="doctag">@link</span> #reset&#125; on this barrier.</span></span><br><span class="line"><span class="comment"> * &lt;/ul&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;If the current thread:</span></span><br><span class="line"><span class="comment"> * &lt;ul&gt;</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;has its interrupted status set on entry to this method; or</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;is &#123;<span class="doctag">@linkplain</span> Thread#interrupt interrupted&#125; while waiting</span></span><br><span class="line"><span class="comment"> * &lt;/ul&gt;</span></span><br><span class="line"><span class="comment"> * then &#123;<span class="doctag">@link</span> InterruptedException&#125; is thrown and the current thread's</span></span><br><span class="line"><span class="comment"> * interrupted status is cleared.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;If the barrier is &#123;<span class="doctag">@link</span> #reset&#125; while any thread is waiting,</span></span><br><span class="line"><span class="comment"> * or if the barrier &#123;<span class="doctag">@linkplain</span> #isBroken is broken&#125; when</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> await&#125; is invoked, or while any thread is waiting, then</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> BrokenBarrierException&#125; is thrown.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;If any thread is &#123;<span class="doctag">@linkplain</span> Thread#interrupt interrupted&#125; while waiting,</span></span><br><span class="line"><span class="comment"> * then all other waiting threads will throw</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> BrokenBarrierException&#125; and the barrier is placed in the broken</span></span><br><span class="line"><span class="comment"> * state.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;If the current thread is the last thread to arrive, and a</span></span><br><span class="line"><span class="comment"> * non-null barrier action was supplied in the constructor, then the</span></span><br><span class="line"><span class="comment"> * current thread runs the action before allowing the other threads to</span></span><br><span class="line"><span class="comment"> * continue.</span></span><br><span class="line"><span class="comment"> * If an exception occurs during the barrier action then that exception</span></span><br><span class="line"><span class="comment"> * will be propagated in the current thread and the barrier is placed in</span></span><br><span class="line"><span class="comment"> * the broken state.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> the arrival index of the current thread, where index</span></span><br><span class="line"><span class="comment"> *         &#123;<span class="doctag">@code</span> getParties() - 1&#125; indicates the first</span></span><br><span class="line"><span class="comment"> *         to arrive and zero indicates the last to arrive</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> InterruptedException if the current thread was interrupted</span></span><br><span class="line"><span class="comment"> *         while waiting</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> BrokenBarrierException if &lt;em&gt;another&lt;/em&gt; thread was</span></span><br><span class="line"><span class="comment"> *         interrupted or timed out while the current thread was</span></span><br><span class="line"><span class="comment"> *         waiting, or the barrier was reset, or the barrier was</span></span><br><span class="line"><span class="comment"> *         broken when &#123;<span class="doctag">@code</span> await&#125; was called, or the barrier</span></span><br><span class="line"><span class="comment"> *         action (if present) failed due to an exception</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">await</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException, BrokenBarrierException </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dowait(<span class="keyword">false</span>, <span class="number">0L</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (TimeoutException toe) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Error(toe); <span class="comment">//cannot happen</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-2-1-dowait"><a href="#4-2-1-dowait" class="headerlink" title="4.2.1 dowait"></a>4.2.1 dowait</h3><p>dowaitæ–¹æ³•æ˜¯å®ç°CyclicBarrierè¯­ä¹‰çš„ä¸»è¦æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Main barrier code, covering the various policies.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">dowait</span><span class="params">(<span class="keyword">boolean</span> timed, <span class="keyword">long</span> nanos)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> InterruptedException, BrokenBarrierException,</span></span><br><span class="line"><span class="function">           TimeoutException </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> ReentrantLock lock = <span class="keyword">this</span>.lock;</span><br><span class="line">    lock.lock();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> Generation g = generation;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœæ˜¯brokençŠ¶æ€ï¼Œåˆ™æŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ã€‚è¯¥boolå€¼åœ¨breakBarrieræ–¹æ³•ä¸­è¢«è®¾ç½®ä¸ºtrue</span></span><br><span class="line">        <span class="keyword">if</span> (g.broken)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BrokenBarrierException();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœè¢«ä¸­æ–­äº†åˆ™è®¾ç½®brokenä¸ºtrueï¼Œç„¶åæŠ›å‡ºInterruptedExceptionå¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">if</span> (Thread.interrupted()) &#123;</span><br><span class="line">            breakBarrier();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> InterruptedException();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é€’å‡count</span></span><br><span class="line">        <span class="keyword">int</span> index = --count;</span><br><span class="line">        <span class="comment">//å¦‚æœindexä¸º0ï¼Œè¯´æ˜æœ‰è¶³å¤Ÿå¤šçš„çº¿ç¨‹è°ƒç”¨äº†awaitæ–¹æ³•ï¼Œæ­¤æ—¶åº”è¯¥æ”¾è¡Œæ‰€æœ‰çº¿ç¨‹</span></span><br><span class="line">        <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;  <span class="comment">//tripped</span></span><br><span class="line">            <span class="keyword">boolean</span> ranAction = <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">final</span> Runnable command = barrierCommand;</span><br><span class="line">                <span class="comment">//æ‰§è¡Œä¸€äº›é¢å¤–çš„é€»è¾‘</span></span><br><span class="line">                <span class="keyword">if</span> (command != <span class="keyword">null</span>)</span><br><span class="line">                    command.run();</span><br><span class="line">                <span class="comment">//å¦‚æœåœ¨æ‰§è¡Œrunæ–¹æ³•ä¸­æŠ›å‡ºäº†ä»»ä½•å¼‚å¸¸ï¼Œåˆ™ranActionä¸ºfalseçŠ¶æ€</span></span><br><span class="line">                ranAction = <span class="keyword">true</span>;</span><br><span class="line">                <span class="comment">//è¿›å…¥ä¸‹ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸ</span></span><br><span class="line">                nextGeneration();</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!ranAction)</span><br><span class="line">                    <span class="comment">//å°†Barrierçš„å½“å‰ç”Ÿå‘½å‘¨æœŸçš„çŠ¶æ€æ ‡è®°ä¸ºä¸å¯ç”¨</span></span><br><span class="line">                    breakBarrier();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é˜»å¡å½“å‰çº¿ç¨‹ç›´è‡³è¢«ä¸­æ–­ï¼Œæ‰“æ–­æˆ–è€…è¶…æ—¶</span></span><br><span class="line">        <span class="comment">//loop until tripped, broken, interrupted, or timed out</span></span><br><span class="line">        <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//å¦‚æœä¸å…è®¸è¶…æ—¶ï¼Œå°†å½“å‰çº¿ç¨‹ç›´æ¥æŒ‚èµ·ï¼Œé˜»å¡åœ¨æ¡ä»¶å¯¹è±¡tripçš„condition queue(ConditionObjectä¸­ç»´æŠ¤çš„ç­‰å¾…é˜Ÿåˆ—)ä¸­</span></span><br><span class="line">                <span class="keyword">if</span> (!timed)</span><br><span class="line">                    trip.await();</span><br><span class="line">                <span class="comment">//å¦‚æœå…è®¸è¶…æ—¶ï¼Œé˜»å¡åœ¨æ¡ä»¶å¯¹è±¡tripçš„condition queueä¸­ä¸€æ®µæ—¶é—´</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (nanos &gt; <span class="number">0L</span>)</span><br><span class="line">                    nanos = trip.awaitNanos(nanos);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException ie) &#123;</span><br><span class="line">                <span class="comment">//å½“Barrierå¤„äºæœ‰æ•ˆçŠ¶æ€</span></span><br><span class="line">                <span class="keyword">if</span> (g == generation &amp;&amp; ! g.broken) &#123;</span><br><span class="line">                    <span class="comment">//è®¾ç½®ä¸ºæ‰“æ–­çŠ¶æ€</span></span><br><span class="line">                    breakBarrier();</span><br><span class="line">                    <span class="keyword">throw</span> ie;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//We're about to finish waiting even if we had not</span></span><br><span class="line">                    <span class="comment">//been interrupted, so this interrupt is deemed to</span></span><br><span class="line">                    <span class="comment">//"belong" to subsequent execution.</span></span><br><span class="line">                    Thread.currentThread().interrupt();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å¦‚æœBarrierè¢«æ‰“æ–­ï¼Œåˆ™æŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">if</span> (g.broken)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> BrokenBarrierException();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//æ„å‘³ç€è°ƒç”¨awaitæ—¶å¤„äºä¸Šä¸€ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œè€Œæ­¤æ—¶å´è¿›å…¥äº†ä¸‹ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸä¸­</span></span><br><span class="line">            <span class="keyword">if</span> (g != generation)</span><br><span class="line">                <span class="keyword">return</span> index;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å…è®¸è¶…æ—¶ï¼Œå¹¶ä¸”å·²ç»è¶…æ—¶</span></span><br><span class="line">            <span class="keyword">if</span> (timed &amp;&amp; nanos &lt;= <span class="number">0L</span>) &#123;</span><br><span class="line">                breakBarrier();</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> TimeoutException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        lock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-2-2-nextGeneration"><a href="#4-2-2-nextGeneration" class="headerlink" title="4.2.2 nextGeneration"></a>4.2.2 nextGeneration</h3><p>è¯¥æ–¹æ³•ä½¿å¾—CyclicBarrierè¿›å…¥ä¸‹ä¸€æ¬¡ç”Ÿå‘½å‘¨æœŸï¼Œå”¤é†’é˜»å¡åœ¨tripä¸Šçš„çº¿ç¨‹ï¼Œå¹¶ä¸”é‡ç½®æ‰€æœ‰çŠ¶æ€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Updates state on barrier trip and wakes up everyone.</span></span><br><span class="line"><span class="comment"> * Called only while holding lock.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">nextGeneration</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//signal completion of last generation</span></span><br><span class="line">    <span class="comment">//å”¤é†’æ‰€æœ‰é˜»å¡åœ¨condition queueä¸­çš„çº¿ç¨‹ï¼Œå³é‚£äº›é˜»å¡åœ¨awaitæ–¹æ³•ä¸Šçš„çº¿ç¨‹</span></span><br><span class="line">    trip.signalAll();</span><br><span class="line">    <span class="comment">//set up next generation</span></span><br><span class="line">    <span class="comment">//è¿™å°±æ˜¯CyclicBarrierå¯é‡ç”¨çš„åŸå› </span></span><br><span class="line">    count = parties;</span><br><span class="line">    <span class="comment">//é‡æ–°ç”ŸæˆGeneration</span></span><br><span class="line">    generation = <span class="keyword">new</span> Generation();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-3-isBroken"><a href="#4-3-isBroken" class="headerlink" title="4.3 isBroken"></a>4.3 isBroken</h2><p>æ£€æŸ¥å½“å‰Barrierç”Ÿå‘½å‘¨æœŸæ˜¯å¦æœ‰æ•ˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Queries if this barrier is in a broken state.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if one or more parties broke out of this</span></span><br><span class="line"><span class="comment"> *         barrier due to interruption or timeout since</span></span><br><span class="line"><span class="comment"> *         construction or the last reset, or a barrier action</span></span><br><span class="line"><span class="comment"> *         failed due to an exception; &#123;<span class="doctag">@code</span> false&#125; otherwise.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isBroken</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> ReentrantLock lock = <span class="keyword">this</span>.lock;</span><br><span class="line">    lock.lock();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> generation.broken;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        lock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-4-reset"><a href="#4-4-reset" class="headerlink" title="4.4 reset"></a>4.4 reset</h2><p>é‡ç½®Barrierï¼Œä½¿å…¶è¿›å…¥ä¸‹ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸã€‚å¯¹äºé‚£äº›é˜»å¡åœ¨ä¸Šä¸€ä¸ªç”Ÿå‘½å‘¨æœŸä¸­çš„çº¿ç¨‹ï¼Œä¼šé€šè¿‡nextGenerationæ–¹æ³•è¿›è¡Œå”¤é†’</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Resets the barrier to its initial state.  If any parties are</span></span><br><span class="line"><span class="comment"> * currently waiting at the barrier, they will return with a</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> BrokenBarrierException&#125;. Note that resets &lt;em&gt;after&lt;/em&gt;</span></span><br><span class="line"><span class="comment"> * a breakage has occurred for other reasons can be complicated to</span></span><br><span class="line"><span class="comment"> * carry out; threads need to re-synchronize in some other way,</span></span><br><span class="line"><span class="comment"> * and choose one to perform the reset.  It may be preferable to</span></span><br><span class="line"><span class="comment"> * instead create a new barrier for subsequent use.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> ReentrantLock lock = <span class="keyword">this</span>.lock;</span><br><span class="line">    lock.lock();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        breakBarrier();   <span class="comment">//break the current generation</span></span><br><span class="line">        nextGeneration(); <span class="comment">//start a new generation</span></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        lock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-5-getNumberWaiting"><a href="#4-5-getNumberWaiting" class="headerlink" title="4.5 getNumberWaiting"></a>4.5 getNumberWaiting</h2><p>æ£€æŸ¥æœ‰å¤šå°‘ä¸ªçº¿ç¨‹é˜»å¡åœ¨awaitæ–¹æ³•çš„è°ƒç”¨ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns the number of parties currently waiting at the barrier.</span></span><br><span class="line"><span class="comment"> * This method is primarily useful for debugging and assertions.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> the number of parties currently blocked in &#123;<span class="doctag">@link</span> #await&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNumberWaiting</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> ReentrantLock lock = <span class="keyword">this</span>.lock;</span><br><span class="line">    lock.lock();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> parties - count;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        lock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;1-å‰è¨€&quot;&gt;&lt;a href=&quot;#1-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;1 å‰è¨€&quot;&gt;&lt;/a&gt;1 å‰è¨€&lt;/h1&gt;&lt;p&gt;CyclicBarrieræ˜¯ä¸€ä¸ªåŒæ­¥è¾…åŠ©ç±»ï¼Œå®ƒå…è®¸ä¸€ç»„çº¿ç¨‹äº’ç›¸ç­‰å¾…ï¼Œç›´åˆ°åˆ°è¾¾æŸä¸ªå…¬å…±å±éšœç‚¹(common barrier  point)ã€‚åœ¨æ¶‰åŠä¸€ç»„å›ºå®šå¤§å°çš„çº¿ç¨‹çš„ç¨‹åºä¸­ï¼Œè¿™äº›çº¿ç¨‹å¿…é¡»ä¸æ—¶åœ°äº’ç›¸ç­‰å¾…ï¼Œæ­¤æ—¶CyclicBarrierå¾ˆæœ‰ç”¨ã€‚å› ä¸ºè¯¥barrieråœ¨é‡Šæ”¾ç­‰å¾…çº¿ç¨‹åå¯ä»¥é‡ç”¨ï¼Œæ‰€ä»¥ç§°å®ƒä¸ºå¾ªç¯çš„barrier&lt;/p&gt;
    
    </summary>
    
    
      <category term="java" scheme="http://yifanzhang13.github.io/categories/java/"/>
    
    
      <category term="concurrency" scheme="http://yifanzhang13.github.io/tags/concurrency/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeåšé¢˜è®°å½•</title>
    <link href="http://yifanzhang13.github.io/2020/04/23/LeetCode%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    <id>http://yifanzhang13.github.io/2020/04/23/LeetCode%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</id>
    <published>2020-04-23T02:13:38.000Z</published>
    <updated>2020-04-24T05:46:04.835Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><h1 id="205-åŒæ„å­—ç¬¦ä¸²"><a href="#205-åŒæ„å­—ç¬¦ä¸²" class="headerlink" title="205.åŒæ„å­—ç¬¦ä¸²"></a><a href="https://leetcode-cn.com/problems/isomorphic-strings/">205.åŒæ„å­—ç¬¦ä¸²</a></h1><p><u><strong>æ€è·¯åˆ†æ</strong></u></p><ul><li><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸€ä¸ª HashMap æ¥å¤„ç†æ˜ å°„ã€‚å¯¹äº s åˆ° t çš„æ˜ å°„ï¼Œæˆ‘ä»¬åŒæ—¶éå† s å’Œ t ï¼Œå‡è®¾å½“å‰é‡åˆ°çš„å­—æ¯åˆ†åˆ«æ˜¯ c1 å’Œ c2 ã€‚</p></li><li><p>å¦‚æœ map[c1] ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°±å°† c1 æ˜ å°„åˆ° c2 ï¼Œå³ map[c1] = c2ã€‚</p></li><li><p>å¦‚æœ map[c1] å­˜åœ¨ï¼Œé‚£ä¹ˆå°±åˆ¤æ–­ map[c1] æ˜¯å¦ç­‰äº c2ï¼Œä¹Ÿå°±æ˜¯éªŒè¯ä¹‹å‰çš„æ˜ å°„å’Œå½“å‰çš„å­—æ¯æ˜¯å¦ç›¸åŒã€‚</p></li><li><p>å¯¹äºè¿™é“é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦éªŒè¯ s - &gt; t å’Œ t -&gt; s ä¸¤ä¸ªæ–¹å‘å³å¯ã€‚å¦‚æœéªŒè¯ä¸€ä¸ªæ–¹å‘ï¼Œæ˜¯ä¸å¯ä»¥çš„ã€‚</p></li><li><p>ä¸¾ä¸ªä¾‹å­ï¼Œs = ab, t = ccï¼Œå¦‚æœå•çœ‹ s -&gt; t ï¼Œé‚£ä¹ˆ a -&gt; c, b -&gt; c æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p></li><li><p>å¿…é¡»å†éªŒè¯ t -&gt; sï¼Œæ­¤æ—¶ï¼Œc -&gt; a, c -&gt; bï¼Œä¸€ä¸ªå­—æ¯å¯¹åº”äº†å¤šä¸ªå­—æ¯ï¼Œæ‰€ä»¥ä¸æ˜¯åŒæ„çš„ã€‚ä»£ç çš„è¯ï¼Œåªéœ€è¦è°ƒç”¨ä¸¤æ¬¡ä¸Šè¾¹çš„ä»£ç å³å¯ã€‚</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">egg å’Œ add åŒæ„ï¼Œå°±æ„å‘³ç€ä¸‹è¾¹çš„æ˜ å°„æˆç«‹</span><br><span class="line">e -&gt; a</span><br><span class="line">g -&gt; d</span><br><span class="line">ä¹Ÿå°±æ˜¯å°† egg çš„ e æ¢æˆ a, g æ¢æˆ d, å°±å˜æˆäº† add</span><br><span class="line"></span><br><span class="line">åŒæ—¶å€’è¿‡æ¥ä¹Ÿæˆç«‹</span><br><span class="line">a -&gt; e</span><br><span class="line">d -&gt; g</span><br><span class="line">ä¹Ÿå°±æ˜¯å°† add çš„ a æ¢æˆ e, d æ¢æˆ g, å°±å˜æˆäº† egg</span><br><span class="line"></span><br><span class="line">foo å’Œ bar ä¸åŒæ„ï¼ŒåŸå› å°±æ˜¯æ˜ å°„ä¸å”¯ä¸€</span><br><span class="line">o -&gt; a</span><br><span class="line">o -&gt; r</span><br><span class="line">å…¶ä¸­ o æ˜ å°„åˆ°äº†ä¸¤ä¸ªå­—æ¯</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isIsomorphic1</span><span class="params">(String s,String t)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> isIsomorphicHelper(s,t) &amp;&amp; isIsomorphicHelper(t,s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isIsomorphicHelper</span><span class="params">(String s, String t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = s.length();</span><br><span class="line">        HashMap&lt;Character,Character&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">            <span class="keyword">char</span> c1 = s.charAt(i);</span><br><span class="line">            <span class="keyword">char</span> c2 = t.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (!map.containsKey(c1))&#123;</span><br><span class="line">                map.put(c1,c2);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (map.get(c1)!=c2)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;

&lt;h1 id=&quot;205-åŒæ„å­—ç¬¦ä¸²&quot;&gt;&lt;a href=&quot;#205-åŒæ„å­—ç¬¦ä¸²&quot; class=&quot;headerlink&quot; title=&quot;205.åŒæ„å­—ç¬¦ä¸²&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://leetcode-cn.com/problem
      
    
    </summary>
    
    
      <category term="Notes" scheme="http://yifanzhang13.github.io/categories/Notes/"/>
    
    
      <category term="LeetCode" scheme="http://yifanzhang13.github.io/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>Hexo-PDF</title>
    <link href="http://yifanzhang13.github.io/2020/04/13/Hexo-PDF-Test/"/>
    <id>http://yifanzhang13.github.io/2020/04/13/Hexo-PDF-Test/</id>
    <published>2020-04-13T01:44:04.000Z</published>
    <updated>2020-04-13T03:16:52.193Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Uploading PDF files without installing <code>hexo-pdf</code> extension.</strong></p><a id="more"></a><p>ç”±äºæƒ³ä¸Šä¼ ä¸€äº›PDFæ–‡ä»¶åˆ°åšå®¢ä¸Šï¼ŒæŸ¥äº†ä¸‹å‘ç°æœ‰ä¸€ä¸ª<code>hexo-pdf</code>çš„æ’ä»¶å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç”¨æ¥æ½œå…¥PDFæ–‡ä»¶ã€‚ä½†æ˜¯ä¸çŸ¥é“æ˜¯æ’ä»¶å¹´ä¹…å¤±ä¿®è¿˜æ˜¯ä¸æ”¯æŒæœ€æ–°Hexoç‰ˆæœ¬ï¼Œå¹¶ä¸èƒ½è¾¾åˆ°é¢„æœŸæ•ˆæœã€‚æ‰€ä»¥æœ‰äº†ä¸‹é¢<del>ç®€å•ç²—æš´</del>çš„æ–¹æ³•ã€‚</p><h2 id="ä¿®æ”¹æ ¹ç›®å½•ä¸‹çš„-config-ymlæ–‡ä»¶"><a href="#ä¿®æ”¹æ ¹ç›®å½•ä¸‹çš„-config-ymlæ–‡ä»¶" class="headerlink" title="ä¿®æ”¹æ ¹ç›®å½•ä¸‹çš„_config.ymlæ–‡ä»¶"></a>ä¿®æ”¹æ ¹ç›®å½•ä¸‹çš„_config.ymlæ–‡ä»¶</h2><h3 id="å°†-config-ymlä¸­çš„post-asset-folderé€‰é¡¹ç½®ä¸ºtrue"><a href="#å°†-config-ymlä¸­çš„post-asset-folderé€‰é¡¹ç½®ä¸ºtrue" class="headerlink" title="å°†_config.ymlä¸­çš„post_asset_folderé€‰é¡¹ç½®ä¸ºtrue"></a>å°†_config.ymlä¸­çš„post_asset_folderé€‰é¡¹ç½®ä¸ºtrue</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>å…³äºè¿™ä¸ªé€‰é¡¹çš„åŠŸèƒ½è¯´æ˜å¦‚ä¸‹:</p><blockquote><p>å½“æ‚¨è®¾ç½®post_asset_folderä¸ºtrueå‚æ•°åï¼Œåœ¨å»ºç«‹æ–‡ä»¶æ—¶ï¼ŒHexo<br> ä¼šè‡ªåŠ¨å»ºç«‹ä¸€ä¸ªä¸æ–‡ç« åŒåçš„æ–‡ä»¶å¤¹ï¼Œæ‚¨å¯ä»¥æŠŠä¸è¯¥æ–‡ç« ç›¸å…³çš„æ‰€æœ‰èµ„æºéƒ½æ”¾åˆ°é‚£ä¸ªæ–‡ä»¶å¤¹ï¼Œå¦‚æ­¤ä¸€æ¥ï¼Œæ‚¨ä¾¿å¯ä»¥æ›´æ–¹ä¾¿çš„ä½¿ç”¨èµ„æºã€‚</p></blockquote><h3 id="ç„¶åæ–°å»ºä¸€ç¯‡æ–‡ç« "><a href="#ç„¶åæ–°å»ºä¸€ç¯‡æ–‡ç« " class="headerlink" title="ç„¶åæ–°å»ºä¸€ç¯‡æ–‡ç« "></a>ç„¶åæ–°å»ºä¸€ç¯‡æ–‡ç« </h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new &lt;article_name&gt;</span><br></pre></td></tr></table></figure><blockquote><p>ç”±äºä¸Šä¸€æ­¥å·²ç»å°†post_asset_folderé€‰é¡¹è®¾ä¸ºäº†true<br>æ‰€ä»¥è¿™ä¸€æ­¥æ–°å»ºæ–‡ç« æ—¶ä¼šåˆ›å»ºä¸€ä¸ªmdæ–‡ä»¶å’Œä¸€ä¸ªåŒåçš„æ–‡ä»¶å¤¹<br>ä¸ºäº†æ–¹ä¾¿å™è¿°ï¼Œæˆ‘ç”¨testä½œä¸ºæ–‡ä»¶å’Œæ–‡ä»¶å¤¹å</p></blockquote><h3 id="ç¼–è¾‘Markdownæ–‡ä»¶"><a href="#ç¼–è¾‘Markdownæ–‡ä»¶" class="headerlink" title="ç¼–è¾‘Markdownæ–‡ä»¶"></a>ç¼–è¾‘Markdownæ–‡ä»¶</h3><blockquote><p>ç”¨Typoraæˆ–è€…å…¶ä»–ç¼–è¾‘å™¨æ‰“å¼€test.md<br>test.mdæ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹ä»£ç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">object</span> <span class="attr">data</span>=<span class="string">"./Hello.pdf"</span> <span class="attr">type</span>=<span class="string">"application/pdf"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"877px"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…³äºè¿™å¥ä»£ç ç®€å•çš„è§£é‡Š<br>dataè¡¨ç¤ºä½ è¦ä¸Šä¼ çš„pdfçš„è·¯å¾„,ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œå°†ä½ è¦ä¸Šä¼ çš„pdfæ”¾å…¥ç¬¬äºŒæ­¥ç”Ÿæˆçš„testæ–‡ä»¶å¤¹</p></blockquote><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><br><object data="./Hello.pdf" type="application/pdf" width="100%" height="877px"></object><br><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.csdn.net/qappleh/article/details/80250492">å‰ç«¯é¢„è§ˆPDFæ€»ç»“</a></p><p><a href="http://miracle778.site/pdf-test/pdf-test.html">hexoä¸­æ’å…¥pdfè§£å†³æ–¹æ³•</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Uploading PDF files without installing &lt;code&gt;hexo-pdf&lt;/code&gt; extension.&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Hexo" scheme="http://yifanzhang13.github.io/categories/Hexo/"/>
    
    
      <category term="configuration" scheme="http://yifanzhang13.github.io/tags/configuration/"/>
    
  </entry>
  
  <entry>
    <title>Java Concurrency</title>
    <link href="http://yifanzhang13.github.io/2020/04/09/Java-Concurrency/"/>
    <id>http://yifanzhang13.github.io/2020/04/09/Java-Concurrency/</id>
    <published>2020-04-09T07:19:27.000Z</published>
    <updated>2020-04-11T08:59:15.005Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Java-Concurrency"><a href="#Java-Concurrency" class="headerlink" title="Java Concurrency"></a>Java Concurrency</h1><p>This article is from <a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Java%20%E5%B9%B6%E5%8F%91.md#countdownlatch">here</a> and I made some notes on it to review java concurrency.</p><p>If itâ€™s inappropriate to do so, contact me to delete this post.</p><h1 id="ä¸€ã€ä½¿ç”¨çº¿ç¨‹"><a href="#ä¸€ã€ä½¿ç”¨çº¿ç¨‹" class="headerlink" title="ä¸€ã€ä½¿ç”¨çº¿ç¨‹"></a>ä¸€ã€ä½¿ç”¨çº¿ç¨‹</h1><p>æœ‰<u><strong>ä¸‰ç§</strong></u>ä½¿ç”¨çº¿ç¨‹çš„æ–¹æ³•ï¼š</p><ul><li>å®ç° Runnable æ¥å£ï¼›</li><li>å®ç° Callable æ¥å£ï¼›</li><li>ç»§æ‰¿ Thread ç±»ã€‚</li></ul><a id="more"></a><p><u>å®ç° Runnable å’Œ Callable æ¥å£çš„ç±»åªèƒ½å½“åšä¸€ä¸ªå¯ä»¥åœ¨çº¿ç¨‹ä¸­è¿è¡Œçš„ä»»åŠ¡ï¼Œä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„çº¿ç¨‹ï¼Œå› æ­¤æœ€åè¿˜éœ€è¦é€šè¿‡ Thread æ¥è°ƒç”¨ã€‚</u>å¯ä»¥ç†è§£ä¸ºä»»åŠ¡æ˜¯é€šè¿‡çº¿ç¨‹é©±åŠ¨ä»è€Œæ‰§è¡Œçš„ã€‚</p><h2 id="å®ç°-Runnable-æ¥å£"><a href="#å®ç°-Runnable-æ¥å£" class="headerlink" title="å®ç° Runnable æ¥å£"></a>å®ç° Runnable æ¥å£</h2><p>éœ€è¦å®ç°æ¥å£ä¸­çš„ run() æ–¹æ³•ã€‚<strong>ä»»åŠ¡å†™åœ¨run()æ–¹æ³•ä¸­ï¼Œç„¶åç”¨Thread è°ƒç”¨</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><u><strong>ä½¿ç”¨ Runnable å®ä¾‹å†åˆ›å»ºä¸€ä¸ª Thread å®ä¾‹ï¼Œç„¶åè°ƒç”¨ Thread å®ä¾‹çš„ start() æ–¹æ³•æ¥å¯åŠ¨çº¿ç¨‹ã€‚</strong></u></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    MyRunnable instance = <span class="keyword">new</span> MyRunnable();</span><br><span class="line">    Thread thread = <span class="keyword">new</span> Thread(instance);</span><br><span class="line">    thread.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®ç°-Callable-æ¥å£"><a href="#å®ç°-Callable-æ¥å£" class="headerlink" title="å®ç° Callable æ¥å£"></a>å®ç° Callable æ¥å£</h2><p><u><strong>ä¸ Runnable ç›¸æ¯”ï¼ŒCallable å¯ä»¥æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼é€šè¿‡ FutureTask è¿›è¡Œå°è£…ã€‚</strong></u></p><p><strong>å®ç°Runnableéœ€è¦å®ç°æ¥å£ä¸­çš„voidè¿”å›å€¼çš„run( )æ–¹æ³•ï¼ŒCallableåˆ™å®ç°<E>å½“åˆå®šä¹‰è¿”å›å€¼çš„call( )æ–¹æ³•</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCallable</span> <span class="keyword">implements</span> <span class="title">Callable</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">123</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException </span>&#123;</span><br><span class="line">    MyCallable mc = <span class="keyword">new</span> MyCallable();</span><br><span class="line">    FutureTask&lt;Integer&gt; ft = <span class="keyword">new</span> FutureTask&lt;&gt;(mc);</span><br><span class="line">    Thread thread = <span class="keyword">new</span> Thread(ft);</span><br><span class="line">    thread.start();</span><br><span class="line">    System.out.println(ft.get());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç»§æ‰¿-Thread-ç±»"><a href="#ç»§æ‰¿-Thread-ç±»" class="headerlink" title="ç»§æ‰¿ Thread ç±»"></a>ç»§æ‰¿ Thread ç±»</h2><p><strong><u>åŒæ ·ä¹Ÿæ˜¯éœ€è¦å®ç° run() æ–¹æ³•ï¼Œå› ä¸º Thread ç±»ä¹Ÿå®ç°äº† Runable æ¥å£ã€‚</u></strong></p><p><strong>å½“è°ƒç”¨ start() æ–¹æ³•å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œè™šæ‹Ÿæœºä¼šå°†è¯¥çº¿ç¨‹æ”¾å…¥å°±ç»ªé˜Ÿåˆ—ä¸­ç­‰å¾…è¢«è°ƒåº¦ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è¢«è°ƒåº¦æ—¶ä¼šæ‰§è¡Œè¯¥çº¿ç¨‹çš„ run() æ–¹æ³•</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    MyThread mt = <span class="keyword">new</span> MyThread();</span><br><span class="line">    mt.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®ç°æ¥å£-VS-ç»§æ‰¿-Thread"><a href="#å®ç°æ¥å£-VS-ç»§æ‰¿-Thread" class="headerlink" title="å®ç°æ¥å£ VS ç»§æ‰¿ Thread"></a>å®ç°æ¥å£ VS ç»§æ‰¿ Thread</h2><p>å®ç°æ¥å£ä¼šæ›´å¥½ä¸€äº›ï¼Œå› ä¸ºï¼š</p><ul><li><strong>Java ä¸æ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œå› æ­¤ç»§æ‰¿äº† Thread ç±»å°±æ— æ³•ç»§æ‰¿å…¶å®ƒç±»ï¼Œä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£</strong>ï¼›</li><li>ç±»å¯èƒ½åªè¦æ±‚å¯æ‰§è¡Œå°±è¡Œï¼Œ<strong>ç»§æ‰¿æ•´ä¸ª Thread ç±»å¼€é”€è¿‡å¤§</strong>ã€‚</li></ul><h1 id="äºŒã€åŸºç¡€çº¿ç¨‹æœºåˆ¶"><a href="#äºŒã€åŸºç¡€çº¿ç¨‹æœºåˆ¶" class="headerlink" title="äºŒã€åŸºç¡€çº¿ç¨‹æœºåˆ¶"></a>äºŒã€åŸºç¡€çº¿ç¨‹æœºåˆ¶</h1><h2 id="Executor"><a href="#Executor" class="headerlink" title="Executor"></a>Executor</h2><p>Executor ç®¡ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œï¼Œè€Œæ— éœ€ç¨‹åºå‘˜æ˜¾å¼åœ°ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™é‡Œçš„å¼‚æ­¥æ˜¯æŒ‡å¤šä¸ªä»»åŠ¡çš„æ‰§è¡Œäº’ä¸å¹²æ‰°ï¼Œä¸éœ€è¦è¿›è¡ŒåŒæ­¥æ“ä½œã€‚</p><p>ä¸»è¦æœ‰ä¸‰ç§ Executorï¼š</p><ul><li>CachedThreadPoolï¼šä¸€ä¸ªä»»åŠ¡åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼›</li><li>FixedThreadPoolï¼šæ‰€æœ‰ä»»åŠ¡åªèƒ½ä½¿ç”¨å›ºå®šå¤§å°çš„çº¿ç¨‹ï¼›</li><li>SingleThreadExecutorï¼šç›¸å½“äºå¤§å°ä¸º 1 çš„ FixedThreadPoolã€‚</li></ul><p>å…ˆå®ç°Runnableåˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå®šä¹‰run( )æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyThread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">"æ­£åœ¨æ‰§è¡Œã€‚ã€‚ã€‚"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºCachedThreadPoolï¼Œå¹¶åœ¨forå¾ªç¯ä¸­æ‰§è¡ŒMyRunnableä¸­çš„run( )æ–¹æ³•5æ¬¡ï¼Œæœ€åå…³é—­CachedThreadPool</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        executorService.execute(<span class="keyword">new</span> MyRunnable());</span><br><span class="line">    &#125;</span><br><span class="line">    executorService.shutdown();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Daemon"><a href="#Daemon" class="headerlink" title="Daemon"></a>Daemon</h2><p><strong><u>å®ˆæŠ¤çº¿ç¨‹æ˜¯ç¨‹åºè¿è¡Œæ—¶åœ¨åå°æä¾›æœåŠ¡çš„çº¿ç¨‹</u></strong>ï¼Œä¸å±äºç¨‹åºä¸­ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ã€‚</p><p><strong><u>å½“æ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹ç»“æŸæ—¶ï¼Œç¨‹åºä¹Ÿå°±ç»ˆæ­¢ï¼ŒåŒæ—¶ä¼šæ€æ­»æ‰€æœ‰å®ˆæŠ¤çº¿ç¨‹</u></strong>ã€‚</p><p><strong><em>main() å±äºéå®ˆæŠ¤çº¿ç¨‹</em></strong>ã€‚</p><p><strong><u>åœ¨çº¿ç¨‹å¯åŠ¨ä¹‹å‰ä½¿ç”¨ setDaemon() æ–¹æ³•å¯ä»¥å°†ä¸€ä¸ªçº¿ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</u></strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Thread thread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> MyRunnable());</span><br><span class="line">    thread.setDaemon(<span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="sleep"><a href="#sleep" class="headerlink" title="sleep()"></a>sleep()</h2><p>Thread.sleep(millisec) æ–¹æ³•ä¼š<u><strong>ä¼‘çœ å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹</strong></u>ï¼Œmillisec å•ä½ä¸ºæ¯«ç§’ã€‚</p><p>sleep() å¯èƒ½ä¼šæŠ›å‡º <strong>InterruptedException</strong>ï¼Œ<strong><u>å› ä¸ºå¼‚å¸¸ä¸èƒ½è·¨çº¿ç¨‹ä¼ æ’­å› main() ä¸­ï¼Œå› æ­¤å¿…é¡»åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†ã€‚çº¿ç¨‹ä¸­æŠ›å‡ºçš„å…¶å®ƒå¼‚å¸¸ä¹ŸåŒæ ·éœ€è¦åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†</u></strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="yield"><a href="#yield" class="headerlink" title="yield()"></a>yield()</h2><p>å¯¹é™æ€æ–¹æ³• Thread.yield() çš„è°ƒç”¨å£°æ˜äº†<strong><em>å½“å‰çº¿ç¨‹å·²ç»å®Œæˆäº†ç”Ÿå‘½å‘¨æœŸä¸­æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œå¯ä»¥åˆ‡æ¢ç»™å…¶å®ƒçº¿ç¨‹æ¥æ‰§è¡Œ</em></strong>ã€‚<strong><u>è¯¥æ–¹æ³•åªæ˜¯å¯¹çº¿ç¨‹è°ƒåº¦å™¨çš„ä¸€ä¸ªå»ºè®®ï¼Œè€Œä¸”ä¹Ÿåªæ˜¯å»ºè®®å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„å…¶å®ƒçº¿ç¨‹å¯ä»¥è¿è¡Œ</u></strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Thread.yield();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€ä¸­æ–­"><a href="#ä¸‰ã€ä¸­æ–­" class="headerlink" title="ä¸‰ã€ä¸­æ–­"></a>ä¸‰ã€ä¸­æ–­</h1><p><strong><u>ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åä¼šè‡ªåŠ¨ç»“æŸï¼Œå¦‚æœåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸ä¹Ÿä¼šæå‰ç»“æŸã€‚</u></strong></p><h2 id="InterruptedException"><a href="#InterruptedException" class="headerlink" title="InterruptedException"></a>InterruptedException</h2><p>é€šè¿‡è°ƒç”¨ä¸€ä¸ªçº¿ç¨‹çš„ <strong>interrupt()</strong> æ¥ä¸­æ–­è¯¥çº¿ç¨‹ï¼Œ<strong><u>å¦‚æœè¯¥çº¿ç¨‹å¤„äºé˜»å¡(BLOCKED)ã€é™æœŸç­‰å¾…(TIMED_WAITING)æˆ–è€…æ— é™æœŸç­‰å¾…(WAITINNG)çŠ¶æ€ï¼Œé‚£ä¹ˆå°±ä¼šæŠ›å‡º InterruptedExceptionï¼Œä»è€Œæå‰ç»“æŸè¯¥çº¿ç¨‹</u></strong>ã€‚<strong>ä½†æ˜¯ä¸èƒ½ä¸­æ–­ I/O é˜»å¡å’Œ synchronized é”é˜»å¡ã€‚</strong></p><p>å¯¹äºä»¥ä¸‹ä»£ç ï¼Œåœ¨ main() ä¸­å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä¹‹åå†ä¸­æ–­å®ƒï¼Œç”±äºçº¿ç¨‹ä¸­è°ƒç”¨äº† Thread.sleep() æ–¹æ³•ï¼ŒThreadä¼šè¿›å…¥TIMED_WAITINGçŠ¶æ€ï¼Œå› æ­¤ä¼šæŠ›å‡ºä¸€ä¸ª InterruptedExceptionï¼Œä»è€Œæå‰ç»“æŸçº¿ç¨‹ï¼Œä¸æ‰§è¡Œä¹‹åçš„è¯­å¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InterruptExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread1</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2000</span>);<span class="comment">//çº¿ç¨‹è¿›å…¥TIMED_WAITINGçŠ¶æ€</span></span><br><span class="line">                System.out.println(<span class="string">"Thread run"</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    Thread thread1 = <span class="keyword">new</span> MyThread1();</span><br><span class="line">    thread1.start();</span><br><span class="line">    thread1.interrupt();<span class="comment">//å› ä¸ºçº¿ç¨‹æ˜¯TIMED_WAITINGçŠ¶æ€ï¼Œè°ƒç”¨Interrup()ä¼šæŠ›å‡ºå¼‚å¸¸ä»è€Œç»“æŸè¯¥çº¿ç¨‹</span></span><br><span class="line">    System.out.println(<span class="string">"Main run"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Main run</span><br><span class="line">java.lang.InterruptedException: sleep interrupted</span><br><span class="line">    at java.lang.Thread.sleep(Native Method)</span><br><span class="line">    at InterruptExample.lambda$main$<span class="number">0</span>(InterruptExample.java:<span class="number">5</span>)</span><br><span class="line">    at InterruptExample$$Lambda$<span class="number">1</span>/<span class="number">713338599</span>.run(Unknown Source)</span><br><span class="line">    at java.lang.Thread.run(Thread.java:<span class="number">745</span>)</span><br></pre></td></tr></table></figure><h2 id="interrupted"><a href="#interrupted" class="headerlink" title="interrupted()"></a>interrupted()</h2><p>å¦‚æœä¸€ä¸ªçº¿ç¨‹çš„ run() æ–¹æ³•æ‰§è¡Œä¸€ä¸ª<strong>æ— é™å¾ªç¯</strong>ï¼Œ<strong><u>å¹¶ä¸”æ²¡æœ‰æ‰§è¡Œ sleep() ç­‰ä¼šæŠ›å‡º InterruptedException çš„æ“ä½œ</u></strong>ï¼Œ<strong><u>é‚£ä¹ˆè°ƒç”¨çº¿ç¨‹çš„ interrupt() æ–¹æ³•å°±æ— æ³•ä½¿çº¿ç¨‹æå‰ç»“æŸ</u></strong>ã€‚</p><p>ä½†æ˜¯è°ƒç”¨ interrupt() æ–¹æ³•ä¼š<strong><u>è®¾ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°</u></strong>ï¼Œæ­¤æ—¶è°ƒç”¨ interrupted() æ–¹æ³•ä¼šè¿”å› <strong>true</strong>ã€‚å› æ­¤å¯ä»¥åœ¨å¾ªç¯ä½“ä¸­ä½¿ç”¨ interrupted() æ–¹æ³•æ¥åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¤„äºä¸­æ–­çŠ¶æ€ï¼Œä»è€Œæå‰ç»“æŸçº¿ç¨‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InterruptExample</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread2</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="comment">// æ²¡æœ‰è°ƒç”¨interruptæ–¹æ³•ä¹‹å‰ï¼Œinterruptedæ–¹æ³•è¿”å›çš„éƒ½æ˜¯falseï¼Œæ‰€ä»¥ä¼šä¸€ç›´å¾ªç¯</span></span><br><span class="line">            <span class="keyword">while</span> (!interrupted()) &#123;</span><br><span class="line">                <span class="comment">// ..</span></span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">"Thread end"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    Thread thread2 = <span class="keyword">new</span> MyThread2();</span><br><span class="line">    thread2.start();</span><br><span class="line">    thread2.interrupt(); <span class="comment">//è°ƒç”¨ä¹‹åï¼Œinterruptedæ–¹æ³•è¿”å›trueä»è€Œç»“æŸå¾ªç¯ï¼Œç»“æŸçº¿ç¨‹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Thread end</span><br></pre></td></tr></table></figure><h2 id="Executor-çš„ä¸­æ–­æ“ä½œ"><a href="#Executor-çš„ä¸­æ–­æ“ä½œ" class="headerlink" title="Executor çš„ä¸­æ–­æ“ä½œ"></a>Executor çš„ä¸­æ–­æ“ä½œ</h2><p><strong><u>è°ƒç”¨ Executor çš„ shutdown() æ–¹æ³•ä¼šç­‰å¾…çº¿ç¨‹éƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åå†å…³é—­ï¼Œä½†æ˜¯å¦‚æœè°ƒç”¨çš„æ˜¯ shutdownNow() æ–¹æ³•ï¼Œåˆ™ç›¸å½“äºè°ƒç”¨æ¯ä¸ªçº¿ç¨‹çš„ interrupt() æ–¹æ³•ã€‚</u></strong></p><p>ä»¥ä¸‹ä½¿ç”¨ Lambda åˆ›å»ºçº¿ç¨‹ï¼Œç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå†…éƒ¨çº¿ç¨‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">    executorService.execute(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">            System.out.println(<span class="string">"Thread run"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    executorService.shutdownNow();</span><br><span class="line">    System.out.println(<span class="string">"Main run"</span>);</span><br><span class="line">&#125;</span><br><span class="line">Main run</span><br><span class="line">java.lang.InterruptedException: sleep interrupted</span><br><span class="line">    at java.lang.Thread.sleep(Native Method)</span><br><span class="line">    at ExecutorInterruptExample.lambda$main$<span class="number">0</span>(ExecutorInterruptExample.java:<span class="number">9</span>)</span><br><span class="line">    at ExecutorInterruptExample$$Lambda$<span class="number">1</span>/<span class="number">1160460865</span>.run(Unknown Source)</span><br><span class="line">    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:<span class="number">1142</span>)</span><br><span class="line">    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:<span class="number">617</span>)</span><br><span class="line">    at java.lang.Thread.run(Thread.java:<span class="number">745</span>)</span><br></pre></td></tr></table></figure><p>å¦‚æœåªæƒ³ä¸­æ–­ Executor ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ submit() æ–¹æ³•æ¥æäº¤ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª Future&lt;?&gt; å¯¹è±¡ï¼Œé€šè¿‡è°ƒç”¨è¯¥å¯¹è±¡çš„ cancel(true) æ–¹æ³•å°±å¯ä»¥ä¸­æ–­çº¿ç¨‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Future&lt;?&gt; future = executorService.submit(() -&gt; &#123;</span><br><span class="line">    <span class="comment">// ..</span></span><br><span class="line">&#125;);</span><br><span class="line">future.cancel(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure><h1 id="å››ã€äº’æ–¥åŒæ­¥"><a href="#å››ã€äº’æ–¥åŒæ­¥" class="headerlink" title="å››ã€äº’æ–¥åŒæ­¥"></a>å››ã€äº’æ–¥åŒæ­¥</h1><p>Java æä¾›äº†<strong>ä¸¤ç§é”æœºåˆ¶</strong>æ¥<strong>æ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„äº’æ–¥è®¿é—®</strong>ï¼Œç¬¬ä¸€ä¸ªæ˜¯ JVM å®ç°çš„ <strong>synchronized</strong>ï¼Œè€Œå¦ä¸€ä¸ªæ˜¯ JDK å®ç°çš„ <strong>ReentrantLock</strong>ã€‚</p><h2 id="synchronized"><a href="#synchronized" class="headerlink" title="synchronized"></a>synchronized</h2><p><strong>1. åŒæ­¥ä¸€ä¸ªä»£ç å—</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å®ƒåªä½œç”¨äºåŒä¸€ä¸ªå¯¹è±¡</strong>ï¼Œå¦‚æœè°ƒç”¨ä¸¤ä¸ªå¯¹è±¡ä¸Šçš„åŒæ­¥ä»£ç å—ï¼Œå°±ä¸ä¼šè¿›è¡ŒåŒæ­¥ã€‚</p><p>å¯¹äºä»¥ä¸‹ä»£ç ï¼Œä½¿ç”¨ ExecutorService æ‰§è¡Œäº†ä¸¤ä¸ªçº¿ç¨‹ï¼Œç”±äºè°ƒç”¨çš„æ˜¯<strong>åŒä¸€ä¸ªå¯¹è±¡</strong>çš„åŒæ­¥ä»£ç å—ï¼Œ<strong><u>å› æ­¤è¿™ä¸¤ä¸ªçº¿ç¨‹ä¼šè¿›è¡ŒåŒæ­¥ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åŒæ­¥è¯­å¥å—æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å°±å¿…é¡»ç­‰å¾…ã€‚</u></strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SynchronizedExample</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                System.out.print(i + <span class="string">" "</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SynchronizedExample e1 = <span class="keyword">new</span> SynchronizedExample();</span><br><span class="line">    ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">    executorService.execute(() -&gt; e1.func1());</span><br><span class="line">    executorService.execute(() -&gt; e1.func1());</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span></span><br></pre></td></tr></table></figure><p>å¯¹äºä»¥ä¸‹ä»£ç ï¼Œ<strong><u>ä¸¤ä¸ªçº¿ç¨‹è°ƒç”¨äº†ä¸åŒå¯¹è±¡çš„åŒæ­¥ä»£ç å—</u></strong>ï¼Œ<strong><u>å› æ­¤è¿™ä¸¤ä¸ªçº¿ç¨‹å°±ä¸éœ€è¦åŒæ­¥</u></strong>ã€‚ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œä¸¤ä¸ªçº¿ç¨‹<strong>äº¤å‰æ‰§è¡Œ</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SynchronizedExample e1 = <span class="keyword">new</span> SynchronizedExample();</span><br><span class="line">    SynchronizedExample e2 = <span class="keyword">new</span> SynchronizedExample();</span><br><span class="line">    ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">    executorService.execute(() -&gt; e1.func1()); <span class="comment">//lambaè¡¨è¾¾å¼æ¥å®ç°new Runnableå¹¶åœ¨runæ–¹æ³•é‡Œè°ƒç”¨e.func1()</span></span><br><span class="line">    executorService.execute(() -&gt; e2.func1());</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">3</span> <span class="number">4</span> <span class="number">4</span> <span class="number">5</span> <span class="number">5</span> <span class="number">6</span> <span class="number">6</span> <span class="number">7</span> <span class="number">7</span> <span class="number">8</span> <span class="number">8</span> <span class="number">9</span> <span class="number">9</span></span><br></pre></td></tr></table></figure><p><strong>2. åŒæ­¥ä¸€ä¸ªæ–¹æ³•</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">func</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒå’ŒåŒæ­¥ä»£ç å—ä¸€æ ·ï¼Œä½œç”¨äºåŒä¸€ä¸ªå¯¹è±¡ã€‚</p><p><strong>3. åŒæ­¥ä¸€ä¸ªç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (SynchronizedExample<span class="class">.<span class="keyword">class</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><u>ä½œç”¨äºæ•´ä¸ªç±»ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤ä¸ªçº¿ç¨‹è°ƒç”¨åŒä¸€ä¸ªç±»çš„ä¸åŒå¯¹è±¡ä¸Šçš„è¿™ç§åŒæ­¥è¯­å¥ï¼Œä¹Ÿä¼šè¿›è¡ŒåŒæ­¥ã€‚</u></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SynchronizedExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (SynchronizedExample<span class="class">.<span class="keyword">class</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                System.out.print(i + <span class="string">" "</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SynchronizedExample e1 = <span class="keyword">new</span> SynchronizedExample();</span><br><span class="line">    SynchronizedExample e2 = <span class="keyword">new</span> SynchronizedExample();</span><br><span class="line">    ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">    executorService.execute(() -&gt; e1.func2());</span><br><span class="line">    executorService.execute(() -&gt; e2.func2());</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span></span><br></pre></td></tr></table></figure><p><strong>4. åŒæ­¥ä¸€ä¸ªé™æ€æ–¹æ³•</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">fun</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½œç”¨äºæ•´ä¸ªç±»ã€‚</p><h2 id="ReentrantLock"><a href="#ReentrantLock" class="headerlink" title="ReentrantLock"></a>ReentrantLock</h2><p>ReentrantLock æ˜¯ java.util.concurrentï¼ˆJ.U.Cï¼‰åŒ…ä¸­çš„é”ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LockExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Lock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                System.out.print(i + <span class="string">" "</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock(); <span class="comment">// ç¡®ä¿é‡Šæ”¾é”ï¼Œä»è€Œé¿å…å‘ç”Ÿæ­»é”ã€‚</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    LockExample lockExample = <span class="keyword">new</span> LockExample();</span><br><span class="line">    ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">    executorService.execute(() -&gt; lockExample.func());</span><br><span class="line">    executorService.execute(() -&gt; lockExample.func());</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span> <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span></span><br></pre></td></tr></table></figure><h2 id="æ¯”è¾ƒ"><a href="#æ¯”è¾ƒ" class="headerlink" title="æ¯”è¾ƒ"></a>æ¯”è¾ƒ</h2><p><strong>1. é”çš„å®ç°</strong></p><p>synchronized æ˜¯ JVM å®ç°çš„ï¼Œè€Œ ReentrantLock æ˜¯ JDK å®ç°çš„ã€‚</p><p><strong>2. æ€§èƒ½</strong></p><p>æ–°ç‰ˆæœ¬ Java å¯¹ synchronized è¿›è¡Œäº†å¾ˆå¤šä¼˜åŒ–ï¼Œä¾‹å¦‚è‡ªæ—‹é”ç­‰ï¼Œsynchronized ä¸ ReentrantLock å¤§è‡´ç›¸åŒã€‚</p><p><strong>3. ç­‰å¾…å¯ä¸­æ–­</strong></p><p>å½“æŒæœ‰é”çš„çº¿ç¨‹é•¿æœŸä¸é‡Šæ”¾é”çš„æ—¶å€™ï¼Œæ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹å¯ä»¥é€‰æ‹©æ”¾å¼ƒç­‰å¾…ï¼Œæ”¹ä¸ºå¤„ç†å…¶ä»–äº‹æƒ…ã€‚</p><p><u>ReentrantLock å¯ä¸­æ–­ï¼Œè€Œ synchronized ä¸è¡Œã€‚</u></p><p><strong>4. å…¬å¹³é”</strong></p><p>å…¬å¹³é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åŒä¸€ä¸ªé”æ—¶ï¼Œå¿…é¡»æŒ‰ç…§ç”³è¯·é”çš„æ—¶é—´é¡ºåºæ¥ä¾æ¬¡è·å¾—é”ã€‚</p><p>synchronized ä¸­çš„é”æ˜¯éå…¬å¹³çš„ï¼ŒReentrantLock é»˜è®¤æƒ…å†µä¸‹ä¹Ÿæ˜¯éå…¬å¹³çš„ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æ˜¯å…¬å¹³çš„ã€‚</p><p><strong>5. é”ç»‘å®šå¤šä¸ªæ¡ä»¶</strong></p><p>ä¸€ä¸ª ReentrantLock å¯ä»¥åŒæ—¶ç»‘å®š<u>å¤šä¸ª Condition å¯¹è±¡</u>ã€‚</p><h2 id="ä½¿ç”¨é€‰æ‹©"><a href="#ä½¿ç”¨é€‰æ‹©" class="headerlink" title="ä½¿ç”¨é€‰æ‹©"></a>ä½¿ç”¨é€‰æ‹©</h2><p>é™¤ééœ€è¦ä½¿ç”¨ ReentrantLock çš„é«˜çº§åŠŸèƒ½ï¼Œå¦åˆ™ä¼˜å…ˆä½¿ç”¨ synchronizedã€‚è¿™æ˜¯å› ä¸º synchronized æ˜¯  JVM å®ç°çš„ä¸€ç§é”æœºåˆ¶ï¼ŒJVM åŸç”Ÿåœ°æ”¯æŒå®ƒï¼Œè€Œ ReentrantLock ä¸æ˜¯æ‰€æœ‰çš„ JDK ç‰ˆæœ¬éƒ½æ”¯æŒã€‚å¹¶ä¸”ä½¿ç”¨  synchronized ä¸ç”¨æ‹…å¿ƒæ²¡æœ‰é‡Šæ”¾é”è€Œå¯¼è‡´æ­»é”é—®é¢˜ï¼Œå› ä¸º JVM ä¼šç¡®ä¿é”çš„é‡Šæ”¾ã€‚</p><h1 id="äº”ã€çº¿ç¨‹ä¹‹é—´çš„åä½œ"><a href="#äº”ã€çº¿ç¨‹ä¹‹é—´çš„åä½œ" class="headerlink" title="äº”ã€çº¿ç¨‹ä¹‹é—´çš„åä½œ"></a>äº”ã€çº¿ç¨‹ä¹‹é—´çš„åä½œ</h1><p>å½“å¤šä¸ªçº¿ç¨‹å¯ä»¥ä¸€èµ·å·¥ä½œå»è§£å†³æŸä¸ªé—®é¢˜æ—¶ï¼Œå¦‚æœæŸäº›éƒ¨åˆ†å¿…é¡»åœ¨å…¶å®ƒéƒ¨åˆ†ä¹‹å‰å®Œæˆï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹çº¿ç¨‹è¿›è¡Œåè°ƒã€‚</p><h2 id="join"><a href="#join" class="headerlink" title="join()"></a>join()</h2><p><u>åœ¨çº¿ç¨‹ä¸­è°ƒç”¨å¦ä¸€ä¸ªçº¿ç¨‹çš„ join() æ–¹æ³•ï¼Œä¼šå°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œè€Œä¸æ˜¯å¿™ç­‰å¾…ï¼Œç›´åˆ°ç›®æ ‡çº¿ç¨‹ç»“æŸã€‚</u></p><p>å¯¹äºä»¥ä¸‹ä»£ç ï¼Œ<u>è™½ç„¶ b çº¿ç¨‹å…ˆå¯åŠ¨ï¼Œä½†æ˜¯å› ä¸ºåœ¨ b çº¿ç¨‹ä¸­è°ƒç”¨äº† a çº¿ç¨‹çš„ join() æ–¹æ³•ï¼Œb çº¿ç¨‹ä¼šç­‰å¾… a çº¿ç¨‹ç»“æŸæ‰ç»§ç»­æ‰§è¡Œï¼Œå› æ­¤æœ€åèƒ½å¤Ÿä¿è¯ a çº¿ç¨‹çš„è¾“å‡ºå…ˆäº b çº¿ç¨‹çš„è¾“å‡º</u>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JoinExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"A"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> A a;</span><br><span class="line"></span><br><span class="line">        B(A a) &#123;</span><br><span class="line">            <span class="keyword">this</span>.a = a;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                a.join();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">"B"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        A a = <span class="keyword">new</span> A();</span><br><span class="line">        B b = <span class="keyword">new</span> B(a);</span><br><span class="line">        b.start();</span><br><span class="line">        a.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    JoinExample example = <span class="keyword">new</span> JoinExample();</span><br><span class="line">    example.test();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">A</span><br><span class="line">B</span><br></pre></td></tr></table></figure><h2 id="wait-notify-notifyAll"><a href="#wait-notify-notifyAll" class="headerlink" title="wait() notify() notifyAll()"></a>wait() notify() notifyAll()</h2><p>è°ƒç”¨ <strong>wait()</strong> ä½¿å¾—çº¿ç¨‹<strong>ç­‰å¾…æŸä¸ªæ¡ä»¶æ»¡è¶³</strong>ï¼Œ<strong>çº¿ç¨‹åœ¨ç­‰å¾…æ—¶ä¼šè¢«æŒ‚èµ·</strong>ï¼Œå½“<strong>å…¶ä»–çº¿ç¨‹</strong>çš„è¿è¡Œä½¿å¾—è¿™ä¸ª<strong>æ¡ä»¶æ»¡è¶³</strong>æ—¶ï¼Œå…¶å®ƒçº¿ç¨‹ä¼šè°ƒç”¨ <strong>notify()</strong> æˆ–è€… <strong>notifyAll()</strong> æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ã€‚</p><p>å®ƒä»¬éƒ½å±äº <strong>Object</strong> çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸å±äº <strong>Thread</strong>ã€‚</p><p><u><strong>åªèƒ½ç”¨åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥æ§åˆ¶å—ä¸­ä½¿ç”¨</strong></u>ï¼Œå¦åˆ™ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡º <strong>IllegalMonitorStateException</strong>ã€‚</p><p><u>ä½¿ç”¨ wait() æŒ‚èµ·æœŸé—´ï¼Œ<strong>çº¿ç¨‹ä¼šé‡Šæ”¾é”</strong>ã€‚è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœæ²¡æœ‰é‡Šæ”¾é”ï¼Œé‚£ä¹ˆå…¶å®ƒçº¿ç¨‹å°±æ— æ³•è¿›å…¥å¯¹è±¡çš„åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥æ§åˆ¶å—ä¸­ï¼Œé‚£ä¹ˆå°±æ— æ³•æ‰§è¡Œ notify() æˆ–è€… notifyAll() æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ï¼Œé€ æˆæ­»é”</u>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WaitNotifyExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"before"</span>);</span><br><span class="line">        notifyAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            wait();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"after"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">    WaitNotifyExample example = <span class="keyword">new</span> WaitNotifyExample();</span><br><span class="line">    executorService.execute(() -&gt; example.after());<span class="comment">//wait()å°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œçº¿ç¨‹é‡Šæ”¾é”ï¼Œè¿™æ ·æ‰èƒ½æ‰§è¡Œbeforeæ–¹æ³•ä¸­çš„notifyAllæ–¹æ³•æ¥å”¤é†’è¢«æŒ‚èµ·çš„çº¿ç¨‹ï¼Œå¦åˆ™æ­»é”</span></span><br><span class="line">    executorService.execute(() -&gt; example.before());</span><br><span class="line">&#125;</span><br><span class="line">before</span><br><span class="line">after</span><br></pre></td></tr></table></figure><p><strong>wait() å’Œ sleep() çš„åŒºåˆ«</strong></p><ul><li>wait() æ˜¯ Object çš„æ–¹æ³•ï¼Œè€Œ sleep() æ˜¯ Thread çš„é™æ€æ–¹æ³•ï¼›</li><li><strong>wait() ä¼šé‡Šæ”¾é”ï¼Œsleep() å’Œyield()ä¸ä¼šã€‚</strong></li></ul><h2 id="await-signal-signalAll"><a href="#await-signal-signalAll" class="headerlink" title="await() signal() signalAll()"></a>await() signal() signalAll()</h2><p>java.util.concurrent ç±»åº“ä¸­æä¾›äº† <strong>Condition</strong> ç±»æ¥å®ç°çº¿ç¨‹ä¹‹é—´çš„åè°ƒï¼Œå¯ä»¥åœ¨ Condition ä¸Šè°ƒç”¨ <strong>await()</strong> æ–¹æ³•ä½¿çº¿ç¨‹ç­‰å¾…ï¼Œå…¶å®ƒçº¿ç¨‹è°ƒç”¨ <strong>signal()</strong> æˆ– <strong>signalAll()</strong> æ–¹æ³•å”¤é†’ç­‰å¾…çš„çº¿ç¨‹ã€‚</p><p>ç›¸æ¯”äº wait() è¿™ç§ç­‰å¾…æ–¹å¼ï¼Œawait() å¯ä»¥æŒ‡å®šç­‰å¾…çš„æ¡ä»¶ï¼Œå› æ­¤æ›´åŠ çµæ´»ã€‚</p><p>ä½¿ç”¨ <strong>Lock</strong> æ¥è·å–ä¸€ä¸ª <strong>Condition</strong> å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AwaitSignalExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Lock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line">    <span class="keyword">private</span> Condition condition = lock.newCondition();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"before"</span>);</span><br><span class="line">            condition.signalAll();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="comment">//boolean await()</span></span><br><span class="line">          <span class="comment">// é€ æˆå½“å‰çº¿ç¨‹åœ¨æ¥åˆ°ä¿¡å·ã€è¢«ä¸­æ–­æˆ–åˆ°è¾¾æŒ‡å®šç­‰å¾…æ—¶é—´ä¹‹å‰ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ã€‚</span></span><br><span class="line">          <span class="comment">//boolean await(long time, TimeUnit unit)</span></span><br><span class="line">            condition.await();</span><br><span class="line">            System.out.println(<span class="string">"after"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">    AwaitSignalExample example = <span class="keyword">new</span> AwaitSignalExample();</span><br><span class="line">    executorService.execute(() -&gt; example.after());</span><br><span class="line">    executorService.execute(() -&gt; example.before());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">before</span><br><span class="line">after</span><br></pre></td></tr></table></figure><h1 id="å…­ã€çº¿ç¨‹çŠ¶æ€"><a href="#å…­ã€çº¿ç¨‹çŠ¶æ€" class="headerlink" title="å…­ã€çº¿ç¨‹çŠ¶æ€"></a>å…­ã€çº¿ç¨‹çŠ¶æ€</h1><p><strong>ä¸€ä¸ªçº¿ç¨‹åªèƒ½å¤„äºä¸€ç§çŠ¶æ€</strong>ï¼Œå¹¶ä¸”è¿™é‡Œçš„çº¿ç¨‹çŠ¶æ€ç‰¹æŒ‡ Java è™šæ‹Ÿæœºçš„çº¿ç¨‹çŠ¶æ€ï¼Œä¸èƒ½åæ˜ çº¿ç¨‹åœ¨ç‰¹å®šæ“ä½œç³»ç»Ÿä¸‹çš„çŠ¶æ€ã€‚</p><h2 id="æ–°å»ºï¼ˆNEWï¼‰"><a href="#æ–°å»ºï¼ˆNEWï¼‰" class="headerlink" title="æ–°å»ºï¼ˆNEWï¼‰"></a>æ–°å»ºï¼ˆNEWï¼‰</h2><p>åˆ›å»ºåå°šæœªå¯åŠ¨ã€‚</p><h2 id="å¯è¿è¡Œï¼ˆRUNABLEï¼‰"><a href="#å¯è¿è¡Œï¼ˆRUNABLEï¼‰" class="headerlink" title="å¯è¿è¡Œï¼ˆRUNABLEï¼‰"></a>å¯è¿è¡Œï¼ˆRUNABLEï¼‰</h2><p>æ­£åœ¨ Java è™šæ‹Ÿæœºä¸­è¿è¡Œã€‚ä½†æ˜¯åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œå®ƒå¯èƒ½å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œä¹Ÿå¯èƒ½ç­‰å¾…èµ„æºè°ƒåº¦ï¼ˆä¾‹å¦‚å¤„ç†å™¨èµ„æºï¼‰ï¼Œèµ„æºè°ƒåº¦å®Œæˆå°±è¿›å…¥è¿è¡ŒçŠ¶æ€ã€‚<strong>æ‰€ä»¥è¯¥çŠ¶æ€çš„å¯è¿è¡Œæ˜¯æŒ‡å¯ä»¥è¢«è¿è¡Œï¼Œå…·ä½“æœ‰æ²¡æœ‰è¿è¡Œè¦çœ‹åº•å±‚æ“ä½œç³»ç»Ÿçš„èµ„æºè°ƒåº¦ã€‚</strong></p><h2 id="é˜»å¡ï¼ˆBLOCKEDï¼‰"><a href="#é˜»å¡ï¼ˆBLOCKEDï¼‰" class="headerlink" title="é˜»å¡ï¼ˆBLOCKEDï¼‰"></a>é˜»å¡ï¼ˆBLOCKEDï¼‰</h2><p>è¯·æ±‚è·å– monitor lock ä»è€Œè¿›å…¥ synchronized å‡½æ•°æˆ–è€…ä»£ç å—ï¼Œä½†æ˜¯å…¶å®ƒçº¿ç¨‹å·²ç»å ç”¨äº†è¯¥ monitor lockï¼Œæ‰€ä»¥å‡ºäºé˜»å¡çŠ¶æ€ã€‚è¦ç»“æŸè¯¥çŠ¶æ€è¿›å…¥ä»è€Œ RUNABLE éœ€è¦å…¶ä»–çº¿ç¨‹é‡Šæ”¾ monitor lockã€‚<strong>çº¿ç¨‹Aå…ˆè®¿é—®sychronizedä»£ç å—ï¼Œçº¿ç¨‹Bå†è®¿é—®éœ€è¦è¯·æ±‚è¯¥ä»£ç å—çš„monitor lockï¼Œä½†æ˜¯å‘ç°çº¿ç¨‹Aå·²ç»å ç”¨äº†è¯¥monitor lockï¼Œæ‰€ä»¥çº¿ç¨‹Bç°åœ¨çš„çŠ¶æ€æ˜¯BLOCK</strong></p><h2 id="æ— é™æœŸç­‰å¾…ï¼ˆWAITINGï¼‰"><a href="#æ— é™æœŸç­‰å¾…ï¼ˆWAITINGï¼‰" class="headerlink" title="æ— é™æœŸç­‰å¾…ï¼ˆWAITINGï¼‰"></a>æ— é™æœŸç­‰å¾…ï¼ˆWAITINGï¼‰</h2><p>ç­‰å¾…å…¶å®ƒçº¿ç¨‹æ˜¾å¼åœ°å”¤é†’ã€‚</p><p><strong>é˜»å¡å’Œç­‰å¾…çš„åŒºåˆ«åœ¨äºï¼Œé˜»å¡æ˜¯è¢«åŠ¨çš„ï¼Œå®ƒæ˜¯åœ¨ç­‰å¾…è·å– monitor lockã€‚è€Œç­‰å¾…æ˜¯ä¸»åŠ¨çš„ï¼Œé€šè¿‡è°ƒç”¨  Object.wait() ç­‰æ–¹æ³•è¿›å…¥ã€‚</strong></p><table><thead><tr><th>è¿›å…¥æ–¹æ³•</th><th>é€€å‡ºæ–¹æ³•</th></tr></thead><tbody><tr><td>æ²¡æœ‰è®¾ç½® Timeout å‚æ•°çš„ Object.wait() æ–¹æ³•</td><td>Object.notify() / Object.notifyAll()</td></tr><tr><td>æ²¡æœ‰è®¾ç½® Timeout å‚æ•°çš„ Thread.join() æ–¹æ³•</td><td>è¢«è°ƒç”¨çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</td></tr><tr><td>LockSupport.park() æ–¹æ³•</td><td>LockSupport.unpark(Thread)</td></tr></tbody></table><h2 id="é™æœŸç­‰å¾…ï¼ˆTIMED-WAITINGï¼‰"><a href="#é™æœŸç­‰å¾…ï¼ˆTIMED-WAITINGï¼‰" class="headerlink" title="é™æœŸç­‰å¾…ï¼ˆTIMED_WAITINGï¼‰"></a>é™æœŸç­‰å¾…ï¼ˆTIMED_WAITINGï¼‰</h2><p>æ— éœ€ç­‰å¾…å…¶å®ƒçº¿ç¨‹æ˜¾å¼åœ°å”¤é†’ï¼Œ<strong>åœ¨ä¸€å®šæ—¶é—´ä¹‹åä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨å”¤é†’ã€‚</strong></p><table><thead><tr><th>è¿›å…¥æ–¹æ³•</th><th>é€€å‡ºæ–¹æ³•</th></tr></thead><tbody><tr><td>Thread.sleep() æ–¹æ³•</td><td>æ—¶é—´ç»“æŸ</td></tr><tr><td>è®¾ç½®äº† Timeout å‚æ•°çš„ Object.wait() æ–¹æ³•</td><td>æ—¶é—´ç»“æŸ / Object.notify() / Object.notifyAll()</td></tr><tr><td>è®¾ç½®äº† Timeout å‚æ•°çš„ Thread.join() æ–¹æ³•</td><td>æ—¶é—´ç»“æŸ / è¢«è°ƒç”¨çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</td></tr><tr><td>LockSupport.parkNanos() æ–¹æ³•</td><td>LockSupport.unpark(Thread)</td></tr><tr><td>LockSupport.parkUntil() æ–¹æ³•</td><td>LockSupport.unpark(Thread)</td></tr></tbody></table><p><strong><u>è°ƒç”¨ Thread.sleep() æ–¹æ³•ä½¿çº¿ç¨‹è¿›å…¥é™æœŸç­‰å¾…çŠ¶æ€æ—¶ï¼Œå¸¸å¸¸ç”¨â€œä½¿ä¸€ä¸ªçº¿ç¨‹ç¡çœ â€è¿›è¡Œæè¿°ã€‚è°ƒç”¨ Object.wait()  æ–¹æ³•ä½¿çº¿ç¨‹è¿›å…¥é™æœŸç­‰å¾…æˆ–è€…æ— é™æœŸç­‰å¾…æ—¶ï¼Œå¸¸å¸¸ç”¨â€œæŒ‚èµ·ä¸€ä¸ªçº¿ç¨‹â€è¿›è¡Œæè¿°ã€‚ç¡çœ å’ŒæŒ‚èµ·æ˜¯ç”¨æ¥æè¿°è¡Œä¸ºï¼Œè€Œé˜»å¡å’Œç­‰å¾…ç”¨æ¥æè¿°çŠ¶æ€ã€‚</u></strong></p><h2 id="æ­»äº¡ï¼ˆTERMINATEDï¼‰"><a href="#æ­»äº¡ï¼ˆTERMINATEDï¼‰" class="headerlink" title="æ­»äº¡ï¼ˆTERMINATEDï¼‰"></a>æ­»äº¡ï¼ˆTERMINATEDï¼‰</h2><p>å¯ä»¥æ˜¯çº¿ç¨‹ç»“æŸä»»åŠ¡ä¹‹åè‡ªå·±ç»“æŸï¼Œæˆ–è€…äº§ç”Ÿäº†å¼‚å¸¸è€Œç»“æŸã€‚</p><p><a href="https://docs.oracle.com/javase/9/docs/api/java/lang/Thread.State.html">Java SE 9 Enum Thread.State</a></p><h1 id="ä¸ƒã€J-U-C-AQS"><a href="#ä¸ƒã€J-U-C-AQS" class="headerlink" title="ä¸ƒã€J.U.C - AQS"></a>ä¸ƒã€J.U.C - AQS</h1><p>java.util.concurrentï¼ˆJ.U.Cï¼‰å¤§å¤§æé«˜äº†å¹¶å‘æ€§èƒ½ï¼ŒAQS è¢«è®¤ä¸ºæ˜¯ J.U.C çš„æ ¸å¿ƒã€‚</p><h2 id="CountDownLatch"><a href="#CountDownLatch" class="headerlink" title="CountDownLatch"></a>CountDownLatch</h2><p><strong><u>ç”¨æ¥æ§åˆ¶ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹ç­‰å¾…å¤šä¸ªçº¿ç¨‹</u></strong>ã€‚</p><p>ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ cntï¼Œæ¯æ¬¡è°ƒç”¨ <strong>countDown()</strong> æ–¹æ³•ä¼šè®©è®¡æ•°å™¨çš„å€¼<strong>å‡ 1</strong>ï¼Œ<u>å‡åˆ° 0 çš„æ—¶å€™ï¼Œé‚£äº›å› ä¸ºè°ƒç”¨ <strong>await()</strong> æ–¹æ³•è€Œåœ¨ç­‰å¾…çš„çº¿ç¨‹å°±ä¼šè¢«å”¤é†’ã€‚</u></p><p>åˆ©ç”¨å®ƒå¯ä»¥å®ç°ç±»ä¼¼è®¡æ•°å™¨çš„åŠŸèƒ½ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªä»»åŠ¡Aï¼Œå®ƒè¦ç­‰å¾…å…¶ä»–4ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åæ‰èƒ½æ‰§è¡Œï¼Œæ­¤æ—¶å°±å¯ä»¥åˆ©ç”¨CountDownLatchæ¥å®ç°è¿™ç§åŠŸèƒ½äº†ã€‚</p><p> <a href="https://camo.githubusercontent.com/c2a94b75d7379c204996f24411a9c497125cfa06/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f62613037383239312d373931652d343337382d623664312d6563653736633266306231342e706e67"><img src="https://camo.githubusercontent.com/c2a94b75d7379c204996f24411a9c497125cfa06/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f62613037383239312d373931652d343337382d623664312d6563653736633266306231342e706e67" alt="img"></a> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CountdownLatchExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> CountDownLatch latch = <span class="keyword">new</span> CountDownLatch(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> Thread()&#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(<span class="string">"å­çº¿ç¨‹"</span>+Thread.currentThread().getName()+<span class="string">"æ­£åœ¨æ‰§è¡Œ"</span>);</span><br><span class="line">                    Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">                    System.out.println(<span class="string">"å­çº¿ç¨‹"</span>+Thread.currentThread().getName()+<span class="string">"æ‰§è¡Œå®Œæ¯•"</span>);</span><br><span class="line">                    latch.countDown();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;.start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> Thread()&#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(<span class="string">"å­çº¿ç¨‹"</span>+Thread.currentThread().getName()+<span class="string">"æ­£åœ¨æ‰§è¡Œ"</span>);</span><br><span class="line">                    Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">                    System.out.println(<span class="string">"å­çº¿ç¨‹"</span>+Thread.currentThread().getName()+<span class="string">"æ‰§è¡Œå®Œæ¯•"</span>);</span><br><span class="line">                    latch.countDown();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;.start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"ç­‰å¾…2ä¸ªå­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•..."</span>);</span><br><span class="line">            latch.await();<span class="comment">//æŒ‚èµ·ä¸»çº¿ç¨‹ï¼Œè®©ä¸¤ä¸ªå­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</span></span><br><span class="line">          <span class="comment">//å½“ä¸¤ä¸ªå­çº¿ç¨‹éƒ½countDown()ä¹‹åï¼Œè®¡æ•°å™¨çš„å€¼ä¸º0ï¼Œè¢«æŒ‚èµ·çš„ä¸»çº¿ç¨‹è¢«å”¤é†’ç»§ç»­æ‰§è¡Œ</span></span><br><span class="line">            System.out.println(<span class="string">"2ä¸ªå­çº¿ç¨‹å·²ç»æ‰§è¡Œå®Œæ¯•"</span>);</span><br><span class="line">            System.out.println(<span class="string">"ç»§ç»­æ‰§è¡Œä¸»çº¿ç¨‹"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ç­‰å¾…<span class="number">2</span>ä¸ªå­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•...</span><br><span class="line">å­çº¿ç¨‹Thread-<span class="number">1</span>æ­£åœ¨æ‰§è¡Œ</span><br><span class="line">å­çº¿ç¨‹Thread-<span class="number">0</span>æ­£åœ¨æ‰§è¡Œ</span><br><span class="line">å­çº¿ç¨‹Thread-<span class="number">1</span>æ‰§è¡Œå®Œæ¯•</span><br><span class="line">å­çº¿ç¨‹Thread-<span class="number">0</span>æ‰§è¡Œå®Œæ¯•</span><br><span class="line"><span class="number">2</span>ä¸ªå­çº¿ç¨‹å·²ç»æ‰§è¡Œå®Œæ¯•</span><br><span class="line">ç»§ç»­æ‰§è¡Œä¸»çº¿ç¨‹</span><br></pre></td></tr></table></figure><h2 id="CyclicBarrier"><a href="#CyclicBarrier" class="headerlink" title="CyclicBarrier"></a>CyclicBarrier</h2><p><u><strong>ç”¨æ¥æ§åˆ¶å¤šä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…ï¼Œåªæœ‰å½“å¤šä¸ªçº¿ç¨‹éƒ½åˆ°è¾¾æ—¶ï¼Œè¿™äº›çº¿ç¨‹æ‰ä¼šç»§ç»­æ‰§è¡Œã€‚</strong></u></p><p>å’Œ CountdownLatch ç›¸ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡<u><strong>ç»´æŠ¤è®¡æ•°å™¨</strong></u>æ¥å®ç°çš„ã€‚<u>çº¿ç¨‹æ‰§è¡Œ <strong>await()</strong> æ–¹æ³•ä¹‹åè®¡æ•°å™¨ä¼šå‡ 1</u>ï¼Œå¹¶è¿›è¡Œç­‰å¾…ï¼Œç›´åˆ°è®¡æ•°å™¨ä¸º 0ï¼Œæ‰€æœ‰è°ƒç”¨ await() æ–¹æ³•è€Œåœ¨ç­‰å¾…çš„çº¿ç¨‹æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚</p><p><u><strong>CyclicBarrier å’Œ CountdownLatch çš„ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼ŒCyclicBarrier çš„è®¡æ•°å™¨é€šè¿‡è°ƒç”¨ reset() æ–¹æ³•å¯ä»¥å¾ªç¯ä½¿ç”¨ï¼Œæ‰€ä»¥å®ƒæ‰å«åšå¾ªç¯å±éšœã€‚</strong></u></p><p><u><strong>CyclicBarrier æœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œå…¶ä¸­ parties æŒ‡ç¤ºè®¡æ•°å™¨çš„åˆå§‹å€¼ï¼ŒbarrierAction åœ¨æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾å±éšœçš„æ—¶å€™ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</strong></u></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">CyclicBarrier</span><span class="params">(<span class="keyword">int</span> parties, Runnable barrierAction)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (parties &lt;= <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</span><br><span class="line">    <span class="keyword">this</span>.parties = parties;</span><br><span class="line">    <span class="keyword">this</span>.count = parties;</span><br><span class="line">    <span class="keyword">this</span>.barrierCommand = barrierAction;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">CyclicBarrier</span><span class="params">(<span class="keyword">int</span> parties)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>(parties, <span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <a href="https://camo.githubusercontent.com/10dd07a9c7828fab8f68a0f953755869dc286a8e/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f66373161663636622d306435342d343339392d613434622d6634376235383332313938342e706e67"><img src="https://camo.githubusercontent.com/10dd07a9c7828fab8f68a0f953755869dc286a8e/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f66373161663636622d306435342d343339392d613434622d6634376235383332313938342e706e67" alt="img"></a> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CyclicBarrierExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> totalThread = <span class="number">10</span>;</span><br><span class="line">        CyclicBarrier cyclicBarrier = <span class="keyword">new</span> CyclicBarrier(totalThread);</span><br><span class="line">        ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; totalThread; i++) &#123;</span><br><span class="line">            executorService.execute(() -&gt; &#123;</span><br><span class="line">                System.out.print(<span class="string">"before.."</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    cyclicBarrier.await();<span class="comment">//æŒ‚èµ·çº¿ç¨‹ï¼Œå¹¶å°†è®¡æ•°å™¨-1ï¼Œè®¡æ•°å™¨ä¸º0æ—¶æ‰ä¼šé‡Šæ”¾çº¿ç¨‹å¾€ä¸‹æ‰§è¡Œ</span></span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException | BrokenBarrierException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.print(<span class="string">"after.."</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        executorService.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">before..before..before..before..before..before..before..before..before..before..after..after..after..after..after..after..after..after..after..after..</span><br></pre></td></tr></table></figure><h2 id="Semaphore"><a href="#Semaphore" class="headerlink" title="Semaphore"></a>Semaphore</h2><p>Semaphore ç±»ä¼¼äºæ“ä½œç³»ç»Ÿä¸­çš„ä¿¡å·é‡ï¼Œ<strong><u>å¯ä»¥æ§åˆ¶å¯¹äº’æ–¥èµ„æºçš„è®¿é—®çº¿ç¨‹æ•°</u></strong>ã€‚</p><p>Semaphoreç¿»è¯‘æˆå­—é¢æ„æ€ä¸º ä¿¡å·é‡ï¼ŒSemaphoreå¯ä»¥æ§åŒæ—¶è®¿é—®çš„çº¿ç¨‹ä¸ªæ•°ï¼Œé€šè¿‡ acquire() è·å–ä¸€ä¸ªè®¸å¯ï¼Œå¦‚æœæ²¡æœ‰å°±ç­‰å¾…ï¼Œè€Œ release() é‡Šæ”¾ä¸€ä¸ªè®¸å¯ã€‚</p><p>ä»¥ä¸‹ä»£ç æ¨¡æ‹Ÿäº†å¯¹æŸä¸ªæœåŠ¡çš„å¹¶å‘è¯·æ±‚ï¼Œæ¯æ¬¡åªèƒ½æœ‰ 3 ä¸ªå®¢æˆ·ç«¯åŒæ—¶è®¿é—®ï¼Œè¯·æ±‚æ€»æ•°ä¸º 10ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SemaphoreExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> clientCount = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> totalRequestCount = <span class="number">10</span>;</span><br><span class="line">        Semaphore semaphore = <span class="keyword">new</span> Semaphore(clientCount);<span class="comment">//å…è®¸ä¸‰ä¸ªçº¿ç¨‹è¿›è¡Œè®¿é—®</span></span><br><span class="line">        ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; totalRequestCount; i++) &#123;</span><br><span class="line">            executorService.execute(()-&gt;&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    semaphore.acquire();<span class="comment">//è·å¾—ä¸€ä¸ªè®¸å¯</span></span><br><span class="line">                    System.out.print(semaphore.availablePermits() + <span class="string">" "</span>);<span class="comment">//å½“å‰å¯ç”¨çš„è®¸å¯æ•°ç›®</span></span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    semaphore.release();<span class="comment">//é‡Šæ”¾ä¸€ä¸ªè®¸å¯</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        executorService.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><h1 id="å…«ã€J-U-C-å…¶å®ƒç»„ä»¶"><a href="#å…«ã€J-U-C-å…¶å®ƒç»„ä»¶" class="headerlink" title="å…«ã€J.U.C - å…¶å®ƒç»„ä»¶"></a>å…«ã€J.U.C - å…¶å®ƒç»„ä»¶</h1><h2 id="FutureTask"><a href="#FutureTask" class="headerlink" title="FutureTask"></a>FutureTask</h2><p>åœ¨ä»‹ç» Callable æ—¶æˆ‘ä»¬çŸ¥é“å®ƒå¯ä»¥æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼é€šè¿‡ Future è¿›è¡Œå°è£…ã€‚FutureTask å®ç°äº†  RunnableFuture æ¥å£ï¼Œè¯¥æ¥å£ç»§æ‰¿è‡ª Runnable å’Œ Future æ¥å£ï¼Œ<strong><u>è¿™ä½¿å¾— FutureTask  æ—¢å¯ä»¥å½“åšä¸€ä¸ªä»»åŠ¡æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥æœ‰è¿”å›å€¼ã€‚</u></strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FutureTask</span>&lt;<span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">RunnableFuture</span>&lt;<span class="title">V</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">interface</span> <span class="title">RunnableFuture</span>&lt;<span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">Runnable</span>, <span class="title">Future</span>&lt;<span class="title">V</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong><em>FutureTask</em></strong> å¯ç”¨äº<strong>å¼‚æ­¥è·å–æ‰§è¡Œç»“æœæˆ–å–æ¶ˆæ‰§è¡Œä»»åŠ¡</strong>çš„åœºæ™¯ã€‚<u><strong>å½“ä¸€ä¸ªè®¡ç®—ä»»åŠ¡éœ€è¦æ‰§è¡Œå¾ˆé•¿æ—¶é—´ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨ FutureTask æ¥å°è£…è¿™ä¸ªä»»åŠ¡ï¼Œä¸»çº¿ç¨‹åœ¨å®Œæˆè‡ªå·±çš„ä»»åŠ¡ä¹‹åå†å»è·å–ç»“æœ</strong></u>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FutureTaskExample</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException </span>&#123;</span><br><span class="line">        <span class="comment">//åœ¨FutureTaské‡Œåˆ†é…ä»»åŠ¡ï¼ŒFTé‡Œé¢å¯ä»¥æ”¾Runnableå¯¹è±¡ï¼Œå®ç°Runnableå¯¹è±¡çš„runæˆ–è€…callå‡½æ•°æ¥è®¾ç½®ä»»åŠ¡</span></span><br><span class="line">        FutureTask&lt;Integer&gt; futureTask = <span class="keyword">new</span> FutureTask&lt;Integer&gt;(<span class="keyword">new</span> Callable&lt;Integer&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Integer <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">10</span>);</span><br><span class="line">                    result += i;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å› ä¸ºè¿™ä¸ªFTçš„ä»»åŠ¡éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œå…ˆåˆ†é…ä¸€ä¸ªçº¿ç¨‹æ¥è®¡ç®—</span></span><br><span class="line">        Thread computeThread = <span class="keyword">new</span> Thread(futureTask);</span><br><span class="line">        computeThread.start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å› ä¸ºç¬¬ä¸€ä¸ªçº¿ç¨‹è¦è®¡ç®—å¾ˆä¹…ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ‰§è¡Œå…¶ä»–çš„çº¿ç¨‹ï¼Œæœ€åå–å›è®¡ç®—å¾ˆä¹…çš„çº¿ç¨‹çš„è®¡ç®—ç»“æœ</span></span><br><span class="line">        Thread otherThread = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">"other task is running..."</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        otherThread.start();</span><br><span class="line">        System.out.println(futureTask.get());<span class="comment">//æœ€åå–å›è®¡ç®—ç»“æœ</span></span><br><span class="line">&#125;</span><br><span class="line">other task is running...</span><br><span class="line"><span class="number">4950</span></span><br></pre></td></tr></table></figure><h2 id="BlockingQueue"><a href="#BlockingQueue" class="headerlink" title="BlockingQueue"></a>BlockingQueue</h2><p>java.util.concurrent.BlockingQueue æ¥å£æœ‰ä»¥ä¸‹é˜»å¡é˜Ÿåˆ—çš„å®ç°ï¼š</p><ul><li><strong>FIFO é˜Ÿåˆ—</strong>  ï¼šLinkedBlockingQueueã€ArrayBlockingQueueï¼ˆå›ºå®šé•¿åº¦ï¼‰</li><li><strong>ä¼˜å…ˆçº§é˜Ÿåˆ—</strong>  ï¼šPriorityBlockingQueue</li></ul><p>æä¾›äº†é˜»å¡çš„ take() å’Œ put() æ–¹æ³•ï¼š<strong><u>å¦‚æœé˜Ÿåˆ—ä¸ºç©º take() å°†é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰å†…å®¹ï¼›å¦‚æœé˜Ÿåˆ—ä¸ºæ»¡ put() å°†é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—æœ‰ç©ºé—²ä½ç½®ã€‚</u></strong></p><p><strong>ä½¿ç”¨ BlockingQueue å®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProducerConsumer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> BlockingQueue&lt;String&gt; queue = <span class="keyword">new</span> ArrayBlockingQueue&lt;&gt;(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                queue.put(<span class="string">"product"</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.print(<span class="string">"produce.."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                String product = queue.take();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.print(<span class="string">"consume.."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">        Producer producer = <span class="keyword">new</span> Producer();</span><br><span class="line">        producer.start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        Consumer consumer = <span class="keyword">new</span> Consumer();</span><br><span class="line">        consumer.start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">        Producer producer = <span class="keyword">new</span> Producer();</span><br><span class="line">        producer.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//putä¸takeç›¸äº’æŠµæ¶ˆ</span></span><br><span class="line">produce..produce..consume..consume..produce..consume..produce..consume..produce..consume..</span><br></pre></td></tr></table></figure><h2 id="ForkJoin"><a href="#ForkJoin" class="headerlink" title="ForkJoin"></a>ForkJoin</h2><p>ä¸»è¦ç”¨äºå¹¶è¡Œè®¡ç®—ä¸­ï¼Œå’Œ MapReduce åŸç†ç±»ä¼¼ï¼Œ<strong><u>éƒ½æ˜¯æŠŠå¤§çš„è®¡ç®—ä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°ä»»åŠ¡å¹¶è¡Œè®¡ç®—</u></strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForkJoinExample</span> <span class="keyword">extends</span> <span class="title">RecursiveTask</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> threshold = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> first;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> last;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ForkJoinExample</span><span class="params">(<span class="keyword">int</span> first, <span class="keyword">int</span> last)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.first = first;</span><br><span class="line">        <span class="keyword">this</span>.last = last;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Integer <span class="title">compute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (last - first &lt;= threshold) &#123;</span><br><span class="line">            <span class="comment">// ä»»åŠ¡è¶³å¤Ÿå°åˆ™ç›´æ¥è®¡ç®—</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = first; i &lt;= last; i++) &#123;</span><br><span class="line">                result += i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// æ‹†åˆ†æˆå°ä»»åŠ¡</span></span><br><span class="line">            <span class="keyword">int</span> middle = first + (last - first) / <span class="number">2</span>;</span><br><span class="line">            ForkJoinExample leftTask = <span class="keyword">new</span> ForkJoinExample(first, middle);</span><br><span class="line">            ForkJoinExample rightTask = <span class="keyword">new</span> ForkJoinExample(middle + <span class="number">1</span>, last);</span><br><span class="line">            leftTask.fork();</span><br><span class="line">            rightTask.fork();</span><br><span class="line">            result = leftTask.join() + rightTask.join();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException </span>&#123;</span><br><span class="line">    ForkJoinExample example = <span class="keyword">new</span> ForkJoinExample(<span class="number">1</span>, <span class="number">10000</span>);</span><br><span class="line">    ForkJoinPool forkJoinPool = <span class="keyword">new</span> ForkJoinPool();</span><br><span class="line">    Future result = forkJoinPool.submit(example);</span><br><span class="line">    System.out.println(result.get());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><u><strong>ForkJoin ä½¿ç”¨ ForkJoinPool æ¥å¯åŠ¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ•°é‡å–å†³äº CPU æ ¸æ•°ã€‚</strong></u></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForkJoinPool</span> <span class="keyword">extends</span> <span class="title">AbstractExecutorService</span></span></span><br></pre></td></tr></table></figure><p>ForkJoinPool å®ç°äº†<u><strong>å·¥ä½œçªƒå–ç®—æ³•</strong></u>æ¥æé«˜ CPU  çš„åˆ©ç”¨ç‡ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½ç»´æŠ¤äº†ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼Œç”¨æ¥å­˜å‚¨éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚å·¥ä½œçªƒå–ç®—æ³•å…è®¸ç©ºé—²çš„çº¿ç¨‹ä»å…¶å®ƒçº¿ç¨‹çš„åŒç«¯é˜Ÿåˆ—ä¸­çªƒå–ä¸€ä¸ªä»»åŠ¡æ¥æ‰§è¡Œã€‚çªƒå–çš„ä»»åŠ¡å¿…é¡»æ˜¯æœ€æ™šçš„ä»»åŠ¡ï¼Œé¿å…å’Œé˜Ÿåˆ—æ‰€å±çº¿ç¨‹å‘ç”Ÿç«äº‰ã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼ŒThread2 ä» Thread1 çš„é˜Ÿåˆ—ä¸­æ‹¿å‡ºæœ€æ™šçš„ Task1 ä»»åŠ¡ï¼ŒThread1 ä¼šæ‹¿å‡º Task2  æ¥æ‰§è¡Œï¼Œè¿™æ ·å°±é¿å…å‘ç”Ÿç«äº‰ã€‚ä½†æ˜¯å¦‚æœé˜Ÿåˆ—ä¸­åªæœ‰ä¸€ä¸ªä»»åŠ¡æ—¶è¿˜æ˜¯ä¼šå‘ç”Ÿç«äº‰ã€‚</p><p> <a href="https://camo.githubusercontent.com/b06eff6a60482e87b9ded90d6df90f9b47370f84/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f65343266313838662d663461392d346536662d383866632d3435663436383230373266622e706e67"><img src="https://camo.githubusercontent.com/b06eff6a60482e87b9ded90d6df90f9b47370f84/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f65343266313838662d663461392d346536662d383866632d3435663436383230373266622e706e67" alt="img"></a> </p><h1 id="ä¹ã€çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹"><a href="#ä¹ã€çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹" class="headerlink" title="ä¹ã€çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹"></a>ä¹ã€çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹</h1><p><u>å¦‚æœå¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå…±äº«æ•°æ®è¿›è¡Œè®¿é—®è€Œä¸é‡‡å–åŒæ­¥æ“ä½œçš„è¯ï¼Œé‚£ä¹ˆæ“ä½œçš„ç»“æœæ˜¯ä¸ä¸€è‡´çš„ã€‚</u></p><p><u>ä»¥ä¸‹ä»£ç æ¼”ç¤ºäº† 1000 ä¸ªçº¿ç¨‹åŒæ—¶å¯¹ cnt æ‰§è¡Œè‡ªå¢æ“ä½œï¼Œæ“ä½œç»“æŸä¹‹åå®ƒçš„å€¼æœ‰å¯èƒ½å°äº 1000ã€‚</u></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadUnsafeExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cnt++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> threadSize = <span class="number">1000</span>;</span><br><span class="line">    ThreadUnsafeExample example = <span class="keyword">new</span> ThreadUnsafeExample();</span><br><span class="line">    <span class="keyword">final</span> CountDownLatch countDownLatch = <span class="keyword">new</span> CountDownLatch(threadSize);</span><br><span class="line">    ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; threadSize; i++) &#123;</span><br><span class="line">        executorService.execute(() -&gt; &#123;</span><br><span class="line">            example.add();</span><br><span class="line">            countDownLatch.countDown();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    countDownLatch.await();</span><br><span class="line">    executorService.shutdown();</span><br><span class="line">    System.out.println(example.get());</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">997</span></span><br></pre></td></tr></table></figure><h1 id="åã€Java-å†…å­˜æ¨¡å‹"><a href="#åã€Java-å†…å­˜æ¨¡å‹" class="headerlink" title="åã€Java å†…å­˜æ¨¡å‹"></a>åã€Java å†…å­˜æ¨¡å‹</h1><p>Java å†…å­˜æ¨¡å‹è¯•å›¾å±è”½å„ç§ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å†…å­˜è®¿é—®å·®å¼‚ï¼Œä»¥å®ç°è®© Java ç¨‹åºåœ¨å„ç§å¹³å°ä¸‹éƒ½èƒ½è¾¾åˆ°ä¸€è‡´çš„å†…å­˜è®¿é—®æ•ˆæœã€‚</p><h2 id="ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜"><a href="#ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜" class="headerlink" title="ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜"></a>ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜</h2><p>å¤„ç†å™¨ä¸Šçš„å¯„å­˜å™¨çš„è¯»å†™çš„é€Ÿåº¦æ¯”å†…å­˜å¿«å‡ ä¸ªæ•°é‡çº§ï¼Œä¸ºäº†è§£å†³è¿™ç§é€Ÿåº¦çŸ›ç›¾ï¼Œåœ¨å®ƒä»¬ä¹‹é—´åŠ å…¥äº†é«˜é€Ÿç¼“å­˜ã€‚</p><p>åŠ å…¥é«˜é€Ÿç¼“å­˜å¸¦æ¥äº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šç¼“å­˜ä¸€è‡´æ€§ã€‚å¦‚æœå¤šä¸ªç¼“å­˜å…±äº«åŒä¸€å—ä¸»å†…å­˜åŒºåŸŸï¼Œé‚£ä¹ˆå¤šä¸ªç¼“å­˜çš„æ•°æ®å¯èƒ½ä¼šä¸ä¸€è‡´ï¼Œéœ€è¦ä¸€äº›åè®®æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p> <a href="https://camo.githubusercontent.com/7e289aaee2d8533d8870f92659a8984be81eb432/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f39343263613064322d396435632d343561342d383963622d3566643839623631393133662e706e67"><img src="https://camo.githubusercontent.com/7e289aaee2d8533d8870f92659a8984be81eb432/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f39343263613064322d396435632d343561342d383963622d3566643839623631393133662e706e67" alt="img"></a> </p><p>æ‰€æœ‰çš„å˜é‡éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹è¿˜æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œå·¥ä½œå†…å­˜å­˜å‚¨åœ¨é«˜é€Ÿç¼“å­˜æˆ–è€…å¯„å­˜å™¨ä¸­ï¼Œä¿å­˜äº†è¯¥çº¿ç¨‹ä½¿ç”¨çš„å˜é‡çš„ä¸»å†…å­˜å‰¯æœ¬æ‹·è´ã€‚</p><p>çº¿ç¨‹åªèƒ½ç›´æ¥æ“ä½œå·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œä¸åŒçº¿ç¨‹ä¹‹é—´çš„å˜é‡å€¼ä¼ é€’éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆã€‚</p><p> <a href="https://camo.githubusercontent.com/fce232dcfc7411192b429ae86765aa9bef029427/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f31353835313535352d356162632d343937642d616433342d6566656431306634336136622e706e67"><img src="https://camo.githubusercontent.com/fce232dcfc7411192b429ae86765aa9bef029427/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f31353835313535352d356162632d343937642d616433342d6566656431306634336136622e706e67" alt="img"></a> </p><h2 id="å†…å­˜é—´äº¤äº’æ“ä½œ"><a href="#å†…å­˜é—´äº¤äº’æ“ä½œ" class="headerlink" title="å†…å­˜é—´äº¤äº’æ“ä½œ"></a>å†…å­˜é—´äº¤äº’æ“ä½œ</h2><p>Java å†…å­˜æ¨¡å‹å®šä¹‰äº† 8 ä¸ªæ“ä½œæ¥å®Œæˆä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜çš„äº¤äº’æ“ä½œã€‚</p><p> <a href="https://camo.githubusercontent.com/42696b8f0b2cfbf78024f9cd0d806e0e6decb5fe/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f38623765626261642d393630342d343337352d383465332d6634313230393964313730632e706e67"><img src="https://camo.githubusercontent.com/42696b8f0b2cfbf78024f9cd0d806e0e6decb5fe/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f38623765626261642d393630342d343337352d383465332d6634313230393964313730632e706e67" alt="img"></a> </p><ul><li>readï¼šæŠŠä¸€ä¸ªå˜é‡çš„å€¼ä»ä¸»å†…å­˜ä¼ è¾“åˆ°å·¥ä½œå†…å­˜ä¸­</li><li>loadï¼šåœ¨ read ä¹‹åæ‰§è¡Œï¼ŒæŠŠ read å¾—åˆ°çš„å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­</li><li>useï¼šæŠŠå·¥ä½œå†…å­˜ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€’ç»™æ‰§è¡Œå¼•æ“</li><li>assignï¼šæŠŠä¸€ä¸ªä»æ‰§è¡Œå¼•æ“æ¥æ”¶åˆ°çš„å€¼èµ‹ç»™å·¥ä½œå†…å­˜çš„å˜é‡</li><li>storeï¼šæŠŠå·¥ä½œå†…å­˜çš„ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜ä¸­</li><li>writeï¼šåœ¨ store ä¹‹åæ‰§è¡Œï¼ŒæŠŠ store å¾—åˆ°çš„å€¼æ”¾å…¥ä¸»å†…å­˜çš„å˜é‡ä¸­</li><li>lockï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡</li><li>unlock</li></ul><h2 id="å†…å­˜æ¨¡å‹ä¸‰å¤§ç‰¹æ€§"><a href="#å†…å­˜æ¨¡å‹ä¸‰å¤§ç‰¹æ€§" class="headerlink" title="å†…å­˜æ¨¡å‹ä¸‰å¤§ç‰¹æ€§"></a>å†…å­˜æ¨¡å‹ä¸‰å¤§ç‰¹æ€§</h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h3 id="1-åŸå­æ€§"><a href="#1-åŸå­æ€§" class="headerlink" title="1. åŸå­æ€§"></a>1. åŸå­æ€§</h3><p>Java å†…å­˜æ¨¡å‹ä¿è¯äº† readã€loadã€useã€assignã€storeã€writeã€lock å’Œ unlock  æ“ä½œå…·æœ‰åŸå­æ€§ï¼Œä¾‹å¦‚å¯¹ä¸€ä¸ª int ç±»å‹çš„å˜é‡æ‰§è¡Œ assign èµ‹å€¼æ“ä½œï¼Œè¿™ä¸ªæ“ä½œå°±æ˜¯åŸå­æ€§çš„ã€‚ä½†æ˜¯ Java å†…å­˜æ¨¡å‹å…è®¸è™šæ‹Ÿæœºå°†æ²¡æœ‰è¢«  volatile ä¿®é¥°çš„ 64 ä½æ•°æ®ï¼ˆlongï¼Œdoubleï¼‰çš„è¯»å†™æ“ä½œåˆ’åˆ†ä¸ºä¸¤æ¬¡ 32 ä½çš„æ“ä½œæ¥è¿›è¡Œï¼Œå³ loadã€storeã€read å’Œ write æ“ä½œå¯ä»¥ä¸å…·å¤‡åŸå­æ€§ã€‚</p><p>æœ‰ä¸€ä¸ªé”™è¯¯è®¤è¯†å°±æ˜¯ï¼Œint ç­‰åŸå­æ€§çš„ç±»å‹åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚å‰é¢çš„çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹ä»£ç ä¸­ï¼Œcnt å±äº int ç±»å‹å˜é‡ï¼Œ1000 ä¸ªçº¿ç¨‹å¯¹å®ƒè¿›è¡Œè‡ªå¢æ“ä½œä¹‹åï¼Œå¾—åˆ°çš„å€¼ä¸º 997 è€Œä¸æ˜¯ 1000ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿è®¨è®ºï¼Œå°†å†…å­˜é—´çš„äº¤äº’æ“ä½œç®€åŒ–ä¸º 3 ä¸ªï¼šloadã€assignã€storeã€‚</p><p>ä¸‹å›¾æ¼”ç¤ºäº†ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å¯¹ cnt è¿›è¡Œæ“ä½œï¼Œloadã€assignã€store è¿™ä¸€ç³»åˆ—æ“ä½œæ•´ä½“ä¸Šçœ‹ä¸å…·å¤‡åŸå­æ€§ï¼Œé‚£ä¹ˆåœ¨ T1 ä¿®æ”¹  cnt å¹¶ä¸”è¿˜æ²¡æœ‰å°†ä¿®æ”¹åçš„å€¼å†™å…¥ä¸»å†…å­˜ï¼ŒT2 ä¾ç„¶å¯ä»¥è¯»å…¥æ—§å€¼ã€‚å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹è™½ç„¶æ‰§è¡Œäº†ä¸¤æ¬¡è‡ªå¢è¿ç®—ï¼Œä½†æ˜¯ä¸»å†…å­˜ä¸­ cnt çš„å€¼æœ€åä¸º 1 è€Œä¸æ˜¯ 2ã€‚<u><strong>å› æ­¤å¯¹ int ç±»å‹è¯»å†™æ“ä½œæ»¡è¶³åŸå­æ€§åªæ˜¯è¯´æ˜ loadã€assignã€store è¿™äº›å•ä¸ªæ“ä½œå…·å¤‡åŸå­æ€§ã€‚</strong></u></p><p> <a href="https://camo.githubusercontent.com/430b45d369c24a65e4a4641f52b14aaa95d41c7c/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f32373937613630392d363864622d346437622d383730312d3431616339613334623134662e6a7067"><img src="https://camo.githubusercontent.com/430b45d369c24a65e4a4641f52b14aaa95d41c7c/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f32373937613630392d363864622d346437622d383730312d3431616339613334623134662e6a7067" alt="img"></a> </p><p>AtomicInteger èƒ½ä¿è¯å¤šä¸ªçº¿ç¨‹ä¿®æ”¹çš„åŸå­æ€§ã€‚</p><p> <a href="https://camo.githubusercontent.com/b77a1a0dc9c2a35d056d0c76b75df18226283040/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f64643536333033372d666361612d346264382d383362362d6233396439336131326337372e6a7067"><img src="https://camo.githubusercontent.com/b77a1a0dc9c2a35d056d0c76b75df18226283040/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f64643536333033372d666361612d346264382d383362362d6233396439336131326337372e6a7067" alt="img"></a> </p><p><u><strong>ä½¿ç”¨ AtomicInteger é‡å†™ä¹‹å‰çº¿ç¨‹ä¸å®‰å…¨çš„ä»£ç ä¹‹åå¾—åˆ°ä»¥ä¸‹çº¿ç¨‹å®‰å…¨å®ç°ï¼š</strong></u></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AtomicExample</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> AtomicInteger cnt = <span class="keyword">new</span> AtomicInteger();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cnt.incrementAndGet();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cnt.get();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> threadSize = <span class="number">1000</span>;</span><br><span class="line">    AtomicExample example = <span class="keyword">new</span> AtomicExample(); <span class="comment">// åªä¿®æ”¹è¿™æ¡è¯­å¥</span></span><br><span class="line">    <span class="keyword">final</span> CountDownLatch countDownLatch = <span class="keyword">new</span> CountDownLatch(threadSize);</span><br><span class="line">    ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; threadSize; i++) &#123;</span><br><span class="line">        executorService.execute(() -&gt; &#123;</span><br><span class="line">            example.add();</span><br><span class="line">            countDownLatch.countDown();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    countDownLatch.await();</span><br><span class="line">    executorService.shutdown();</span><br><span class="line">    System.out.println(example.get());</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">1000</span></span><br></pre></td></tr></table></figure><p><u><strong>é™¤äº†ä½¿ç”¨åŸå­ç±»ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ synchronized äº’æ–¥é”æ¥ä¿è¯æ“ä½œçš„åŸå­æ€§ã€‚å®ƒå¯¹åº”çš„å†…å­˜é—´äº¤äº’æ“ä½œä¸ºï¼šlock å’Œ unlockï¼Œåœ¨è™šæ‹Ÿæœºå®ç°ä¸Šå¯¹åº”çš„å­—èŠ‚ç æŒ‡ä»¤ä¸º monitorenter å’Œ monitorexitã€‚</strong></u></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AtomicSynchronizedExample</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        cnt++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> threadSize = <span class="number">1000</span>;</span><br><span class="line">    AtomicSynchronizedExample example = <span class="keyword">new</span> AtomicSynchronizedExample();</span><br><span class="line">    <span class="keyword">final</span> CountDownLatch countDownLatch = <span class="keyword">new</span> CountDownLatch(threadSize);</span><br><span class="line">    ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; threadSize; i++) &#123;</span><br><span class="line">        executorService.execute(() -&gt; &#123;</span><br><span class="line">            example.add();</span><br><span class="line">            countDownLatch.countDown();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    countDownLatch.await();</span><br><span class="line">    executorService.shutdown();</span><br><span class="line">    System.out.println(example.get());</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">1000</span></span><br></pre></td></tr></table></figure><h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3><h3 id="2-å¯è§æ€§"><a href="#2-å¯è§æ€§" class="headerlink" title="2. å¯è§æ€§"></a>2. å¯è§æ€§</h3><p>å¯è§æ€§æŒ‡å½“<u><strong>ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼</strong></u>ï¼Œ<u><strong>å…¶å®ƒçº¿ç¨‹èƒ½å¤Ÿç«‹å³å¾—çŸ¥è¿™ä¸ªä¿®æ”¹</strong></u>ã€‚Java å†…å­˜æ¨¡å‹æ˜¯é€šè¿‡åœ¨å˜é‡ä¿®æ”¹åå°†æ–°å€¼åŒæ­¥å›ä¸»å†…å­˜ï¼Œåœ¨å˜é‡è¯»å–å‰ä»ä¸»å†…å­˜åˆ·æ–°å˜é‡å€¼æ¥å®ç°å¯è§æ€§çš„ã€‚</p><p>ä¸»è¦æœ‰ä¸‰ç§å®ç°å¯è§æ€§çš„æ–¹å¼ï¼š</p><ul><li>volatile</li><li>synchronizedï¼Œå¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œ unlock æ“ä½œä¹‹å‰ï¼Œå¿…é¡»æŠŠå˜é‡å€¼åŒæ­¥å›ä¸»å†…å­˜ã€‚</li><li>finalï¼Œè¢« final å…³é”®å­—ä¿®é¥°çš„å­—æ®µåœ¨æ„é€ å™¨ä¸­ä¸€æ—¦åˆå§‹åŒ–å®Œæˆï¼Œå¹¶ä¸”æ²¡æœ‰å‘ç”Ÿ this é€ƒé€¸ï¼ˆå…¶å®ƒçº¿ç¨‹é€šè¿‡ this å¼•ç”¨è®¿é—®åˆ°åˆå§‹åŒ–äº†ä¸€åŠçš„å¯¹è±¡ï¼‰ï¼Œé‚£ä¹ˆå…¶å®ƒçº¿ç¨‹å°±èƒ½çœ‹è§ final å­—æ®µçš„å€¼ã€‚</li></ul><p><u><strong>å¯¹å‰é¢çš„çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹ä¸­çš„ cnt å˜é‡ä½¿ç”¨ volatile ä¿®é¥°ï¼Œä¸èƒ½è§£å†³çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜ï¼Œå› ä¸º volatile å¹¶ä¸èƒ½ä¿è¯æ“ä½œçš„åŸå­æ€§ã€‚</strong></u></p><h3 id="-2"><a href="#-2" class="headerlink" title=""></a></h3><h3 id="3-æœ‰åºæ€§"><a href="#3-æœ‰åºæ€§" class="headerlink" title="3. æœ‰åºæ€§"></a>3. æœ‰åºæ€§</h3><p><strong><u>æœ‰åºæ€§æ˜¯æŒ‡ï¼šåœ¨æœ¬çº¿ç¨‹å†…è§‚å¯Ÿï¼Œæ‰€æœ‰æ“ä½œéƒ½æ˜¯æœ‰åºçš„ã€‚åœ¨ä¸€ä¸ªçº¿ç¨‹è§‚å¯Ÿå¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰æ“ä½œéƒ½æ˜¯æ— åºçš„ï¼Œæ— åºæ˜¯å› ä¸ºå‘ç”Ÿäº†æŒ‡ä»¤é‡æ’åº</u></strong>ã€‚åœ¨ Java å†…å­˜æ¨¡å‹ä¸­ï¼Œå…è®¸ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åºï¼Œé‡æ’åºè¿‡ç¨‹ä¸ä¼šå½±å“åˆ°å•çº¿ç¨‹ç¨‹åºçš„æ‰§è¡Œï¼Œå´ä¼šå½±å“åˆ°å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„æ­£ç¡®æ€§ã€‚</p><p><strong><u>volatile å…³é”®å­—é€šè¿‡æ·»åŠ å†…å­˜å±éšœçš„æ–¹å¼æ¥ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼Œå³é‡æ’åºæ—¶ä¸èƒ½æŠŠåé¢çš„æŒ‡ä»¤æ”¾åˆ°å†…å­˜å±éšœä¹‹å‰ã€‚</u></strong></p><p><strong><u>ä¹Ÿå¯ä»¥é€šè¿‡ synchronized æ¥ä¿è¯æœ‰åºæ€§ï¼Œå®ƒä¿è¯æ¯ä¸ªæ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œç›¸å½“äºæ˜¯è®©çº¿ç¨‹é¡ºåºæ‰§è¡ŒåŒæ­¥ä»£ç ã€‚</u></strong></p><h2 id="å…ˆè¡Œå‘ç”ŸåŸåˆ™"><a href="#å…ˆè¡Œå‘ç”ŸåŸåˆ™" class="headerlink" title="å…ˆè¡Œå‘ç”ŸåŸåˆ™"></a>å…ˆè¡Œå‘ç”ŸåŸåˆ™</h2><p>ä¸Šé¢æåˆ°äº†å¯ä»¥ç”¨ volatile å’Œ synchronized æ¥ä¿è¯æœ‰åºæ€§ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒJVM è¿˜è§„å®šäº†å…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼Œè®©ä¸€ä¸ªæ“ä½œæ— éœ€æ§åˆ¶å°±èƒ½å…ˆäºå¦ä¸€ä¸ªæ“ä½œå®Œæˆã€‚</p><h3 id="-3"><a href="#-3" class="headerlink" title=""></a></h3><h3 id="1-å•ä¸€çº¿ç¨‹åŸåˆ™"><a href="#1-å•ä¸€çº¿ç¨‹åŸåˆ™" class="headerlink" title="1. å•ä¸€çº¿ç¨‹åŸåˆ™"></a>1. å•ä¸€çº¿ç¨‹åŸåˆ™</h3><blockquote><p>Single Thread rule</p></blockquote><p>åœ¨ä¸€ä¸ªçº¿ç¨‹å†…ï¼Œåœ¨ç¨‹åºå‰é¢çš„æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢çš„æ“ä½œã€‚</p><p> <a href="https://camo.githubusercontent.com/e1c3998ce9151df8d6b226e640270efff94df669/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f38373462336666372d376335632d346537612d623861622d6138326133653033386432302e706e67"><img src="https://camo.githubusercontent.com/e1c3998ce9151df8d6b226e640270efff94df669/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f38373462336666372d376335632d346537612d623861622d6138326133653033386432302e706e67" alt="img"></a> </p><h3 id="-4"><a href="#-4" class="headerlink" title=""></a></h3><h3 id="2-ç®¡ç¨‹é”å®šè§„åˆ™"><a href="#2-ç®¡ç¨‹é”å®šè§„åˆ™" class="headerlink" title="2. ç®¡ç¨‹é”å®šè§„åˆ™"></a>2. ç®¡ç¨‹é”å®šè§„åˆ™</h3><blockquote><p>Monitor Lock Rule</p></blockquote><p>ä¸€ä¸ª unlock æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹åŒä¸€ä¸ªé”çš„ lock æ“ä½œã€‚</p><p> <a href="https://camo.githubusercontent.com/c86b5efc7f2ba505380081f0a343e72a862394f0/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f38393936613533372d376334612d346563382d613362372d3765663137393865616532362e706e67"><img src="https://camo.githubusercontent.com/c86b5efc7f2ba505380081f0a343e72a862394f0/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f38393936613533372d376334612d346563382d613362372d3765663137393865616532362e706e67" alt="img"></a> </p><h3 id="-5"><a href="#-5" class="headerlink" title=""></a></h3><h3 id="3-volatile-å˜é‡è§„åˆ™"><a href="#3-volatile-å˜é‡è§„åˆ™" class="headerlink" title="3. volatile å˜é‡è§„åˆ™"></a>3. volatile å˜é‡è§„åˆ™</h3><blockquote><p>Volatile Variable Rule</p></blockquote><p><strong><u>å¯¹ä¸€ä¸ª volatile å˜é‡çš„å†™æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œ</u></strong>ã€‚</p><p> <a href="https://camo.githubusercontent.com/4cba332d162065020d289fbb116e50465ceb0e15/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f39343266333363392d386164392d343938372d383336662d3030376465346332316465302e706e67"><img src="https://camo.githubusercontent.com/4cba332d162065020d289fbb116e50465ceb0e15/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f39343266333363392d386164392d343938372d383336662d3030376465346332316465302e706e67" alt="img"></a> </p><h3 id="-6"><a href="#-6" class="headerlink" title=""></a></h3><h3 id="4-çº¿ç¨‹å¯åŠ¨è§„åˆ™"><a href="#4-çº¿ç¨‹å¯åŠ¨è§„åˆ™" class="headerlink" title="4. çº¿ç¨‹å¯åŠ¨è§„åˆ™"></a>4. çº¿ç¨‹å¯åŠ¨è§„åˆ™</h3><blockquote><p>Thread Start Rule</p></blockquote><p>Thread å¯¹è±¡çš„ start() æ–¹æ³•è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„æ¯ä¸€ä¸ªåŠ¨ä½œã€‚</p><p> <a href="https://camo.githubusercontent.com/6a64fb5055e471c6de4363bee031982bb42200d9/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36323730633231362d376563302d346462372d393464652d3030303362636533376364322e706e67"><img src="https://camo.githubusercontent.com/6a64fb5055e471c6de4363bee031982bb42200d9/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36323730633231362d376563302d346462372d393464652d3030303362636533376364322e706e67" alt="img"></a> </p><h3 id="-7"><a href="#-7" class="headerlink" title=""></a></h3><h3 id="5-çº¿ç¨‹åŠ å…¥è§„åˆ™"><a href="#5-çº¿ç¨‹åŠ å…¥è§„åˆ™" class="headerlink" title="5. çº¿ç¨‹åŠ å…¥è§„åˆ™"></a>5. çº¿ç¨‹åŠ å…¥è§„åˆ™</h3><blockquote><p>Thread Join Rule</p></blockquote><p>Thread å¯¹è±¡çš„ç»“æŸå…ˆè¡Œå‘ç”Ÿäº join() æ–¹æ³•è¿”å›ã€‚</p><p> <a href="https://camo.githubusercontent.com/17e6baed6955e119c1e512d6ceef339002b343e1/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f32333366386438392d333164372d343133662d396330322d3034326631396334366261312e706e67"><img src="https://camo.githubusercontent.com/17e6baed6955e119c1e512d6ceef339002b343e1/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f32333366386438392d333164372d343133662d396330322d3034326631396334366261312e706e67" alt="img"></a> </p><h3 id="-8"><a href="#-8" class="headerlink" title=""></a></h3><h3 id="6-çº¿ç¨‹ä¸­æ–­è§„åˆ™"><a href="#6-çº¿ç¨‹ä¸­æ–­è§„åˆ™" class="headerlink" title="6. çº¿ç¨‹ä¸­æ–­è§„åˆ™"></a>6. çº¿ç¨‹ä¸­æ–­è§„åˆ™</h3><blockquote><p>Thread Interruption Rule</p></blockquote><p>å¯¹çº¿ç¨‹ interrupt() æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯ä»¥é€šè¿‡ interrupted() æ–¹æ³•æ£€æµ‹åˆ°æ˜¯å¦æœ‰ä¸­æ–­å‘ç”Ÿã€‚</p><h3 id="-9"><a href="#-9" class="headerlink" title=""></a></h3><h3 id="7-å¯¹è±¡ç»ˆç»“è§„åˆ™"><a href="#7-å¯¹è±¡ç»ˆç»“è§„åˆ™" class="headerlink" title="7. å¯¹è±¡ç»ˆç»“è§„åˆ™"></a>7. å¯¹è±¡ç»ˆç»“è§„åˆ™</h3><blockquote><p>Finalizer Rule</p></blockquote><p>ä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–å®Œæˆï¼ˆæ„é€ å‡½æ•°æ‰§è¡Œç»“æŸï¼‰å…ˆè¡Œå‘ç”Ÿäºå®ƒçš„ finalize() æ–¹æ³•çš„å¼€å§‹ã€‚</p><h3 id="-10"><a href="#-10" class="headerlink" title=""></a></h3><h3 id="8-ä¼ é€’æ€§"><a href="#8-ä¼ é€’æ€§" class="headerlink" title="8. ä¼ é€’æ€§"></a>8. ä¼ é€’æ€§</h3><blockquote><p>Transitivity</p></blockquote><p>å¦‚æœæ“ä½œ A å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Bï¼Œæ“ä½œ B å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Cï¼Œé‚£ä¹ˆæ“ä½œ A å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Cã€‚</p><h1 id="åä¸€ã€çº¿ç¨‹å®‰å…¨"><a href="#åä¸€ã€çº¿ç¨‹å®‰å…¨" class="headerlink" title="åä¸€ã€çº¿ç¨‹å®‰å…¨"></a>åä¸€ã€çº¿ç¨‹å®‰å…¨</h1><p>å®šä¹‰ï¼š<strong><u>å¤šä¸ªçº¿ç¨‹ä¸ç®¡ä»¥ä½•ç§æ–¹å¼è®¿é—®æŸä¸ªç±»ï¼Œå¹¶ä¸”åœ¨ä¸»è°ƒä»£ç ä¸­ä¸éœ€è¦è¿›è¡ŒåŒæ­¥ï¼Œéƒ½èƒ½è¡¨ç°æ­£ç¡®çš„è¡Œä¸ºã€‚</u></strong></p><p>çº¿ç¨‹å®‰å…¨æœ‰ä»¥ä¸‹å‡ ç§å®ç°æ–¹å¼ï¼š</p><h2 id="ä¸å¯å˜"><a href="#ä¸å¯å˜" class="headerlink" title="ä¸å¯å˜"></a>ä¸å¯å˜</h2><p>ä¸å¯å˜ï¼ˆ<strong>Immutable</strong>ï¼‰çš„å¯¹è±¡<strong><u>ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„</u></strong>ï¼Œä¸éœ€è¦å†é‡‡å–ä»»ä½•çš„çº¿ç¨‹å®‰å…¨ä¿éšœæªæ–½ã€‚åªè¦ä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡è¢«æ­£ç¡®åœ°æ„å»ºå‡ºæ¥ï¼Œæ°¸è¿œä¹Ÿä¸ä¼šçœ‹åˆ°å®ƒåœ¨å¤šä¸ªçº¿ç¨‹ä¹‹ä¸­å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œåº”å½“å°½é‡ä½¿å¯¹è±¡æˆä¸ºä¸å¯å˜ï¼Œæ¥æ»¡è¶³çº¿ç¨‹å®‰å…¨ã€‚</p><p>ä¸å¯å˜çš„ç±»å‹ï¼š</p><ul><li>final å…³é”®å­—ä¿®é¥°çš„åŸºæœ¬æ•°æ®ç±»å‹</li><li>String</li><li>æšä¸¾ç±»å‹</li><li>Number éƒ¨åˆ†å­ç±»ï¼Œå¦‚ Long å’Œ Double ç­‰æ•°å€¼åŒ…è£…ç±»å‹ï¼ŒBigInteger å’Œ BigDecimal ç­‰å¤§æ•°æ®ç±»å‹ã€‚<strong><u>ä½†åŒä¸º Number çš„åŸå­ç±» AtomicInteger å’Œ AtomicLong åˆ™æ˜¯å¯å˜çš„ã€‚</u></strong></li></ul><p>å¯¹äºé›†åˆç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ Collections.unmodifiableXXX() æ–¹æ³•æ¥è·å–ä¸€ä¸ªä¸å¯å˜çš„é›†åˆã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ImmutableExample</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Map&lt;String, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        Map&lt;String, Integer&gt; unmodifiableMap = Collections.unmodifiableMap(map);</span><br><span class="line">        unmodifiableMap.put(<span class="string">"a"</span>, <span class="number">1</span>);<span class="comment">//è¿™é‡Œä¿®æ”¹Mapä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå› ä¸ºunmodifiableMap()æ˜¯å¯¹åŸå§‹çš„é›†åˆçš„æ‹·è´ï¼Œä»»ä½•å¯¹é›†åˆè¿›è¡Œä¿®æ”¹çš„æ–¹æ³•éƒ½ä¼šæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Exception in thread <span class="string">"main"</span> java.lang.UnsupportedOperationException</span><br><span class="line">    at java.util.Collections$UnmodifiableMap.put(Collections.java:<span class="number">1457</span>)</span><br><span class="line">    at ImmutableExample.main(ImmutableExample.java:<span class="number">9</span>)</span><br></pre></td></tr></table></figure><p><strong><u>Collections.unmodifiableXXX() å…ˆå¯¹åŸå§‹çš„é›†åˆè¿›è¡Œæ‹·è´ï¼Œéœ€è¦å¯¹é›†åˆè¿›è¡Œä¿®æ”¹çš„æ–¹æ³•éƒ½ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚</u></strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äº’æ–¥åŒæ­¥"><a href="#äº’æ–¥åŒæ­¥" class="headerlink" title="äº’æ–¥åŒæ­¥"></a>äº’æ–¥åŒæ­¥</h2><p><strong>synchronized</strong> å’Œ <strong>ReentrantLock</strong>ã€‚</p><h2 id="éé˜»å¡åŒæ­¥"><a href="#éé˜»å¡åŒæ­¥" class="headerlink" title="éé˜»å¡åŒæ­¥"></a>éé˜»å¡åŒæ­¥</h2><p>äº’æ–¥åŒæ­¥æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯çº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤è¿™ç§åŒæ­¥ä¹Ÿç§°ä¸ºé˜»å¡åŒæ­¥ã€‚</p><p>äº’æ–¥åŒæ­¥å±äºä¸€ç§æ‚²è§‚çš„å¹¶å‘ç­–ç•¥ï¼Œæ€»æ˜¯è®¤ä¸ºåªè¦ä¸å»åšæ­£ç¡®çš„åŒæ­¥æªæ–½ï¼Œé‚£å°±è‚¯å®šä¼šå‡ºç°é—®é¢˜ã€‚æ— è®ºå…±äº«æ•°æ®æ˜¯å¦çœŸçš„ä¼šå‡ºç°ç«äº‰ï¼Œå®ƒéƒ½è¦è¿›è¡ŒåŠ é”ï¼ˆè¿™é‡Œè®¨è®ºçš„æ˜¯æ¦‚å¿µæ¨¡å‹ï¼Œå®é™…ä¸Šè™šæ‹Ÿæœºä¼šä¼˜åŒ–æ‰å¾ˆå¤§ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„åŠ é”ï¼‰ã€ç”¨æˆ·æ€æ ¸å¿ƒæ€è½¬æ¢ã€ç»´æŠ¤é”è®¡æ•°å™¨å’Œæ£€æŸ¥æ˜¯å¦æœ‰è¢«é˜»å¡çš„çº¿ç¨‹éœ€è¦å”¤é†’ç­‰æ“ä½œã€‚</p><p>éšç€ç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸºäºå†²çªæ£€æµ‹çš„ä¹è§‚å¹¶å‘ç­–ç•¥ï¼šå…ˆè¿›è¡Œæ“ä½œï¼Œå¦‚æœæ²¡æœ‰å…¶å®ƒçº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®ï¼Œé‚£æ“ä½œå°±æˆåŠŸäº†ï¼Œå¦åˆ™é‡‡å–è¡¥å¿æªæ–½ï¼ˆä¸æ–­åœ°é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ï¼‰ã€‚è¿™ç§ä¹è§‚çš„å¹¶å‘ç­–ç•¥çš„è®¸å¤šå®ç°éƒ½ä¸éœ€è¦å°†çº¿ç¨‹é˜»å¡ï¼Œå› æ­¤è¿™ç§åŒæ­¥æ“ä½œç§°ä¸ºéé˜»å¡åŒæ­¥ã€‚</p><h3 id="-11"><a href="#-11" class="headerlink" title=""></a></h3><h3 id="1-CAS"><a href="#1-CAS" class="headerlink" title="1. CAS"></a>1. CAS</h3><p><strong>ä¹è§‚é”</strong>éœ€è¦æ“ä½œå’Œå†²çªæ£€æµ‹è¿™ä¸¤ä¸ªæ­¥éª¤å…·å¤‡åŸå­æ€§ï¼Œè¿™é‡Œå°±ä¸èƒ½å†ä½¿ç”¨äº’æ–¥åŒæ­¥æ¥ä¿è¯äº†ï¼Œåªèƒ½é ç¡¬ä»¶æ¥å®Œæˆã€‚ç¡¬ä»¶æ”¯æŒçš„åŸå­æ€§æ“ä½œæœ€å…¸å‹çš„æ˜¯ï¼šæ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆCompare-and-Swapï¼ŒCASï¼‰ã€‚CAS æŒ‡ä»¤éœ€è¦æœ‰ 3 ä¸ªæ“ä½œæ•°ï¼Œåˆ†åˆ«æ˜¯å†…å­˜åœ°å€ Vã€æ—§çš„é¢„æœŸå€¼ A å’Œæ–°å€¼ Bã€‚å½“æ‰§è¡Œæ“ä½œæ—¶ï¼Œåªæœ‰å½“ V çš„å€¼ç­‰äº Aï¼Œæ‰å°† V çš„å€¼æ›´æ–°ä¸º Bã€‚</p><h3 id="-12"><a href="#-12" class="headerlink" title=""></a></h3><h3 id="2-AtomicInteger"><a href="#2-AtomicInteger" class="headerlink" title="2. AtomicInteger"></a>2. AtomicInteger</h3><p>J.U.C åŒ…é‡Œé¢çš„æ•´æ•°åŸå­ç±» AtomicInteger çš„æ–¹æ³•è°ƒç”¨äº† Unsafe ç±»çš„ CAS æ“ä½œã€‚</p><p>ä»¥ä¸‹ä»£ç ä½¿ç”¨äº† AtomicInteger æ‰§è¡Œäº†è‡ªå¢çš„æ“ä½œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> AtomicInteger cnt = <span class="keyword">new</span> AtomicInteger();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cnt.incrementAndGet();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹ä»£ç æ˜¯ incrementAndGet() çš„æºç ï¼Œå®ƒè°ƒç”¨äº† Unsafe çš„ getAndAddInt() ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">incrementAndGet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> unsafe.getAndAddInt(<span class="keyword">this</span>, valueOffset, <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹ä»£ç æ˜¯ getAndAddInt() æºç ï¼Œvar1 æŒ‡ç¤ºå¯¹è±¡å†…å­˜åœ°å€ï¼Œvar2 æŒ‡ç¤ºè¯¥å­—æ®µç›¸å¯¹å¯¹è±¡å†…å­˜åœ°å€çš„åç§»ï¼Œvar4  æŒ‡ç¤ºæ“ä½œéœ€è¦åŠ çš„æ•°å€¼ï¼Œè¿™é‡Œä¸º 1ã€‚é€šè¿‡ getIntVolatile(var1, var2) å¾—åˆ°æ—§çš„é¢„æœŸå€¼ï¼Œé€šè¿‡è°ƒç”¨  compareAndSwapInt() æ¥è¿›è¡Œ CAS æ¯”è¾ƒï¼Œå¦‚æœè¯¥å­—æ®µå†…å­˜åœ°å€ä¸­çš„å€¼ç­‰äº var5ï¼Œé‚£ä¹ˆå°±æ›´æ–°å†…å­˜åœ°å€ä¸º var1+var2  çš„å˜é‡ä¸º var5+var4ã€‚</p><p>å¯ä»¥çœ‹åˆ° getAndAddInt() åœ¨ä¸€ä¸ªå¾ªç¯ä¸­è¿›è¡Œï¼Œå‘ç”Ÿå†²çªçš„åšæ³•æ˜¯ä¸æ–­çš„è¿›è¡Œé‡è¯•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">getAndAddInt</span><span class="params">(Object var1, <span class="keyword">long</span> var2, <span class="keyword">int</span> var4)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> var5;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        var5 = <span class="keyword">this</span>.getIntVolatile(var1, var2);</span><br><span class="line">    &#125; <span class="keyword">while</span>(!<span class="keyword">this</span>.compareAndSwapInt(var1, var2, var5, var5 + var4));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> var5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="-13"><a href="#-13" class="headerlink" title=""></a></h3><h3 id="3-ABA"><a href="#3-ABA" class="headerlink" title="3. ABA"></a>3. ABA</h3><p><u><strong>å¦‚æœä¸€ä¸ªå˜é‡åˆæ¬¡è¯»å–çš„æ—¶å€™æ˜¯ A å€¼ï¼Œå®ƒçš„å€¼è¢«æ”¹æˆäº† Bï¼Œåæ¥åˆè¢«æ”¹å›ä¸º Aï¼Œé‚£ CAS æ“ä½œå°±ä¼šè¯¯è®¤ä¸ºå®ƒä»æ¥æ²¡æœ‰è¢«æ”¹å˜è¿‡ã€‚</strong></u></p><p>J.U.C åŒ…æä¾›äº†ä¸€ä¸ªå¸¦æœ‰æ ‡è®°çš„åŸå­å¼•ç”¨ç±» AtomicStampedReference  æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå¯ä»¥é€šè¿‡æ§åˆ¶å˜é‡å€¼çš„ç‰ˆæœ¬æ¥ä¿è¯ CAS çš„æ­£ç¡®æ€§ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ ABA é—®é¢˜ä¸ä¼šå½±å“ç¨‹åºå¹¶å‘çš„æ­£ç¡®æ€§ï¼Œå¦‚æœéœ€è¦è§£å†³ ABA  é—®é¢˜ï¼Œæ”¹ç”¨ä¼ ç»Ÿçš„äº’æ–¥åŒæ­¥å¯èƒ½ä¼šæ¯”åŸå­ç±»æ›´é«˜æ•ˆã€‚</p><h2 id="æ— åŒæ­¥æ–¹æ¡ˆ"><a href="#æ— åŒæ­¥æ–¹æ¡ˆ" class="headerlink" title="æ— åŒæ­¥æ–¹æ¡ˆ"></a>æ— åŒæ­¥æ–¹æ¡ˆ</h2><p>è¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸æ˜¯ä¸€å®šå°±è¦è¿›è¡ŒåŒæ­¥ã€‚å¦‚æœä¸€ä¸ªæ–¹æ³•æœ¬æ¥å°±ä¸æ¶‰åŠå…±äº«æ•°æ®ï¼Œé‚£å®ƒè‡ªç„¶å°±æ— é¡»ä»»ä½•åŒæ­¥æªæ–½å»ä¿è¯æ­£ç¡®æ€§ã€‚</p><h3 id="-14"><a href="#-14" class="headerlink" title=""></a></h3><h3 id="1-æ ˆå°é—­"><a href="#1-æ ˆå°é—­" class="headerlink" title="1. æ ˆå°é—­"></a>1. æ ˆå°é—­</h3><p><u><strong>å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªæ–¹æ³•çš„å±€éƒ¨å˜é‡æ—¶ï¼Œä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå› ä¸ºå±€éƒ¨å˜é‡å­˜å‚¨åœ¨è™šæ‹Ÿæœºæ ˆä¸­ï¼Œå±äºçº¿ç¨‹ç§æœ‰çš„ã€‚</strong></u></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StackClosedExample</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add100</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(cnt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    StackClosedExample example = <span class="keyword">new</span> StackClosedExample();</span><br><span class="line">    ExecutorService executorService = Executors.newCachedThreadPool();</span><br><span class="line">    executorService.execute(() -&gt; example.add100());</span><br><span class="line">    executorService.execute(() -&gt; example.add100());</span><br><span class="line">    executorService.shutdown();</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">100</span></span><br><span class="line"><span class="number">100</span></span><br></pre></td></tr></table></figure><h3 id="-15"><a href="#-15" class="headerlink" title=""></a></h3><h3 id="2-çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆThread-Local-Storageï¼‰"><a href="#2-çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆThread-Local-Storageï¼‰" class="headerlink" title="2. çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆThread Local Storageï¼‰"></a>2. çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆThread Local Storageï¼‰</h3><p>å¦‚æœä¸€æ®µä»£ç ä¸­æ‰€éœ€è¦çš„æ•°æ®å¿…é¡»ä¸å…¶ä»–ä»£ç å…±äº«ï¼Œé‚£å°±çœ‹çœ‹è¿™äº›å…±äº«æ•°æ®çš„ä»£ç æ˜¯å¦èƒ½ä¿è¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œã€‚å¦‚æœèƒ½ä¿è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå…±äº«æ•°æ®çš„å¯è§èŒƒå›´é™åˆ¶åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¹‹å†…ï¼Œè¿™æ ·ï¼Œæ— é¡»åŒæ­¥ä¹Ÿèƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´ä¸å‡ºç°æ•°æ®äº‰ç”¨çš„é—®é¢˜ã€‚</p><p>ç¬¦åˆè¿™ç§ç‰¹ç‚¹çš„åº”ç”¨å¹¶ä¸å°‘è§ï¼Œå¤§éƒ¨åˆ†ä½¿ç”¨æ¶ˆè´¹é˜Ÿåˆ—çš„æ¶æ„æ¨¡å¼ï¼ˆå¦‚â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡å¼ï¼‰éƒ½ä¼šå°†äº§å“çš„æ¶ˆè´¹è¿‡ç¨‹å°½é‡åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ¶ˆè´¹å®Œã€‚å…¶ä¸­æœ€é‡è¦çš„ä¸€ä¸ªåº”ç”¨å®ä¾‹å°±æ˜¯ç»å…¸ Web äº¤äº’æ¨¡å‹ä¸­çš„â€œä¸€ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ªæœåŠ¡å™¨çº¿ç¨‹â€ï¼ˆThread-per-Requestï¼‰çš„å¤„ç†æ–¹å¼ï¼Œè¿™ç§å¤„ç†æ–¹å¼çš„å¹¿æ³›åº”ç”¨ä½¿å¾—å¾ˆå¤š Web  æœåŠ¡ç«¯åº”ç”¨éƒ½å¯ä»¥ä½¿ç”¨çº¿ç¨‹æœ¬åœ°å­˜å‚¨æ¥è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p><p>å¯ä»¥ä½¿ç”¨ java.lang.ThreadLocal ç±»æ¥å®ç°çº¿ç¨‹æœ¬åœ°å­˜å‚¨åŠŸèƒ½ã€‚</p><p>å¯¹äºä»¥ä¸‹ä»£ç ï¼Œthread1 ä¸­è®¾ç½® threadLocal ä¸º 1ï¼Œè€Œ thread2 è®¾ç½® threadLocal ä¸º 2ã€‚è¿‡äº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œthread1 è¯»å– threadLocal ä¾ç„¶æ˜¯ 1ï¼Œä¸å— thread2 çš„å½±å“ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadLocalExample</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ThreadLocal threadLocal = <span class="keyword">new</span> ThreadLocal();</span><br><span class="line">        Thread thread1 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            threadLocal.set(<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(threadLocal.get());</span><br><span class="line">            threadLocal.remove();</span><br><span class="line">        &#125;);</span><br><span class="line">        Thread thread2 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            threadLocal.set(<span class="number">2</span>);</span><br><span class="line">            threadLocal.remove();</span><br><span class="line">        &#125;);</span><br><span class="line">        thread1.start();</span><br><span class="line">        thread2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p>ä¸ºäº†ç†è§£ ThreadLocalï¼Œå…ˆçœ‹ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadLocalExample1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ThreadLocal threadLocal1 = <span class="keyword">new</span> ThreadLocal();</span><br><span class="line">        ThreadLocal threadLocal2 = <span class="keyword">new</span> ThreadLocal();</span><br><span class="line">        Thread thread1 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            threadLocal1.set(<span class="number">1</span>);</span><br><span class="line">            threadLocal2.set(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        Thread thread2 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            threadLocal1.set(<span class="number">2</span>);</span><br><span class="line">            threadLocal2.set(<span class="number">2</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        thread1.start();</span><br><span class="line">        thread2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒæ‰€å¯¹åº”çš„åº•å±‚ç»“æ„å›¾ä¸ºï¼š</p><p> <a href="https://camo.githubusercontent.com/8968de525ae8f2712bd1c0c6a5f43a404dc2955c/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36373832363734632d316266652d343837392d616633392d6539643732326139356433392e706e67"><img src="https://camo.githubusercontent.com/8968de525ae8f2712bd1c0c6a5f43a404dc2955c/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36373832363734632d316266652d343837392d616633392d6539643732326139356433392e706e67" alt="img"></a> </p><p>æ¯ä¸ª Thread éƒ½æœ‰ä¸€ä¸ª ThreadLocal.ThreadLocalMap å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ThreadLocal values pertaining to this thread. This map is maintained</span></span><br><span class="line"><span class="comment"> * by the ThreadLocal class. */</span></span><br><span class="line">ThreadLocal.ThreadLocalMap threadLocals = <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure><p>å½“è°ƒç”¨ä¸€ä¸ª ThreadLocal çš„ set(T value) æ–¹æ³•æ—¶ï¼Œå…ˆå¾—åˆ°å½“å‰çº¿ç¨‹çš„ ThreadLocalMap å¯¹è±¡ï¼Œç„¶åå°† ThreadLocal-&gt;value é”®å€¼å¯¹æ’å…¥åˆ°è¯¥ Map ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">    Thread t = Thread.currentThread();</span><br><span class="line">    ThreadLocalMap map = getMap(t);</span><br><span class="line">    <span class="keyword">if</span> (map != <span class="keyword">null</span>)</span><br><span class="line">        map.set(<span class="keyword">this</span>, value);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        createMap(t, value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>get() æ–¹æ³•ç±»ä¼¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Thread t = Thread.currentThread();</span><br><span class="line">    ThreadLocalMap map = getMap(t);</span><br><span class="line">    <span class="keyword">if</span> (map != <span class="keyword">null</span>) &#123;</span><br><span class="line">        ThreadLocalMap.Entry e = map.getEntry(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">            T result = (T)e.value;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> setInitialValue();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ThreadLocal ä»ç†è®ºä¸Šè®²å¹¶ä¸æ˜¯ç”¨æ¥è§£å†³å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜çš„ï¼Œå› ä¸ºæ ¹æœ¬ä¸å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰ã€‚</p><p>åœ¨ä¸€äº›åœºæ™¯ (å°¤å…¶æ˜¯ä½¿ç”¨çº¿ç¨‹æ± ) ä¸‹ï¼Œç”±äº ThreadLocal.ThreadLocalMap çš„åº•å±‚æ•°æ®ç»“æ„å¯¼è‡´  ThreadLocal æœ‰å†…å­˜æ³„æ¼çš„æƒ…å†µï¼Œåº”è¯¥å°½å¯èƒ½åœ¨æ¯æ¬¡ä½¿ç”¨ ThreadLocal åæ‰‹åŠ¨è°ƒç”¨ remove()ï¼Œä»¥é¿å…å‡ºç°  ThreadLocal ç»å…¸çš„å†…å­˜æ³„æ¼ç”šè‡³æ˜¯é€ æˆè‡ªèº«ä¸šåŠ¡æ··ä¹±çš„é£é™©ã€‚</p><h3 id="-16"><a href="#-16" class="headerlink" title=""></a></h3><h3 id="3-å¯é‡å…¥ä»£ç ï¼ˆReentrant-Codeï¼‰"><a href="#3-å¯é‡å…¥ä»£ç ï¼ˆReentrant-Codeï¼‰" class="headerlink" title="3. å¯é‡å…¥ä»£ç ï¼ˆReentrant Codeï¼‰"></a>3. å¯é‡å…¥ä»£ç ï¼ˆReentrant Codeï¼‰</h3><p>è¿™ç§ä»£ç ä¹Ÿå«åšçº¯ä»£ç ï¼ˆPure Codeï¼‰ï¼Œå¯ä»¥åœ¨ä»£ç æ‰§è¡Œçš„ä»»ä½•æ—¶åˆ»ä¸­æ–­å®ƒï¼Œè½¬è€Œå»æ‰§è¡Œå¦å¤–ä¸€æ®µä»£ç ï¼ˆåŒ…æ‹¬é€’å½’è°ƒç”¨å®ƒæœ¬èº«ï¼‰ï¼Œè€Œåœ¨æ§åˆ¶æƒè¿”å›åï¼ŒåŸæ¥çš„ç¨‹åºä¸ä¼šå‡ºç°ä»»ä½•é”™è¯¯ã€‚</p><p>å¯é‡å…¥ä»£ç æœ‰ä¸€äº›å…±åŒçš„ç‰¹å¾ï¼Œä¾‹å¦‚ä¸ä¾èµ–å­˜å‚¨åœ¨å †ä¸Šçš„æ•°æ®å’Œå…¬ç”¨çš„ç³»ç»Ÿèµ„æºã€ç”¨åˆ°çš„çŠ¶æ€é‡éƒ½ç”±å‚æ•°ä¸­ä¼ å…¥ã€ä¸è°ƒç”¨éå¯é‡å…¥çš„æ–¹æ³•ç­‰ã€‚</p><h1 id="åäºŒã€é”ä¼˜åŒ–"><a href="#åäºŒã€é”ä¼˜åŒ–" class="headerlink" title="åäºŒã€é”ä¼˜åŒ–"></a>åäºŒã€é”ä¼˜åŒ–</h1><p>è¿™é‡Œçš„é”ä¼˜åŒ–ä¸»è¦æ˜¯æŒ‡ JVM å¯¹ synchronized çš„ä¼˜åŒ–ã€‚</p><h2 id="è‡ªæ—‹é”"><a href="#è‡ªæ—‹é”" class="headerlink" title="è‡ªæ—‹é”"></a>è‡ªæ—‹é”</h2><p>äº’æ–¥åŒæ­¥è¿›å…¥é˜»å¡çŠ¶æ€çš„å¼€é”€éƒ½å¾ˆå¤§ï¼Œåº”è¯¥å°½é‡é¿å…ã€‚åœ¨è®¸å¤šåº”ç”¨ä¸­ï¼Œå…±äº«æ•°æ®çš„é”å®šçŠ¶æ€åªä¼šæŒç»­å¾ˆçŸ­çš„ä¸€æ®µæ—¶é—´ã€‚è‡ªæ—‹é”çš„æ€æƒ³æ˜¯è®©ä¸€ä¸ªçº¿ç¨‹åœ¨è¯·æ±‚ä¸€ä¸ªå…±äº«æ•°æ®çš„é”æ—¶æ‰§è¡Œå¿™å¾ªç¯ï¼ˆè‡ªæ—‹ï¼‰ä¸€æ®µæ—¶é—´ï¼Œå¦‚æœåœ¨è¿™æ®µæ—¶é—´å†…èƒ½è·å¾—é”ï¼Œå°±å¯ä»¥é¿å…è¿›å…¥é˜»å¡çŠ¶æ€ã€‚</p><p>è‡ªæ—‹é”è™½ç„¶èƒ½é¿å…è¿›å…¥é˜»å¡çŠ¶æ€ä»è€Œå‡å°‘å¼€é”€ï¼Œä½†æ˜¯å®ƒéœ€è¦è¿›è¡Œå¿™å¾ªç¯æ“ä½œå ç”¨ CPU æ—¶é—´ï¼Œå®ƒåªé€‚ç”¨äºå…±äº«æ•°æ®çš„é”å®šçŠ¶æ€å¾ˆçŸ­çš„åœºæ™¯ã€‚</p><p>åœ¨ JDK 1.6 ä¸­å¼•å…¥äº†è‡ªé€‚åº”çš„è‡ªæ—‹é”ã€‚è‡ªé€‚åº”æ„å‘³ç€è‡ªæ—‹çš„æ¬¡æ•°ä¸å†å›ºå®šäº†ï¼Œè€Œæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ¬¡æ•°åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šã€‚</p><h2 id="é”æ¶ˆé™¤"><a href="#é”æ¶ˆé™¤" class="headerlink" title="é”æ¶ˆé™¤"></a>é”æ¶ˆé™¤</h2><p>é”æ¶ˆé™¤æ˜¯æŒ‡å¯¹äºè¢«æ£€æµ‹å‡ºä¸å¯èƒ½å­˜åœ¨ç«äº‰çš„å…±äº«æ•°æ®çš„é”è¿›è¡Œæ¶ˆé™¤ã€‚</p><p>é”æ¶ˆé™¤ä¸»è¦æ˜¯é€šè¿‡é€ƒé€¸åˆ†ææ¥æ”¯æŒï¼Œå¦‚æœå †ä¸Šçš„å…±äº«æ•°æ®ä¸å¯èƒ½é€ƒé€¸å‡ºå»è¢«å…¶å®ƒçº¿ç¨‹è®¿é—®åˆ°ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠå®ƒä»¬å½“æˆç§æœ‰æ•°æ®å¯¹å¾…ï¼Œä¹Ÿå°±å¯ä»¥å°†å®ƒä»¬çš„é”è¿›è¡Œæ¶ˆé™¤ã€‚</p><p>å¯¹äºä¸€äº›çœ‹èµ·æ¥æ²¡æœ‰åŠ é”çš„ä»£ç ï¼Œå…¶å®éšå¼çš„åŠ äº†å¾ˆå¤šé”ã€‚ä¾‹å¦‚ä¸‹é¢çš„å­—ç¬¦ä¸²æ‹¼æ¥ä»£ç å°±éšå¼åŠ äº†é”ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">concatString</span><span class="params">(String s1, String s2, String s3)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s1 + s2 + s3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>String æ˜¯ä¸€ä¸ªä¸å¯å˜çš„ç±»ï¼Œç¼–è¯‘å™¨ä¼šå¯¹ String çš„æ‹¼æ¥è‡ªåŠ¨ä¼˜åŒ–ã€‚åœ¨ JDK 1.5 ä¹‹å‰ï¼Œä¼šè½¬åŒ–ä¸º StringBuffer å¯¹è±¡çš„è¿ç»­ append() æ“ä½œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">concatString</span><span class="params">(String s1, String s2, String s3)</span> </span>&#123;</span><br><span class="line">    StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">    sb.append(s1);</span><br><span class="line">    sb.append(s2);</span><br><span class="line">    sb.append(s3);</span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯ä¸ª append() æ–¹æ³•ä¸­éƒ½æœ‰ä¸€ä¸ªåŒæ­¥å—ã€‚è™šæ‹Ÿæœºè§‚å¯Ÿå˜é‡ sbï¼Œå¾ˆå¿«å°±ä¼šå‘ç°å®ƒçš„åŠ¨æ€ä½œç”¨åŸŸè¢«é™åˆ¶åœ¨ concatString()  æ–¹æ³•å†…éƒ¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œsb çš„æ‰€æœ‰å¼•ç”¨æ°¸è¿œä¸ä¼šé€ƒé€¸åˆ° concatString() æ–¹æ³•ä¹‹å¤–ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®åˆ°å®ƒï¼Œå› æ­¤å¯ä»¥è¿›è¡Œæ¶ˆé™¤ã€‚</p><h2 id="é”ç²—åŒ–"><a href="#é”ç²—åŒ–" class="headerlink" title="é”ç²—åŒ–"></a>é”ç²—åŒ–</h2><p>å¦‚æœä¸€ç³»åˆ—çš„è¿ç»­æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åå¤åŠ é”å’Œè§£é”ï¼Œé¢‘ç¹çš„åŠ é”æ“ä½œå°±ä¼šå¯¼è‡´æ€§èƒ½æŸè€—ã€‚</p><p>ä¸Šä¸€èŠ‚çš„ç¤ºä¾‹ä»£ç ä¸­è¿ç»­çš„ append()  æ–¹æ³•å°±å±äºè¿™ç±»æƒ…å†µã€‚å¦‚æœè™šæ‹Ÿæœºæ¢æµ‹åˆ°ç”±è¿™æ ·çš„ä¸€ä¸²é›¶ç¢çš„æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åŠ é”ï¼Œå°†ä¼šæŠŠåŠ é”çš„èŒƒå›´æ‰©å±•ï¼ˆç²—åŒ–ï¼‰åˆ°æ•´ä¸ªæ“ä½œåºåˆ—çš„å¤–éƒ¨ã€‚å¯¹äºä¸Šä¸€èŠ‚çš„ç¤ºä¾‹ä»£ç å°±æ˜¯æ‰©å±•åˆ°ç¬¬ä¸€ä¸ª append() æ“ä½œä¹‹å‰ç›´è‡³æœ€åä¸€ä¸ª append() æ“ä½œä¹‹åï¼Œè¿™æ ·åªéœ€è¦åŠ é”ä¸€æ¬¡å°±å¯ä»¥äº†ã€‚</p><h2 id="è½»é‡çº§é”"><a href="#è½»é‡çº§é”" class="headerlink" title="è½»é‡çº§é”"></a>è½»é‡çº§é”</h2><p>JDK 1.6 å¼•å…¥äº†åå‘é”å’Œè½»é‡çº§é”ï¼Œä»è€Œè®©é”æ‹¥æœ‰äº†å››ä¸ªçŠ¶æ€ï¼šæ— é”çŠ¶æ€ï¼ˆunlockedï¼‰ã€åå‘é”çŠ¶æ€ï¼ˆbiasbleï¼‰ã€è½»é‡çº§é”çŠ¶æ€ï¼ˆlightweight lockedï¼‰å’Œé‡é‡çº§é”çŠ¶æ€ï¼ˆinflatedï¼‰ã€‚</p><p>ä»¥ä¸‹æ˜¯ HotSpot è™šæ‹Ÿæœºå¯¹è±¡å¤´çš„å†…å­˜å¸ƒå±€ï¼Œè¿™äº›æ•°æ®è¢«ç§°ä¸º Mark Wordã€‚å…¶ä¸­ tag bits å¯¹åº”äº†äº”ä¸ªçŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€åœ¨å³ä¾§çš„ state è¡¨æ ¼ä¸­ç»™å‡ºã€‚é™¤äº† marked for gc çŠ¶æ€ï¼Œå…¶å®ƒå››ä¸ªçŠ¶æ€å·²ç»åœ¨å‰é¢ä»‹ç»è¿‡äº†ã€‚</p><p> <a href="https://camo.githubusercontent.com/deab9b2c52091554cc095249fd7a97fc1ca41521/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f62623661343962652d303066322d346632372d613063652d3465643736346263363035632e706e67"><img src="https://camo.githubusercontent.com/deab9b2c52091554cc095249fd7a97fc1ca41521/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f62623661343962652d303066322d346632372d613063652d3465643736346263363035632e706e67" alt="img"></a> </p><p>ä¸‹å›¾å·¦ä¾§æ˜¯ä¸€ä¸ªçº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆï¼Œå…¶ä¸­æœ‰ä¸€éƒ¨åˆ†ç§°ä¸º Lock Record çš„åŒºåŸŸï¼Œè¿™æ˜¯åœ¨è½»é‡çº§é”è¿è¡Œè¿‡ç¨‹åˆ›å»ºçš„ï¼Œç”¨äºå­˜æ”¾é”å¯¹è±¡çš„ Mark Wordã€‚è€Œå³ä¾§å°±æ˜¯ä¸€ä¸ªé”å¯¹è±¡ï¼ŒåŒ…å«äº† Mark Word å’Œå…¶å®ƒä¿¡æ¯ã€‚</p><p> <a href="https://camo.githubusercontent.com/c1a0307ca4be2bc4b5a3492c634553b4255759bd/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f30353165343336632d306534362d346335392d386636372d3532643839643635363138322e706e67"><img src="https://camo.githubusercontent.com/c1a0307ca4be2bc4b5a3492c634553b4255759bd/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f30353165343336632d306534362d346335392d386636372d3532643839643635363138322e706e67" alt="img"></a> </p><p>è½»é‡çº§é”æ˜¯ç›¸å¯¹äºä¼ ç»Ÿçš„é‡é‡çº§é”è€Œè¨€ï¼Œå®ƒä½¿ç”¨ CAS æ“ä½œæ¥é¿å…é‡é‡çº§é”ä½¿ç”¨äº’æ–¥é‡çš„å¼€é”€ã€‚å¯¹äºç»å¤§éƒ¨åˆ†çš„é”ï¼Œåœ¨æ•´ä¸ªåŒæ­¥å‘¨æœŸå†…éƒ½æ˜¯ä¸å­˜åœ¨ç«äº‰çš„ï¼Œå› æ­¤ä¹Ÿå°±ä¸éœ€è¦éƒ½ä½¿ç”¨äº’æ–¥é‡è¿›è¡ŒåŒæ­¥ï¼Œå¯ä»¥å…ˆé‡‡ç”¨ CAS æ“ä½œè¿›è¡ŒåŒæ­¥ï¼Œå¦‚æœ CAS å¤±è´¥äº†å†æ”¹ç”¨äº’æ–¥é‡è¿›è¡ŒåŒæ­¥ã€‚</p><p>å½“å°è¯•è·å–ä¸€ä¸ªé”å¯¹è±¡æ—¶ï¼Œå¦‚æœé”å¯¹è±¡æ ‡è®°ä¸º 0 01ï¼Œè¯´æ˜é”å¯¹è±¡çš„é”æœªé”å®šï¼ˆunlockedï¼‰çŠ¶æ€ã€‚æ­¤æ—¶è™šæ‹Ÿæœºåœ¨å½“å‰çº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆä¸­åˆ›å»º  Lock Recordï¼Œç„¶åä½¿ç”¨ CAS æ“ä½œå°†å¯¹è±¡çš„ Mark Word æ›´æ–°ä¸º Lock Record æŒ‡é’ˆã€‚å¦‚æœ CAS  æ“ä½œæˆåŠŸäº†ï¼Œé‚£ä¹ˆçº¿ç¨‹å°±è·å–äº†è¯¥å¯¹è±¡ä¸Šçš„é”ï¼Œå¹¶ä¸”å¯¹è±¡çš„ Mark Word çš„é”æ ‡è®°å˜ä¸º 00ï¼Œè¡¨ç¤ºè¯¥å¯¹è±¡å¤„äºè½»é‡çº§é”çŠ¶æ€ã€‚</p><p> <a href="https://camo.githubusercontent.com/740f6e8b42fda5eaca9b83b919a1729059653705/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f62616161363831662d376335322d343139382d613561652d3330336239333836636634372e706e67"><img src="https://camo.githubusercontent.com/740f6e8b42fda5eaca9b83b919a1729059653705/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f62616161363831662d376335322d343139382d613561652d3330336239333836636634372e706e67" alt="img"></a> </p><p>å¦‚æœ CAS æ“ä½œå¤±è´¥äº†ï¼Œè™šæ‹Ÿæœºé¦–å…ˆä¼šæ£€æŸ¥å¯¹è±¡çš„ Mark Word  æ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆï¼Œå¦‚æœæ˜¯çš„è¯è¯´æ˜å½“å‰çº¿ç¨‹å·²ç»æ‹¥æœ‰äº†è¿™ä¸ªé”å¯¹è±¡ï¼Œé‚£å°±å¯ä»¥ç›´æ¥è¿›å…¥åŒæ­¥å—ç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™è¯´æ˜è¿™ä¸ªé”å¯¹è±¡å·²ç»è¢«å…¶ä»–çº¿ç¨‹çº¿ç¨‹æŠ¢å äº†ã€‚å¦‚æœæœ‰ä¸¤æ¡ä»¥ä¸Šçš„çº¿ç¨‹äº‰ç”¨åŒä¸€ä¸ªé”ï¼Œé‚£è½»é‡çº§é”å°±ä¸å†æœ‰æ•ˆï¼Œè¦è†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚</p><h2 id="åå‘é”"><a href="#åå‘é”" class="headerlink" title="åå‘é”"></a>åå‘é”</h2><p>åå‘é”çš„æ€æƒ³æ˜¯åå‘äºè®©ç¬¬ä¸€ä¸ªè·å–é”å¯¹è±¡çš„çº¿ç¨‹ï¼Œè¿™ä¸ªçº¿ç¨‹åœ¨ä¹‹åè·å–è¯¥é”å°±ä¸å†éœ€è¦è¿›è¡ŒåŒæ­¥æ“ä½œï¼Œç”šè‡³è¿ CAS æ“ä½œä¹Ÿä¸å†éœ€è¦ã€‚</p><p>å½“é”å¯¹è±¡ç¬¬ä¸€æ¬¡è¢«çº¿ç¨‹è·å¾—çš„æ—¶å€™ï¼Œè¿›å…¥åå‘çŠ¶æ€ï¼Œæ ‡è®°ä¸º 1 01ã€‚åŒæ—¶ä½¿ç”¨ CAS æ“ä½œå°†çº¿ç¨‹ ID è®°å½•åˆ° Mark Word ä¸­ï¼Œå¦‚æœ CAS æ“ä½œæˆåŠŸï¼Œè¿™ä¸ªçº¿ç¨‹ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥å—å°±ä¸éœ€è¦å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œã€‚</p><p>å½“æœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹å»å°è¯•è·å–è¿™ä¸ªé”å¯¹è±¡æ—¶ï¼Œåå‘çŠ¶æ€å°±å®£å‘Šç»“æŸï¼Œæ­¤æ—¶æ’¤é”€åå‘ï¼ˆRevoke Biasï¼‰åæ¢å¤åˆ°æœªé”å®šçŠ¶æ€æˆ–è€…è½»é‡çº§é”çŠ¶æ€ã€‚</p><p> <a href="https://camo.githubusercontent.com/8369c6bebffb9617694168381f5d7a62bb099e62/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f33393063393133622d356633312d343434662d626264622d3262383862363838653763652e6a7067"><img src="https://camo.githubusercontent.com/8369c6bebffb9617694168381f5d7a62bb099e62/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f33393063393133622d356633312d343434662d626264622d3262383862363838653763652e6a7067" alt="img"></a> </p><h1 id="åä¸‰ã€å¤šçº¿ç¨‹å¼€å‘è‰¯å¥½çš„å®è·µ"><a href="#åä¸‰ã€å¤šçº¿ç¨‹å¼€å‘è‰¯å¥½çš„å®è·µ" class="headerlink" title="åä¸‰ã€å¤šçº¿ç¨‹å¼€å‘è‰¯å¥½çš„å®è·µ"></a>åä¸‰ã€å¤šçº¿ç¨‹å¼€å‘è‰¯å¥½çš„å®è·µ</h1><ul><li>ç»™çº¿ç¨‹èµ·ä¸ªæœ‰æ„ä¹‰çš„åå­—ï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿æ‰¾ Bugã€‚</li><li>ç¼©å°åŒæ­¥èŒƒå›´ï¼Œä»è€Œå‡å°‘é”äº‰ç”¨ã€‚ä¾‹å¦‚å¯¹äº synchronizedï¼Œåº”è¯¥å°½é‡ä½¿ç”¨åŒæ­¥å—è€Œä¸æ˜¯åŒæ­¥æ–¹æ³•ã€‚</li><li>å¤šç”¨åŒæ­¥å·¥å…·å°‘ç”¨ wait() å’Œ notify()ã€‚é¦–å…ˆï¼ŒCountDownLatch, CyclicBarrier,  Semaphore å’Œ Exchanger è¿™äº›åŒæ­¥ç±»ç®€åŒ–äº†ç¼–ç æ“ä½œï¼Œè€Œç”¨ wait() å’Œ notify()  å¾ˆéš¾å®ç°å¤æ‚æ§åˆ¶æµï¼›å…¶æ¬¡ï¼Œè¿™äº›åŒæ­¥ç±»æ˜¯ç”±æœ€å¥½çš„ä¼ä¸šç¼–å†™å’Œç»´æŠ¤ï¼Œåœ¨åç»­çš„ JDK ä¸­è¿˜ä¼šä¸æ–­ä¼˜åŒ–å’Œå®Œå–„ã€‚</li><li>ä½¿ç”¨ BlockingQueue å®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ã€‚</li><li>å¤šç”¨å¹¶å‘é›†åˆå°‘ç”¨åŒæ­¥é›†åˆï¼Œä¾‹å¦‚åº”è¯¥ä½¿ç”¨ ConcurrentHashMap è€Œä¸æ˜¯ Hashtableã€‚</li><li>ä½¿ç”¨æœ¬åœ°å˜é‡å’Œä¸å¯å˜ç±»æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</li><li>ä½¿ç”¨çº¿ç¨‹æ± è€Œä¸æ˜¯ç›´æ¥åˆ›å»ºçº¿ç¨‹ï¼Œè¿™æ˜¯å› ä¸ºåˆ›å»ºçº¿ç¨‹ä»£ä»·å¾ˆé«˜ï¼Œçº¿ç¨‹æ± å¯ä»¥æœ‰æ•ˆåœ°åˆ©ç”¨æœ‰é™çš„çº¿ç¨‹æ¥å¯åŠ¨ä»»åŠ¡ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Java-Concurrency&quot;&gt;&lt;a href=&quot;#Java-Concurrency&quot; class=&quot;headerlink&quot; title=&quot;Java Concurrency&quot;&gt;&lt;/a&gt;Java Concurrency&lt;/h1&gt;&lt;p&gt;This article is from &lt;a href=&quot;https://github.com/CyC2018/CS-Notes/blob/master/notes/Java%20%E5%B9%B6%E5%8F%91.md#countdownlatch&quot;&gt;here&lt;/a&gt; and I made some notes on it to review java concurrency.&lt;/p&gt;
&lt;p&gt;If itâ€™s inappropriate to do so, contact me to delete this post.&lt;/p&gt;
&lt;h1 id=&quot;ä¸€ã€ä½¿ç”¨çº¿ç¨‹&quot;&gt;&lt;a href=&quot;#ä¸€ã€ä½¿ç”¨çº¿ç¨‹&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€ä½¿ç”¨çº¿ç¨‹&quot;&gt;&lt;/a&gt;ä¸€ã€ä½¿ç”¨çº¿ç¨‹&lt;/h1&gt;&lt;p&gt;æœ‰&lt;u&gt;&lt;strong&gt;ä¸‰ç§&lt;/strong&gt;&lt;/u&gt;ä½¿ç”¨çº¿ç¨‹çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®ç° Runnable æ¥å£ï¼›&lt;/li&gt;
&lt;li&gt;å®ç° Callable æ¥å£ï¼›&lt;/li&gt;
&lt;li&gt;ç»§æ‰¿ Thread ç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="java" scheme="http://yifanzhang13.github.io/categories/java/"/>
    
    
      <category term="concurrency" scheme="http://yifanzhang13.github.io/tags/concurrency/"/>
    
  </entry>
  
  <entry>
    <title>COMP0141 Security</title>
    <link href="http://yifanzhang13.github.io/2020/04/08/COMP0141-Security/"/>
    <id>http://yifanzhang13.github.io/2020/04/08/COMP0141-Security/</id>
    <published>2020-04-08T00:27:16.000Z</published>
    <updated>2020-06-10T09:34:15.710Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Lecture-1-1"><a href="#Lecture-1-1" class="headerlink" title="Lecture 1-1"></a>Lecture 1-1</h1><h2 id="CIA-Triangle"><a href="#CIA-Triangle" class="headerlink" title="CIA Triangle"></a>CIA Triangle</h2><ul><li>Components<ul><li><strong>Confidentiality</strong>: Keeping Data private, only authorized users and processes should be able to access or modify data</li><li><strong>Integrity</strong>: System and data have not been improperly altered, data should be maintained in a correct state and nobody should be able  to improperly modify it, either accidentally or maliciously</li><li><strong>Availability</strong>: The ability to use the system as anticipated</li></ul></li></ul><a id="more"></a><h2 id="Security-Design"><a href="#Security-Design" class="headerlink" title="Security Design"></a>Security Design</h2><ul><li>How to define a secure system?<ul><li>Secure physical facility</li><li>Contactless payment protocol</li><li>Online database</li><li>Private online communication</li></ul></li><li>We need a specified security policy to define a secure system, how to define a security policy?</li><li>What should Policy address?<ul><li><u><strong>Threat Model</strong></u><ul><li>Threats (Attacker-centric)</li><li>Vulnerabilities (System-centric)</li><li>Likelihood</li><li>Impact (Asset-centric)</li><li>Protection  (Cost) </li></ul></li></ul></li><li>Security Policy is a type of <strong>risk assessment</strong></li><li><strong>Threats (Who is the adversary?)</strong><ul><li>Consider adversary across 2 dimensions:<ul><li><strong>Capabilities</strong>: Who are they?</li><li><strong>Motivation</strong>: Why do they do it?</li></ul></li></ul></li><li><strong>Vulnerabilities (where can system break?)</strong><ul><li>Define vulnerabilities with respect to threats</li><li>Threat v.s. Vulnerabilities<ul><li>If there is a water pool, threat is water may overflow, vulnerability may be a crack of the pool</li></ul></li></ul></li><li><strong>Likelihood (might this happen?)</strong><ul><li>Define likelihood with respect to vulnerabilities </li><li>Vulnerability vs. Likelihood<ul><li>Zero if we never add water</li></ul></li></ul></li><li><strong>Impact (what if bad things happen?)</strong><ul><li>Define impact with respect to threat</li><li>Threat? Water might overflow. Impact? Depends on whatâ€™s nearby.</li></ul></li><li><strong>Protection (what does it cost?)</strong><ul><li>most of academic computer security is <strong>protection</strong></li></ul></li></ul><h2 id="Competing-Philosophies"><a href="#Competing-Philosophies" class="headerlink" title="Competing Philosophies"></a>Competing Philosophies</h2><ul><li>Binary Model<ul><li>Secure or Insecure<ul><li>Binary Model is <strong>longevity</strong> but also <strong>brittle</strong> and <strong>expensive</strong></li></ul></li></ul></li><li>Risk Management Model<ul><li>It minimise the biggest threats and focus on the <strong>cost</strong></li><li>It is <strong>adaptive</strong> but the solutions are usually quite reactive so lead to <strong>Arms Race</strong></li></ul></li></ul><h2 id="Is-the-System-Secure"><a href="#Is-the-System-Secure" class="headerlink" title="Is the System Secure?"></a>Is the System Secure?</h2><p><code>Security is not an absolute property, depends on having a good threat model that captures a range of adversarial behaviours</code></p><h2 id="Security-Mechanism"><a href="#Security-Mechanism" class="headerlink" title="Security Mechanism"></a>Security Mechanism</h2><blockquote><p>A system is â€œsecureâ€ if there is a security argument that an adversary constrained by a <strong>specific threat model</strong> cannot violate the <strong>security policy</strong></p><p><strong>Security argument</strong>: rigorous argument that the security mechanisms are maintaining the security policy (subject to the assumptions of the threat model)</p><p><strong>Security mechanism</strong>: Technical mechanism used to ensure that the security policy is not violated by an adversary operating within the threat model</p></blockquote><h1 id="Lecture-1-2"><a href="#Lecture-1-2" class="headerlink" title="Lecture 1-2"></a>Lecture 1-2</h1><h2 id="Security-and-Human-Behavior"><a href="#Security-and-Human-Behavior" class="headerlink" title="Security and Human Behavior"></a>Security and Human Behavior</h2><h3 id="Information-Security"><a href="#Information-Security" class="headerlink" title="Information Security"></a>Information Security</h3><blockquote><p><strong>Digital Security</strong>: E.g. Files and web-access to servers</p><p><strong>Physical Security</strong>: Files can be printed and stored on USB storage device and servers can be in a locked room</p></blockquote><h3 id="Availability-further-definitions"><a href="#Availability-further-definitions" class="headerlink" title="Availability - further definitions"></a>Availability - further definitions</h3><blockquote><p><strong>Availbility</strong> is â€œthe property of a system or a system resource being uable/ upon demandâ€</p><p>If availability is a requirement, <strong>an unusable system cannot be</strong> <strong>regarded as secure</strong></p></blockquote><h3 id="Usability"><a href="#Usability" class="headerlink" title="Usability"></a>Usability</h3><blockquote><p>Considering what a person (a â€˜userâ€™) wants to achieve (their â€˜primary taskâ€™ toward an <em>outcome</em>) provides an approximation of the <em>context of use</em></p></blockquote><h2 id="Risk-Analysis-and-Risk-Perception"><a href="#Risk-Analysis-and-Risk-Perception" class="headerlink" title="Risk Analysis and Risk Perception"></a>Risk Analysis and Risk Perception</h2><h3 id="Security-Theatre"><a href="#Security-Theatre" class="headerlink" title="Security Theatre"></a>Security Theatre</h3><blockquote><p>Aim of security measures is not always to increase <em>actual</em> security</p><p><strong>Security Theatre</strong>: When the purpose of a security measure is to increase <em>perceived</em>, rather than actual, security</p></blockquote><h1 id="Lecture-2-1"><a href="#Lecture-2-1" class="headerlink" title="Lecture 2-1"></a>Lecture 2-1</h1><h2 id="Security-Mechanism-1"><a href="#Security-Mechanism-1" class="headerlink" title="Security Mechanism"></a>Security Mechanism</h2><blockquote><p><strong>Security mechanism</strong>: Technical mechanism used to ensure that the security policy is not violated by an adversary <u>operating within the threat model</u></p></blockquote><p>Could be <strong>software, hardware, cryptography, or peoples and procedures</strong> â€” this is why weâ€™ll learn about all of these!</p><h2 id="Design-Principles"><a href="#Design-Principles" class="headerlink" title="Design Principles"></a>Design Principles</h2><h3 id="Least-privilege"><a href="#Least-privilege" class="headerlink" title="Least privilege"></a><strong>Least privilege</strong></h3><blockquote><p>The <strong>principle</strong> of <strong>least privilege</strong> works by allowing only enough access to perform the required job. In an IT environment, adhering to the <strong>principle</strong> of <strong>least privilege</strong> reduces the risk of attackers gaining access to critical systems or  sensitive data by compromising a low-level user account, device, or  application.</p></blockquote><h3 id="Separation-of-responsibilities"><a href="#Separation-of-responsibilities" class="headerlink" title="Separation of responsibilities"></a><strong>Separation of responsibilities</strong></h3><blockquote><p>E.g. For the system maintenance, there will be database admin, antivirus manager, and front-end engineer. </p><p>Everyone or every section of the system takes responsibility</p></blockquote><h3 id="Complete-mediation"><a href="#Complete-mediation" class="headerlink" title="Complete mediation"></a><strong>Complete mediation</strong></h3><blockquote><p>The <strong>principle</strong> of <strong>complete mediation</strong> requires that all accesses to objects be checked to ensure that they  are allowed. Whenever a subject attempts to read an object, the  operating system should <strong>mediate</strong> the action.</p></blockquote><h3 id="Fail-safe-default"><a href="#Fail-safe-default" class="headerlink" title="Fail-safe default"></a><strong>Fail-safe default</strong></h3><blockquote><p>The <strong>principle</strong> of <strong>fail</strong>-<strong>safe defaults</strong> states that, unless a subject is given explicit access to an object, it should be denied access to that object. This <strong>principle</strong> requires that the <strong>default</strong> access to an object is none.</p></blockquote><h3 id="Defence-in-Depth"><a href="#Defence-in-Depth" class="headerlink" title="Defence in Depth"></a><strong>Defence in Depth</strong></h3><blockquote><p><strong>Defense in depth</strong> defined. <strong>Defense in Depth</strong> (DiD) is an approach to cybersecurity in which a series of defensive  mechanisms are layered in order to protect valuable data and  information. If one mechanism fails, another steps up immediately to  thwart an attack.</p></blockquote><h3 id="Open-Design"><a href="#Open-Design" class="headerlink" title="Open Design"></a>Open Design</h3><blockquote><p>The <strong>principle</strong> of <strong>open design</strong> states that the security of a mechanism should not depend on the secrecy of its <strong>design</strong> or implementation. Designers and implementers of a program must not depend on secrecy of the details of their <strong>design</strong> and implementation to ensure security.</p></blockquote><h3 id="Psychological-Acceptability"><a href="#Psychological-Acceptability" class="headerlink" title="Psychological Acceptability"></a>Psychological Acceptability</h3><blockquote><p>The <strong>principle</strong> of <strong>psychological acceptability</strong> states that security mechanisms should not make the resource more  difficult to access than if the security mechanisms were not present.  Configuring and executing a program should be as easy and as intuitive  as possible, and any output should be clear, direct, and useful.</p></blockquote><h3 id="Economy-of-Mechanisms"><a href="#Economy-of-Mechanisms" class="headerlink" title="Economy of Mechanisms"></a>Economy of Mechanisms</h3><blockquote><p>KISS Principle: Keep it simple, stupid!</p><p>The <strong>principle</strong> of <strong>economy of mechanism</strong> states that security <strong>mechanisms</strong> should be as simple as possible. If a <strong>design</strong> and implementation are simple, fewer possibilities exist for errors.  The checking and testing process is less complex, because fewer  components and cases need to be tested.</p></blockquote><h3 id="Privacy-Promotion"><a href="#Privacy-Promotion" class="headerlink" title="Privacy Promotion"></a>Privacy Promotion</h3><blockquote><p>Donâ€™t collect more data than strictly necessary</p></blockquote><h2 id="Fundamentals-of-Computer-Architecture-Design"><a href="#Fundamentals-of-Computer-Architecture-Design" class="headerlink" title="Fundamentals of Computer Architecture Design"></a>Fundamentals of Computer Architecture Design</h2><ul><li>Code is data</li><li>Layers of abstraction</li><li>Mooreâ€™s law</li><li>Halting problem</li></ul><h3 id="von-Neumann-Computer-Architecture"><a href="#von-Neumann-Computer-Architecture" class="headerlink" title="von Neumann Computer Architecture"></a>von Neumann Computer Architecture</h3><ul><li>von Neumann computer architecture does not distinguish between instructions for computer programs and data</li><li>Consequently, <strong>Code is data</strong><ul><li>Enables great flexibility in reprogramming computers</li><li>Programs can be costlessly reproduced, not just data</li></ul></li><li>There are unfortunate security implications</li></ul><h3 id="Layers-of-Abstraction"><a href="#Layers-of-Abstraction" class="headerlink" title="Layers of Abstraction"></a>Layers of Abstraction</h3><ul><li><p><strong>Abstraction:</strong> specifying meaning and behaviour of software while hiding implementation details</p></li><li><p><strong>Modular code</strong> exploits abstraction and enables composition and reuse</p></li><li><p>Abstraction and code modularity enables rapid software development (which has in turn led to a rapid rise in software complexity)</p></li><li><p>Unlike for mechanical engineering, in software engineering there is no practical limit to the potential combinations of code</p></li></ul><h3 id="Mooreâ€™s-Law"><a href="#Mooreâ€™s-Law" class="headerlink" title="Mooreâ€™s Law"></a>Mooreâ€™s Law</h3><ul><li><p>Intel founder Gordon Moore noticed in 1965 that integrated circuit density had been doubling since the 1950s</p></li><li><p>Mooreâ€™s Law: computer performance roughly doubles every 18-24 months</p></li></ul><h3 id="Halting-Problem"><a href="#Halting-Problem" class="headerlink" title="Halting Problem"></a>Halting Problem</h3><ul><li>In 1936, Alan Turing proved that it is impossible to write a general- purpose program that can determine whether another program will stop</li><li>Can be generalised: anything sufficiently interesting cannot be determined about a program</li><li>Implication: Security can never be solved!</li></ul><h1 id="Lecture-2-2"><a href="#Lecture-2-2" class="headerlink" title="Lecture 2-2"></a>Lecture 2-2</h1><h2 id="How-does-the-Internet-work"><a href="#How-does-the-Internet-work" class="headerlink" title="How does the Internet work?"></a>How does the Internet work?</h2><ul><li><a href="http://me.bob.com/hi.html">http://me.bob.com/hi.html</a><ul><li><code>http:</code>: protocol specifier</li><li><code>me.bob.com</code>: domain name</li><li><code>hi.html</code>: page location</li></ul></li></ul><h3 id="Step1-find-content-host"><a href="#Step1-find-content-host" class="headerlink" title="Step1: find content host"></a>Step1: find content host</h3><p>Goal: get <strong>IP address</strong> for <code>domain name</code> </p><ol><li>Find root Name Server</li><li>Find <code>.com</code> Name Server</li><li>Send ip(.com NS)</li><li>Get ip(bob.com NS) </li><li>Find bob.com NS</li><li>Send ip(bob.com NS)</li><li>Get ip(me.bob.com NS)</li><li>Find me.bob.com NS</li><li>Send ip(me.bob.com NS)</li><li>Get ip(me.bob.com)</li><li>Send back to the browser</li></ol><h3 id="Step-2-request-content"><a href="#Step-2-request-content" class="headerlink" title="Step 2: request content"></a>Step 2: request content</h3><ul><li><p>Where is the Internet?</p><ul><li>â€œthe Internet is [â€¦] a series of tubesâ€ (Senator Ted Stevens)</li><li><strong>Leased Lines</strong><ul><li>pros<ul><li>incredibly fast</li><li>reliable</li><li>secure</li></ul></li><li>cons<ul><li>Incredibly expensive</li></ul></li></ul></li><li>Internet Backbone</li></ul></li><li><p><strong>q</strong>: how does your router pick another router to ask?</p><p><strong>a</strong>: fascinating topic! autonomous systems (ASes), BGP, etc.</p></li><li><p><strong>q</strong>: how do you actually find these name servers? </p><p><strong>a</strong>: the magic of <strong>routing</strong>!</p></li><li><p><strong>q</strong>: what information are these routers sending? </p><p><strong>a</strong>: <strong>packets</strong>.</p></li><li><p><strong>q</strong>: could requests just go around in a circle?</p><p><strong>a</strong>: no! packets contain information on when to give up. Time to live (TTL): how many hops before dying?</p><p>(decremented by each router; also used for DNS records)</p></li><li><p>Proxy Server and VPNs</p><ul><li>pros<ul><li>get around firewalls </li><li>borrow access credentials</li></ul></li></ul></li></ul><h3 id="Step3-Receive-Content"><a href="#Step3-Receive-Content" class="headerlink" title="Step3: Receive Content"></a>Step3: Receive Content</h3><ul><li>Content at hi.html is split into packets</li><li>Anyone can read the web traffic</li></ul><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><ol><li>goal: get Alice to that website!</li><li>get IP address for me.bob.com (â€œdomain name resolutionâ€)</li><li>send GET request to IP address (routing via the internet backbone)</li><li>wait for response from IP address, then render hi.html and enjoy</li></ol><h2 id="What-Webpages-are-Made-Of"><a href="#What-Webpages-are-Made-Of" class="headerlink" title="What Webpages are Made Of"></a>What Webpages are Made Of</h2><h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><ul><li>Markup language</li><li>HTML5 added interactive components:<ul><li>Canvas </li><li>Audio</li><li>Video</li></ul></li></ul><h3 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h3><ul><li>Style language</li><li>Built to separate content from style</li><li>CSS3 â€” built in tandem with HTML5</li></ul><h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h3><ul><li>Scripting language (similar to Python) â€¢ Server side (NodeJS)</li><li>Client side</li><li>Stateless</li></ul><h2 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h2><ul><li>Used to store state on userâ€™s machine</li><li>Name, value, attributes: â€¢ expiration date</li><li>hostname valid for</li><li>Secure (?)<ul><li>only over HTTPS </li><li>HTTPOnly (?)</li><li>not over JavaScript</li></ul></li></ul><h1 id="Lecture-3-1"><a href="#Lecture-3-1" class="headerlink" title="Lecture 3-1"></a>Lecture 3-1</h1><h2 id="Web-Architecture"><a href="#Web-Architecture" class="headerlink" title="Web Architecture"></a>Web Architecture</h2><blockquote><p>Websites are programs: HTML + CSS + JSS + Plugins</p></blockquote><ul><li>Partially executed by the client (HTML, JavaScript, plugins, etc.)</li><li>Partially executed by the server (PHP, Ruby, SQL, etc.)</li></ul><h2 id="Web-Server"><a href="#Web-Server" class="headerlink" title="Web Server"></a>Web Server</h2><p>It serves <strong>Static Content (HTML + CSS pages)</strong></p><p>And it also generates <strong>Dynamic Content:</strong></p><ul><li>CGI (Conmmon Gateway Interface): PHP, Python, etc</li><li>Web server modules: Rails, etc</li><li>Database Backend: SQL</li></ul><h2 id="Web-Cookies"><a href="#Web-Cookies" class="headerlink" title="Web Cookies"></a>Web Cookies</h2><p>The web server provides a <strong>token</strong> in its response that looks like:</p><p>Set-Cookie:<code>&lt;cookie-name&gt;=&lt;cookie-value&gt;</code></p><p>This is then <strong>attached to every future request</strong> sent to the server</p><h3 id="Kinds-of-cookies"><a href="#Kinds-of-cookies" class="headerlink" title="Kinds of cookies:"></a>Kinds of cookies:</h3><ul><li>Session cookies<ul><li><strong>Deleted</strong> when the user close the browser</li><li><strong>Expiration property is not set</strong></li></ul></li><li>Persistent cookies<ul><li>A <strong>persistent cookie</strong> is a data file capable of providing websites with user preferences, settings and information for future visits.</li><li>Are saved until some server-defined expiration</li></ul></li></ul><h2 id="JavaScript-1"><a href="#JavaScript-1" class="headerlink" title="JavaScript"></a>JavaScript</h2><p><strong>Same-origin policy</strong>: script can read properties of documents only from the same server, protocol, and port</p><p>But, same-origin policy does not apply to scripts loaded from arbitrary site, so</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"http://www.example.com/myscript.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>runs as if it were loaded from the site that provided the page!</p><p>Server can also explicitly tell browser other domains that are allowed using Access-Control-Allow-Origin header</p><h2 id="HTML-Injection"><a href="#HTML-Injection" class="headerlink" title="HTML Injection"></a>HTML Injection</h2><p>Many interactive web applications echo user input:</p><ul><li>Search queries</li></ul><p><strong>What if user input contains HTML markup tags?</strong></p><p><strong>Similar story as with SQL injection</strong>: if the server doesnâ€™t sanitise and encode it, markup is rendered by the web browser as it is provided by any user of the website</p><h2 id="Cross-Site-Scripting"><a href="#Cross-Site-Scripting" class="headerlink" title="Cross Site Scripting"></a>Cross Site Scripting</h2><p>A vulnerability that allows an <strong>attacker</strong> to <strong>run</strong> <strong>JavaScript</strong> on a victim webpage</p><h3 id="Type-of-XSS"><a href="#Type-of-XSS" class="headerlink" title="Type of XSS"></a>Type of XSS</h3><ul><li>Methods for injecting malicious code:<ul><li>Reflected XSS<ul><li>the attack script is reflected back to the user as part of a page from the victim site</li></ul></li><li>Persistant/Stored XSS<ul><li>the attacker stores the malicious code in a resource managed by the web application, such as a database</li></ul></li><li>Others, such as DOM-based attackers</li></ul></li></ul><h3 id="Reflected-XSS"><a href="#Reflected-XSS" class="headerlink" title="Reflected XSS"></a>Reflected XSS</h3><p>A <strong>reflected XSS</strong> (or also called a non-persistent <strong>XSS</strong> attack) is a specific type of <strong>XSS</strong> whose malicious script bounces off of another website to the victimâ€™s  browser. It is passed in the query, typically, in the URL. It makes  exploitation as easy as tricking a user to <strong>click on a link.</strong></p><ul><li>E.g.<ul><li>PayPal 2006</li><li>Attackers contacted users via email and fooled them into accessing a particular URL hosted on the legitimate PayPal website.</li><li>Injected code redirected PayPal visitors to a page warning users their accounts had been compromised.</li><li>Victims were then redirected to a phishing site and prompted to enter sensitive financial data.</li></ul></li></ul><h3 id="Persistant-XSS"><a href="#Persistant-XSS" class="headerlink" title="Persistant XSS"></a>Persistant XSS</h3><p>XSS attacks enable attackers to <a href="https://en.wikipedia.org/wiki/Code_injection">inject</a> <a href="https://en.wikipedia.org/wiki/Client-side_script">client-side scripts</a> into <a href="https://en.wikipedia.org/wiki/Web_page">web pages</a> viewed by other users. A cross-site scripting vulnerability may be used by attackers to bypass <a href="https://en.wikipedia.org/wiki/Access_control">access controls</a> such as the <a href="https://en.wikipedia.org/wiki/Same-origin_policy">same-origin policy</a>.</p><h3 id="Protecting-Against-XSS"><a href="#Protecting-Against-XSS" class="headerlink" title="Protecting Against XSS"></a>Protecting Against XSS</h3><ul><li><strong>Validates all</strong> headers, cookies, query strings, form fields, and hidden fields (i.e., all parameters) against a rigorous specification of what should be allowed.</li><li><strong>Do not attempt to identify active content and remove, filter, or sanitize it.</strong> There are too many types of active content and too many ways of encoding it to get around filters for such content.</li><li><strong>Adopt a â€˜positiveâ€™ security policy that specifies what is allowed.</strong> â€˜Negativeâ€™ or attack signature based policies are difficult to maintain and are likely to be incomplete.</li></ul><h4 id="Input-Data-Validation-Filtering"><a href="#Input-Data-Validation-Filtering" class="headerlink" title="Input Data Validation + Filtering"></a>Input Data Validation + Filtering</h4><ul><li>allow only what you expect</li><li>Remove/encode special characters</li></ul><h4 id="Output-filtering-encoding"><a href="#Output-filtering-encoding" class="headerlink" title="Output filtering/encoding"></a>Output filtering/encoding</h4><ul><li><p>Remove / encode HTML special chars </p><ul><li><code>&amp;lt; for &lt;, &amp;gt; for &gt;, &amp;quot for â€œ</code></li></ul></li><li><p>Allow only safe commands (e.g., no <code>&lt;script&gt;</code>â€¦) </p><ul><li>Caution: <code>filter evasion</code> tricks</li></ul></li><li><p>See XSS Cheat Sheet for filter evasion</p></li><li><p>E.g., if filter allows quoting (of <code>&lt;script&gt;</code> etc.), use malformed quoting: <code>&lt;IMG â€œâ€â€&gt;&lt;SCRIPT&gt;alert(â€œXSSâ€)</code></p></li></ul><h2 id="CSRF-Cross-Site-Request-Forgery"><a href="#CSRF-Cross-Site-Request-Forgery" class="headerlink" title="CSRF (Cross Site Request Forgery)"></a>CSRF (Cross Site Request Forgery)</h2><h3 id="Ineffective-Defense-POST"><a href="#Ineffective-Defense-POST" class="headerlink" title="Ineffective Defense: POST"></a>Ineffective Defense: POST</h3><ul><li>GET requests are easier to launch CSRF attacks, so some people naively switch to POSTs</li><li>This does not help</li></ul><h3 id="Ineffective-Defense-URL-Rewriting"><a href="#Ineffective-Defense-URL-Rewriting" class="headerlink" title="Ineffective Defense: URL Rewriting"></a>Ineffective Defense: URL Rewriting</h3><ul><li>dangerous to pass auth tokens in URLs (middleperson, logging issues)</li></ul><h3 id="Imperfect-Defense-Referer-Validation"><a href="#Imperfect-Defense-Referer-Validation" class="headerlink" title="Imperfect Defense: Referer Validation"></a>Imperfect Defense: Referer Validation</h3><ul><li>Does not work if Referer is missing</li><li>Referer Privacy Problems<ul><li>HTTP Referer may leak privacy-sensitive information</li><li>Common sources of blocking:<ul><li>Network stripping by the organisation</li><li>Network stripping by the local machine</li><li>Stripped by browser for HTTPS -&gt; HTTP transitions</li></ul></li></ul></li></ul><h2 id="Denfense"><a href="#Denfense" class="headerlink" title="Denfense"></a>Denfense</h2><ul><li>Form keys</li><li>CSRF tokens<ul><li>Requests include a hard-to-guess secret<ul><li>Unguessability substitutes for unforgeability</li></ul></li></ul></li><li>Short cookies expiration date</li><li>Encourage users to log out</li></ul><h2 id="Double-Submitted-Cookies"><a href="#Double-Submitted-Cookies" class="headerlink" title="Double-Submitted Cookies"></a>Double-Submitted Cookies</h2><ul><li>Instead of writing separate nonce, re-use the session ID</li><li>When server replies to user, writes session ID to cookie as usual, plus writes into hidden form field</li><li>User posts form with value from hidden field and cookie, server verifies these are same</li><li>Why does this defence work?<ul><li>Attacker cannot reliably guess session ID (unless there is also an XSS vuln)</li></ul></li><li>Solution is completely stateless</li><li>Downside: passing session IDs in HTTP requests and responses is risky<ul><li>Solution: put hash(session ID) in hidden form field instead</li></ul></li></ul><h2 id="XSS-v-s-CSRF"><a href="#XSS-v-s-CSRF" class="headerlink" title="XSS v.s CSRF"></a>XSS v.s CSRF</h2><p><strong>XSS</strong></p><ul><li>Server-side vulnerability</li><li>Attacker injects a script into the trusted website Trusting browser executes attackerâ€™s script</li></ul><p><strong>CSRF</strong></p><ul><li>Server-side vulnerability</li><li>Attacker gets trusted browser to issue requests Trusting website executes attackerâ€™s requests</li></ul><h1 id="Lecture-3-2"><a href="#Lecture-3-2" class="headerlink" title="Lecture 3-2"></a>Lecture 3-2</h1><p>(Code Injection + Return-oriented Programming)</p><h2 id="Code-Injection-Attacks"><a href="#Code-Injection-Attacks" class="headerlink" title="Code Injection Attacks"></a>Code Injection Attacks</h2><blockquote><p>Attacker executes arbitrary code on <strong>Server</strong></p><p><strong>Not Sanitising</strong> user inputs/outputs</p></blockquote><h2 id="Unintended-Functionality"><a href="#Unintended-Functionality" class="headerlink" title="Unintended Functionality"></a>Unintended Functionality</h2><p>Security involves understanding both <strong>intended</strong> and <strong>unintended</strong> functionalities of the system.</p><blockquote><p>An <strong>exploit</strong> is a mechanism by which an attacker triggers some unintended functionality of the system (it is a blind spot for the developers)</p></blockquote><h2 id="What-makes-security-special"><a href="#What-makes-security-special" class="headerlink" title="What makes security special?"></a>What makes security special?</h2><p>These properties must hold even in the presence of a <strong>resourceful</strong> and <strong>strategic</strong> adversary</p><blockquote><p> <strong>Correctness:</strong> For a given input, a program should provide the correct output</p></blockquote><blockquote><p><strong>Safety</strong>: Well-formed programs cannot have bad (wrong or dangerous) outputs, no matter the input</p></blockquote><blockquote><p><strong>Robustness:</strong> Programs should be able to cope with errors in execution</p></blockquote><h2 id="Software-Vulnerability"><a href="#Software-Vulnerability" class="headerlink" title="Software Vulnerability"></a>Software Vulnerability</h2><ul><li><p>A <strong>software vulnerability</strong> is a bug in a program that allows a user capabilities that should be denied to them</p></li><li><p>One very common type of vulnerability is ones that violate <strong>control flow integrity</strong> (CFI)</p><p>Today weâ€™ll look at <strong>SQL injections</strong> and <strong>buffer overflows</strong></p></li></ul><h2 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h2><ol><li><p><strong>Post malicious input to form</strong></p><ol><li><p>SQL Injection Based on 1=1 is Always True</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">txtUserId = getRequestString("UserId");</span><br><span class="line">txtSQL = "<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">Users</span> <span class="keyword">WHERE</span> UserId = <span class="string">" + txtUserId;</span></span><br></pre></td></tr></table></figure><p>If users enter inputs like:  <strong>UserID</strong> <code>105 OR 1=1</code>, then the SQL statement will look like this:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">Users</span> <span class="keyword">WHERE</span> UserId = <span class="number">105</span> <span class="keyword">OR</span> <span class="number">1</span>=<span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>The SQL above is valid and will return ALL rows from the â€œUsersâ€ table, since  <u><strong>OR 1=1</strong> is always TRUE.</u></p></li><li><p>SQL Injection Based on â€œâ€=â€â€ is Always True</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uName = getRequestString("username");</span><br><span class="line">uPass = getRequestString("userpassword");</span><br><span class="line"></span><br><span class="line">sql = '<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">Users</span> <span class="keyword">WHERE</span> <span class="keyword">Name</span> =<span class="string">"' + uName + '"</span> <span class="keyword">AND</span> Pass =<span class="string">"' + uPass + '"</span><span class="string">'</span></span><br></pre></td></tr></table></figure><p>A hacker might get access to user names and passwords in a database by  simply inserting â€œ OR â€œâ€=â€ into the user name or password text box:</p><p>User Name: <code>&quot; OR &quot;&quot;=&quot;</code></p><p>Password: <code>&quot; OR &quot;&quot;=&quot;</code></p><p>The code at the server will create a valid SQL statement like this:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">Users</span> <span class="keyword">WHERE</span> <span class="keyword">Name</span> =<span class="string">""</span> <span class="keyword">OR</span> <span class="string">""</span>=<span class="string">""</span> <span class="keyword">AND</span> Pass =<span class="string">""</span> <span class="keyword">OR</span> <span class="string">""</span>=<span class="string">""</span></span><br></pre></td></tr></table></figure><p>The SQL above is valid and will return all rows from the â€œUsersâ€ table,  since <strong>OR â€œâ€=â€â€</strong> is always TRUE.</p></li></ol></li><li><p><strong>Requests unintended SQL query</strong></p></li><li><p><strong>Returns unintended data to attacker</strong></p></li></ol><h2 id="SQL-Injection-Mitigations"><a href="#SQL-Injection-Mitigations" class="headerlink" title="SQL Injection Mitigations"></a>SQL Injection Mitigations</h2><p>Server-side applications generate SQL queries <strong>based on arbitrary user input</strong></p><p><strong>Solution? Donâ€™t accept arbitrary user input!</strong></p><p><strong>Parameterised queries</strong>: pre-compiled queries that separate commands from input</p><p><strong>Input sanitisation</strong>: make sure only safe input is accepted What is unsafe?</p><ul><li>Single quote? Dashes? But these could be legitimate Sanitise on the client or the server<ul><li><strong>Use proper escaping/encoding?</strong></li></ul></li></ul><h2 id="Buffer-Overflows"><a href="#Buffer-Overflows" class="headerlink" title="Buffer Overflows"></a>Buffer Overflows</h2><blockquote><p> Program variables get allocated regions of physical memory in the form of <strong>buffers</strong></p><p>Buffer overflows happen when a program writes data beyond its allocated buffers</p><p>These are ubiquitous in systems-level languages (C/C++), made worse by the fact that many standard library functions make it easy to go beyond array bounds</p><p>String functions like strcpy() and strcat() write to the destination buffer until they encounter \0 in input, so the user providing the input (who can easily be the attacker!) controls how much gets written</p></blockquote><h3 id="Memory-Allocation-of-Programs"><a href="#Memory-Allocation-of-Programs" class="headerlink" title="Memory Allocation of Programs"></a>Memory Allocation of Programs</h3><p>The computer keeps track using a <strong>Stack</strong> when you make fucntion calls</p><h3 id="Call-Frame"><a href="#Call-Frame" class="headerlink" title="Call Frame"></a>Call Frame</h3><p>When a function is <strong>called</strong>:</p><ul><li>Allocate new <strong>frame</strong> for the callee</li><li>Caller pushes arguments and return address</li><li>Callee:<ul><li>pushes old <strong>frame pointer</strong> (fp): this points to <u>bottom of frame of currently executing function</u></li><li>Sets fp = sp (<strong>stack pointe</strong>r): this points to <u>top of stack</u></li></ul></li></ul><p>When a fucntion is <strong>returned</strong>:</p><ul><li>Callee pops local storage and sets <strong>sp = fp</strong></li><li>Callee pops <strong>fp</strong>(frame pointer)</li><li>Callee pops return address and returns to next instruction in caller frame </li></ul><h3 id="Smashing-the-Stack"><a href="#Smashing-the-Stack" class="headerlink" title="Smashing the Stack"></a>Smashing the Stack</h3><p>What happens if you overwrite a malicious value past the bounds of a local variable?</p><p>Could overwrite:</p><ul><li>another local variable<ul><li>What happens if you overwrite another local variable?</li><li><strong>It depends.</strong></li></ul></li><li>Saved fp<ul><li>What happens if you overwrite the saved fp?</li><li><strong>Probably terrible things!</strong><ul><li>When the function returns, the stack moves to an attacker-supplied address â‡’ complete control of execution</li><li>Even a single byte may be enough for this attack</li></ul></li></ul></li><li>return address<ul><li>What happens if you overwrite the return address?</li><li><strong>Terrible things!</strong></li><li>When the function returns, control is transferred to an attacker-supplied address â‡’ complete control of arbitrary code execution (re-direct to their own code)</li></ul></li><li>function argument</li><li>Deeper stack framess</li><li>exception control data</li></ul><h2 id="Shellcode"><a href="#Shellcode" class="headerlink" title="Shellcode"></a>Shellcode</h2><blockquote><p> <strong>Shellcode</strong> is defined as a set of instructions injected and then executed by an exploited program. <strong>Shellcode</strong> is used to directly manipulate registers and the functionality of a exploited program.s</p></blockquote><p>Attacker ensures shellcode is somewhere in the stack before overwriting return address <strong>but they might not know exactly where it is</strong></p><h2 id="NOP-sleds"><a href="#NOP-sleds" class="headerlink" title="NOP sleds"></a>NOP sleds</h2><p>Instead, attacker can rely on the NOP (â€œno- opâ€) instruction to create something called a</p><p><strong>NOP sled</strong> (or a NOP slide)</p><p>As long as the attackerâ€™s guess lands somewhere in this sequence of NOPs they can jump at the end to the start of the shellcode as desired</p><h2 id="DEP"><a href="#DEP" class="headerlink" title="DEP"></a>DEP</h2><ul><li>Data Execution Prevention</li><li>Maybe not everything needs to be executable?</li></ul><h2 id="ASLR"><a href="#ASLR" class="headerlink" title="ASLR"></a>ASLR</h2><ul><li>Randomisess address space</li><li>Now an attacker need to guess even more where they will land</li></ul><h2 id="Stack-Canaries"><a href="#Stack-Canaries" class="headerlink" title="Stack Canaries"></a>Stack Canaries</h2><ul><li>Write a random value to the end of the frame at the beginning of a function call.</li><li>Check that it is still there at the end.</li><li>If itâ€™s not, then throw an error.</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Lecture-1-1&quot;&gt;&lt;a href=&quot;#Lecture-1-1&quot; class=&quot;headerlink&quot; title=&quot;Lecture 1-1&quot;&gt;&lt;/a&gt;Lecture 1-1&lt;/h1&gt;&lt;h2 id=&quot;CIA-Triangle&quot;&gt;&lt;a href=&quot;#CIA-Triangle&quot; class=&quot;headerlink&quot; title=&quot;CIA Triangle&quot;&gt;&lt;/a&gt;CIA Triangle&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Components&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Confidentiality&lt;/strong&gt;: Keeping Data private, only authorized users and processes should be able to access or modify data&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Integrity&lt;/strong&gt;: System and data have not been improperly altered, data should be maintained in a correct state and nobody should be able  to improperly modify it, either accidentally or maliciously&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Availability&lt;/strong&gt;: The ability to use the system as anticipated&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Notes" scheme="http://yifanzhang13.github.io/categories/Notes/"/>
    
    
      <category term="COMP" scheme="http://yifanzhang13.github.io/tags/COMP/"/>
    
  </entry>
  
  <entry>
    <title>Quarantine in Shanghai</title>
    <link href="http://yifanzhang13.github.io/2020/04/07/Quarantine-in-Shanghai/"/>
    <id>http://yifanzhang13.github.io/2020/04/07/Quarantine-in-Shanghai/</id>
    <published>2020-04-07T12:20:08.000Z</published>
    <updated>2020-04-19T09:35:02.978Z</updated>
    
    <content type="html"><![CDATA[<h1 id="éš”ç¦»è®°å½•"><a href="#éš”ç¦»è®°å½•" class="headerlink" title="éš”ç¦»è®°å½•"></a>éš”ç¦»è®°å½•</h1><a id="more"></a><h2 id="Day-1"><a href="#Day-1" class="headerlink" title="Day 1"></a>Day 1</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day1.JPG" alt="day1"></p><p>æ—©ä¸Šæ¸©åº¦ï¼š36.9æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.1æ‘„æ°åº¦</p><h2 id="Day-2"><a href="#Day-2" class="headerlink" title="Day 2"></a>Day 2</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day2.JPG" alt="day2"></p><p>æ—©ä¸Šæ¸©åº¦ï¼š36.6æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.4æ‘„æ°åº¦</p><h2 id="Day-3"><a href="#Day-3" class="headerlink" title="Day 3 *"></a>Day 3 *</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day3.JPG" alt="day3"></p><p>æ—©ä¸Šæ¸©åº¦ï¼š36.0æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.5æ‘„æ°åº¦</p><h2 id="Day-4"><a href="#Day-4" class="headerlink" title="Day 4"></a>Day 4</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day4.JPG" alt="day4"></p><p>ä¸Šåˆæ¸©åº¦ï¼š36.0æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.5æ‘„æ°åº¦</p><h2 id="Day-5"><a href="#Day-5" class="headerlink" title="Day 5 *"></a>Day 5 *</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day5.JPG" alt=""></p><p>ä¸Šåˆæ¸©åº¦ï¼š36.0æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.4æ‘„æ°åº¦</p><h2 id="Day-6"><a href="#Day-6" class="headerlink" title="Day 6"></a>Day 6</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day6.JPG" alt=""></p><p>ä¸Šåˆæ¸©åº¦ï¼š36.5æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.9æ‘„æ°åº¦</p><h2 id="Day-7"><a href="#Day-7" class="headerlink" title="Day 7 *"></a>Day 7 *</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day7.JPG" alt=""></p><p>ä¸Šåˆæ¸©åº¦ï¼š36.4æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.7æ‘„æ°åº¦</p><h2 id="Day-8"><a href="#Day-8" class="headerlink" title="Day 8"></a>Day 8</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day8.JPG" alt=""></p><p>ä¸Šåˆæ¸©åº¦ï¼š36.3æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.7æ‘„æ°åº¦</p><h2 id="Day-9"><a href="#Day-9" class="headerlink" title="Day 9 *"></a>Day 9 *</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day9.JPG" alt=""></p><p>ä¸Šåˆæ¸©åº¦ï¼š36.3æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.6æ‘„æ°åº¦</p><h2 id="Day-10"><a href="#Day-10" class="headerlink" title="Day 10 *"></a>Day 10 *</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day10.JPG" alt=""></p><p>ä¸Šåˆæ¸©åº¦ï¼š36.2æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.7æ‘„æ°åº¦</p><h2 id="Day-11"><a href="#Day-11" class="headerlink" title="Day 11 *"></a>Day 11 *</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day11.JPG" alt=""></p><p>ä¸Šåˆæ¸©åº¦ï¼š36.4æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.5æ‘„æ°åº¦</p><h2 id="Day-12"><a href="#Day-12" class="headerlink" title="Day 12"></a>Day 12</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day12.JPG" alt=""></p><p>ä¸Šåˆæ¸©åº¦ï¼š36.1æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.5æ‘„æ°åº¦</p><h2 id="Day-13"><a href="#Day-13" class="headerlink" title="Day 13"></a>Day 13</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day13.JPG" alt=""></p><p>ä¸Šåˆæ¸©åº¦ï¼š36.1æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.8æ‘„æ°åº¦</p><h2 id="Day-14"><a href="#Day-14" class="headerlink" title="Day 14"></a>Day 14</h2><p><img src="https://raw.githubusercontent.com/yifanzhang13/yifanzhang13.github.io/master/images/QuarantinePics/day14.JPG" alt=""></p><p>ä¸Šåˆæ¸©åº¦ï¼š36.2æ‘„æ°åº¦</p><p>ä¸‹åˆæ¸©åº¦ï¼š36.5æ‘„æ°åº¦</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;éš”ç¦»è®°å½•&quot;&gt;&lt;a href=&quot;#éš”ç¦»è®°å½•&quot; class=&quot;headerlink&quot; title=&quot;éš”ç¦»è®°å½•&quot;&gt;&lt;/a&gt;éš”ç¦»è®°å½•&lt;/h1&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>NexT Configuration</title>
    <link href="http://yifanzhang13.github.io/2020/04/02/NexT-Theme-Decoration/"/>
    <id>http://yifanzhang13.github.io/2020/04/02/NexT-Theme-Decoration/</id>
    <published>2020-04-01T19:42:43.000Z</published>
    <updated>2020-04-03T22:21:53.670Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NexTä¸»é¢˜é…ç½®-Version-7-8-0"><a href="#NexTä¸»é¢˜é…ç½®-Version-7-8-0" class="headerlink" title="NexTä¸»é¢˜é…ç½®(Version 7.8.0)"></a>NexTä¸»é¢˜é…ç½®(Version 7.8.0)</h1><h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><h3 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h3><p>æœ¬æ•™ç¨‹é¢å‘Hexo NexTä¸»é¢˜v7.3.0ä»¥ä¸Šç‰ˆæœ¬ï¼Œå…¼å®¹æœ€æ–°v7.8.0ç‰ˆæœ¬ã€‚</p><p>è‹¥ä½¿ç”¨v6.x.xæˆ–ä¹‹å‰çš„ç‰ˆæœ¬å¯èƒ½ä¼šå¯¼è‡´ä¸å…¼å®¹ï¼Œæˆ–æ–‡ä»¶ä¸å­˜åœ¨çš„é—®é¢˜ï¼Œæœ¬æ–‡ä¸­ä¹Ÿä¼šæé†’ã€‚</p><p>å…¶ä»–Hexoä¸»é¢˜ä¸èƒ½ç›´æ¥å¥—ç”¨ï¼Œå»ºè®®è‡ªè¡Œä¿®æ”¹ä¹‹åå†ä½¿ç”¨ã€‚</p><a id="more"></a><h3 id="é˜…è¯»é¡»çŸ¥"><a href="#é˜…è¯»é¡»çŸ¥" class="headerlink" title="é˜…è¯»é¡»çŸ¥"></a>é˜…è¯»é¡»çŸ¥</h3><ul><li><p>Hexoç›®å½•æ¶æ„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ .deploy          #éƒ¨ç½²æ–‡ä»¶å¤¹</span><br><span class="line">â”œâ”€â”€ public           #htmlæºç ï¼Œhexo gç”Ÿæˆ</span><br><span class="line">â”œâ”€â”€ scaffolds        #æ¨¡æ¿</span><br><span class="line">â”œâ”€â”€ scripts          #æ‰©å±•è„šæœ¬</span><br><span class="line">â”œâ”€â”€ source           #æ–‡ç« æºç </span><br><span class="line">|   â”œâ”€â”€ _drafts      #è‰ç¨¿</span><br><span class="line">|   â””â”€â”€ _posts       #æ–‡ç« </span><br><span class="line">â”œâ”€â”€ themes           #ä¸»é¢˜</span><br><span class="line">|   â”œâ”€â”€ next         #NexTä¸»é¢˜</span><br><span class="line">â”œâ”€â”€ _config.yml      #åšå®¢é…ç½®</span><br><span class="line">â””â”€â”€ package.json     #åº”ç”¨ç¨‹åºæ•°æ®</span><br></pre></td></tr></table></figure></li><li><p>NexTç›®å½•æ¶æ„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ .github                #githubä¿¡æ¯</span><br><span class="line">â”œâ”€â”€ languages              #å¤šè¯­è¨€</span><br><span class="line">|   â”œâ”€â”€ _en.yml            #é»˜è®¤è¯­è¨€</span><br><span class="line">|   â””â”€â”€ zh-CN.yml          #ç®€ä½“ä¸­æ–‡</span><br><span class="line">|   â””â”€â”€ zh-TW.yml          #ç¹ä½“ä¸­æ–‡</span><br><span class="line">â”œâ”€â”€ layout                 #å¸ƒå±€ï¼Œæ ¹ç›®å½•ä¸‹çš„*.swigæ–‡ä»¶æ˜¯å¯¹ä¸»é¡µï¼Œåˆ†é¡µï¼Œå­˜æ¡£ç­‰çš„æ§åˆ¶</span><br><span class="line">|   â”œâ”€â”€ _custom            #å¯ä»¥è‡ªå®šä¹‰çš„æ¨¡æ¿ï¼Œè¦†ç›–åŸæœ‰æ¨¡æ¿</span><br><span class="line">|   |   â”œâ”€â”€ head.swig      #æ–‡é¦–æ ·å¼</span><br><span class="line">|   |   â”œâ”€â”€ header.swig    #å¤´éƒ¨æ ·å¼</span><br><span class="line">|   |   â”œâ”€â”€ sidebar.swig   #ä¾§è¾¹æ æ ·å¼</span><br><span class="line">|   â”œâ”€â”€ _macro             #å¯ä»¥è‡ªå®šä¹‰çš„æ¨¡æ¿ï¼Œè¦†ç›–åŸæœ‰æ¨¡æ¿</span><br><span class="line">|   |   â”œâ”€â”€ post.swig      #æ–‡ç« æ¨¡æ¿</span><br><span class="line">|   |   â”œâ”€â”€ reward.swig    #æ‰“èµæ¨¡æ¿</span><br><span class="line">|   |   â”œâ”€â”€ sidebar.swig   #ä¾§è¾¹æ æ¨¡æ¿</span><br><span class="line">|   â”œâ”€â”€ _partial           #å±€éƒ¨çš„å¸ƒå±€</span><br><span class="line">|   |   â”œâ”€â”€ head           #å¤´éƒ¨æ¨¡æ¿</span><br><span class="line">|   |   â”œâ”€â”€ search         #æœç´¢æ¨¡æ¿</span><br><span class="line">|   |   â”œâ”€â”€ share          #åˆ†äº«æ¨¡æ¿</span><br><span class="line">|   â”œâ”€â”€ _script            #å±€éƒ¨çš„å¸ƒå±€</span><br><span class="line">|   â”œâ”€â”€ _third-party       #ç¬¬ä¸‰æ–¹æ¨¡æ¿</span><br><span class="line">|   â”œâ”€â”€ _layout.swig       #ä¸»é¡µé¢æ¨¡æ¿</span><br><span class="line">|   â”œâ”€â”€ index.swig         #ä¸»é¡µé¢æ¨¡æ¿</span><br><span class="line">|   â”œâ”€â”€ page               #é¡µé¢æ¨¡æ¿</span><br><span class="line">|   â””â”€â”€ tag.swig           #tagæ¨¡æ¿</span><br><span class="line">â”œâ”€â”€ scripts                #scriptæºç </span><br><span class="line">|   â”œâ”€â”€ tags               #tagsçš„scriptæºç </span><br><span class="line">|   â”œâ”€â”€ marge.js           #é¡µé¢æ¨¡æ¿</span><br><span class="line">â”œâ”€â”€ source                 #æºç </span><br><span class="line">|   â”œâ”€â”€ css                #cssæºç </span><br><span class="line">|   |   â”œâ”€â”€ _common        #*.stylåŸºç¡€css</span><br><span class="line">|   |   â”œâ”€â”€ _custom        #*.stylè‡ªå®šä¹‰å±€éƒ¨css</span><br><span class="line">|   |   â””â”€â”€ _mixins        #mixinsçš„css</span><br><span class="line">|   â”œâ”€â”€ fonts              #å­—ä½“</span><br><span class="line">|   â”œâ”€â”€ images             #å›¾ç‰‡</span><br><span class="line">|   â”œâ”€â”€ js                 #javascriptæºä»£ç </span><br><span class="line">|   â””â”€â”€ lib                #å¼•ç”¨åº“</span><br><span class="line">â”œâ”€â”€ _config.yml            #ä¸»é¢˜é…ç½®æ–‡ä»¶</span><br><span class="line">â””â”€â”€ README.md              #è¯´æ˜æ–‡ä»¶</span><br></pre></td></tr></table></figure></li><li><p>NexTåœ¨v7.3.0ä¹‹åçš„ç‰ˆæœ¬å°†æ‰€æœ‰è‡ªå®šä¹‰customæ–‡ä»¶è½¬ç§»è‡³Hexoç›®å½•<code>source/_data/...</code>ä¸­ã€‚</p></li><li><p>äº†è§£CSSï¼Œswigå’Œjsè¯­æ³•</p></li></ul><h2 id="ä¸»é¢˜é…ç½®"><a href="#ä¸»é¢˜é…ç½®" class="headerlink" title="ä¸»é¢˜é…ç½®"></a>ä¸»é¢˜é…ç½®</h2><h3 id="Hexo-config-ymlçš„é…ç½®"><a href="#Hexo-config-ymlçš„é…ç½®" class="headerlink" title="Hexo _config.ymlçš„é…ç½®"></a>Hexo _config.ymlçš„é…ç½®</h3><h4 id="Siteè®¾ç½®"><a href="#Siteè®¾ç½®" class="headerlink" title="Siteè®¾ç½®"></a>Siteè®¾ç½®</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Siriusq</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">Hello</span> <span class="string">World!</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">UCLCS</span> <span class="string">NB!</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Sirius</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br></pre></td></tr></table></figure><p><code>title:</code> å¡«å†™æ ‡é¢˜<br><code>subtitle:</code> å¡«å†™å‰¯æ ‡é¢˜<br><code>description:</code> ç®€ä»‹<br><code>keywords:</code> å…³é”®è¯<br><code>author:</code> ä½œè€…ï¼Œæ–‡ç« ä¸­æ˜¾ç¤ºçš„ä½œè€…åç§°<br><code>language:</code> è®¾ç½®è¯­è¨€ï¼Œzh-CNæ˜¯ç®€ä½“ä¸­æ–‡ï¼Œenæ˜¯è‹±è¯­ï¼Œé»˜è®¤æ˜¯å¾·è¯­</p><h4 id="URLæ è®¾ç½®"><a href="#URLæ è®¾ç½®" class="headerlink" title="URLæ è®¾ç½®"></a>URLæ è®¾ç½®</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://Siriusq.github.io</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:year/:month/:day/:title/</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br></pre></td></tr></table></figure><p><code>url</code>:å¡«å†™åšå®¢åœ¨Githubçš„äºŒçº§åŸŸåï¼Œå¦‚ <code>https://YourName.github.io</code><br><code>permalink:</code>æ˜¯ç”Ÿæˆåšå®¢é¡µé¢æ—¶çš„è·¯å¾„åï¼Œä¸€èˆ¬æ˜¯:<code>year/:month/:day/:title/</code></p><h4 id="ç¿»é¡µè®¾ç½®"><a href="#ç¿»é¡µè®¾ç½®" class="headerlink" title="ç¿»é¡µè®¾ç½®"></a>ç¿»é¡µè®¾ç½®</h4><p>å…±æœ‰ä¸¤å¤„ï¼Œç”¨äºæ§åˆ¶æ¯ä¸€é¡µæ˜¾ç¤ºå¤šå°‘ç¯‡åšæ–‡</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Home page setting</span></span><br><span class="line"><span class="comment"># path: Root path for your blogs index page. (default = '')</span></span><br><span class="line"><span class="comment"># per_page: Posts displayed per page. (0 = disable pagination)</span></span><br><span class="line"><span class="comment"># order_by: Posts order. (Order by date descending by default)</span></span><br><span class="line"><span class="attr">index_generator:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">''</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">12</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">-date</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># Pagination</span></span><br><span class="line"><span class="comment">## Set per_page to 0 to disable pagination</span></span><br><span class="line"><span class="attr">per_page:</span> <span class="number">12</span></span><br><span class="line"><span class="attr">pagination_dir:</span> <span class="string">page</span></span><br></pre></td></tr></table></figure><p><code>per_page:</code>åè®¾ç½®åšæ–‡æ•°é‡ï¼Œ0ä»£è¡¨ä¸ç¿»é¡µå…¨éƒ¨å¹³é“ºæ˜¾ç¤º</p><h4 id="Deploymentè®¾ç½®"><a href="#Deploymentè®¾ç½®" class="headerlink" title="Deploymentè®¾ç½®"></a>Deploymentè®¾ç½®</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:username/username.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><p><code>branch:</code>åˆ†æ”¯å¡«å†™master</p><p><code>repo:</code>åæŠŠ<code>username</code>æ¢æˆè‡ªå·±çš„ç”¨æˆ·å</p><h3 id="NexT-config-ymlé…ç½®"><a href="#NexT-config-ymlé…ç½®" class="headerlink" title="NexT _config.ymlé…ç½®"></a>NexT _config.ymlé…ç½®</h3><h4 id="é¡µè„šè®¾ç½®"><a href="#é¡µè„šè®¾ç½®" class="headerlink" title="é¡µè„šè®¾ç½®"></a>é¡µè„šè®¾ç½®</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="comment"># Specify the date when the site was setup. If not defined, current year will be used.</span></span><br><span class="line">  <span class="attr">since:</span> <span class="number">2019</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Icon between year and copyright info.</span></span><br><span class="line">  <span class="attr">icon:</span></span><br><span class="line">    <span class="comment"># Icon name in fontawesome, see: https://fontawesome.com/v4.7.0/icons/</span></span><br><span class="line">    <span class="comment"># `heart` is recommended with animation in red (#ff0000).</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">heart</span></span><br><span class="line">    <span class="comment"># If you want to animate the icon, set it to true.</span></span><br><span class="line">    <span class="attr">animated:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># Change the color of icon, using Hex Code.</span></span><br><span class="line">    <span class="attr">color:</span> <span class="string">"#f08080"</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># If not defined, `author` from Hexo main config will be used.</span></span><br><span class="line">  <span class="attr">copyright:</span> <span class="string">Siriusq</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">powered:</span></span><br><span class="line">    <span class="comment"># Hexo link (Powered by Hexo).</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># Version info of Hexo after Hexo link (vX.X.X).</span></span><br><span class="line">    <span class="attr">version:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">theme:</span></span><br><span class="line">    <span class="comment"># Theme &amp; scheme info link (Theme - NexT.scheme).</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># Version info of NexT after scheme info (vX.X.X).</span></span><br><span class="line">    <span class="attr">version:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p><code>since:</code> è¡¨ç¤ºç½‘ç«™æˆç«‹çš„å¹´ä»½ï¼Œä¸è®¾ç½®çš„è¯é»˜è®¤æ˜¯å½“å‰å¹´ä»½ï¼Œæ˜¾ç¤ºä¸º<code>Â© 2019</code><br><code>icon:</code> ä¸­è®¾ç½®å¹´ä»½åé¢çš„å›¾æ ‡ï¼Œé»˜è®¤æ˜¯å¿ƒå½¢ï¼Œæƒ³ä¿®æ”¹çš„è¯å»<a href="https://fontawesome.com/">Fontawesome</a>é€‰æ‹©å›¾æ ‡ï¼Œç„¶åå†<code>name</code>æ ä¿®æ”¹<br><code>animated:</code> ç”¨äºè®¾ç½®å¿ƒå½¢æ˜¯å¦è·³åŠ¨<br><code>color:</code> ç”¨äºè®¾ç½®å›¾æ ‡é¢œè‰²ï¼Œç™¾åº¦å¯¹ç…§è‰²è¡¨æŸ¥å°±å¥½<br><code>copyright:</code> æ˜¾ç¤ºå›¾æ ‡åé¢çš„ç‰ˆæƒæ‰€å±ï¼Œä¹Ÿå°±æ˜¯ä½œè€…åï¼Œä¸è®¾ç½®çš„è¯é»˜è®¤æ˜¾ç¤ºæ ¹ç›®å½•é…ç½®æ–‡ä»¶ä¸­çš„ä½œè€…å<br><code>powered:</code> åé¢çš„æ ç›®ç”¨äºè®¾å®šæ˜¯å¦æ˜¾ç¤º<code>Powered by Hexo</code>ä»¥åŠå½“å‰ä¸»é¢˜çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ˜¾ç¤ºçš„è¯è®¾ä¸º<code>true</code><br><code>theme:</code> åé¢çš„æ ç›®ç”¨äºè®¾å®šæ˜¯å¦æ˜¾ç¤ºå½“å‰ä¸»é¢˜çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ˜¾ç¤ºçš„è¯å°†è®¾ä¸º<code>true</code></p><h4 id="ç‰ˆæƒä¿¡æ¯"><a href="#ç‰ˆæƒä¿¡æ¯" class="headerlink" title="ç‰ˆæƒä¿¡æ¯"></a>ç‰ˆæƒä¿¡æ¯</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">creative_commons:</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">by-nc-sa</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">language:</span> <span class="string">en</span></span><br></pre></td></tr></table></figure><p><code>license:</code>ç”¨äºè®¾ç½®ç‰ˆæƒæ ‡å‡†ï¼Œå…·ä½“å¯ä»¥å»<a href="https://creativecommons.org/share-your-work/licensing-types-examples">Creative Commons</a>æŸ¥çœ‹<br><code>sidebar:</code>ç”¨äºè®¾ç½®æ˜¯å¦åœ¨ä¾§è¾¹æ æ˜¾ç¤ºç‰ˆæƒæ ‡å‡†<br><code>post:</code>ç”¨äºè®¾ç½®æ˜¯å¦åœ¨æ–‡ç« åº•éƒ¨æ˜¾ç¤ºç‰ˆæƒä¿¡æ¯<br><code>language:</code>ç”¨äºè®¾ç½®è¯­è¨€</p><h4 id="Githubè§’æ ‡"><a href="#Githubè§’æ ‡" class="headerlink" title="Githubè§’æ ‡"></a>Githubè§’æ ‡</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># `Follow me on GitHub` banner in the top-right corner.</span></span><br><span class="line"><span class="attr">github_banner:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">permalink:</span> <span class="string">https://github.com/Siriusq</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">Follow</span> <span class="string">me</span> <span class="string">on</span> <span class="string">GitHub</span></span><br></pre></td></tr></table></figure><p><code>enable:</code>ç”¨äºè®¾ç½®æ˜¯å¦åœ¨é¡µé¢å³ä¸Šè§’æ˜¾ç¤ºGithubä¸‰è§’æ ‡<br><code>permalink:</code>åé¢å¡«å†™ä½ çš„Githubåœ°å€<br><code>title:</code>ç”¨äºè®¾ç½®é¼ æ ‡ç§»åŠ¨åˆ°å›¾æ ‡åæ˜¾ç¤ºçš„æ–‡å­—</p><h4 id="ä¾§è¾¹æ èœå•è®¾ç½®"><a href="#ä¾§è¾¹æ èœå•è®¾ç½®" class="headerlink" title="ä¾§è¾¹æ èœå•è®¾ç½®"></a>ä¾§è¾¹æ èœå•è®¾ç½®</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">user</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="attr">switch_lang:</span> <span class="string">/en</span> <span class="string">||</span> <span class="string">language</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || heartbeat</span></span><br></pre></td></tr></table></figure><p><code>||</code>å‰è¡¨ç¤ºé¡µé¢çš„åœ°å€ï¼Œåé¢è¡¨ç¤ºæ˜¾ç¤ºçš„å›¾æ ‡åç§°<br><code>about:</code>ç”¨äºè®¾ç½®<code>å…³äº</code>é¡µé¢ï¼Œæ²¡æœ‰çš„è¯åœ¨Git bashä¸­ä½¿ç”¨<code>hexo new page &quot;about&quot;</code>åˆ›å»ºï¼Œç„¶åæ‰“å¼€<code>\source\about\index.md</code>å°±å¯ä»¥ç¼–å†™äº†<br><code>tags:</code>ç”¨äºè®¾ç½®<code>æ ‡ç­¾</code>åŠŸèƒ½ï¼ŒåŒæ ·ä½¿ç”¨å‘½ä»¤<code>hexo new page &quot;tags&quot;</code>åˆ›å»ºï¼Œç„¶åæ‰“å¼€<code>source\tags\index.md</code>å¹¶åœ¨æ—¥æœŸåé¢æ·»åŠ ä¸€è¡Œ<code>type: &quot;tags&quot;</code>ï¼Œå†™åšæ–‡æ—¶åœ¨é¡¶éƒ¨åŠ ä¸Šä¸€æ <code>tags: []</code>å³å¯è®¾ç½®æ ‡ç­¾ï¼Œå¤šä¸ªæ ‡ç­¾ä¸­é—´ä½¿ç”¨<code>,</code>åˆ†éš”<br><code>archieves:</code>ç”¨äºè®¾ç½®å½’æ¡£é¡µé¢<br><code>categories:</code>ç”¨äºè®¾ç½®ç›®å½•é¡µé¢ï¼Œç¼–è¾‘åšæ–‡æ—¶åœ¨é¡¶éƒ¨åŠ ä¸Šä¸€æ <code>categories:</code>å°±å¯ä»¥ä¸ºåšæ–‡è®¾ç½®æ‰€å±ç›®å½•</p><h4 id="ä¸»é¢˜é€‰æ‹©"><a href="#ä¸»é¢˜é€‰æ‹©" class="headerlink" title="ä¸»é¢˜é€‰æ‹©"></a>ä¸»é¢˜é€‰æ‹©</h4><p>Nextæœ‰å››ä¸ªä¸»é¢˜å¯ä¾›é€‰æ‹©</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="comment">#scheme: Muse</span></span><br><span class="line"><span class="comment">#scheme: Mist</span></span><br><span class="line"><span class="comment">#scheme: Pisces</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Gemini</span></span><br></pre></td></tr></table></figure><p>é€‰æ‹©è‡ªå·±å–œæ¬¢çš„ä¸»é¢˜uncommentå³å¯</p><h4 id="ç¤¾äº¤ç½‘ç«™é“¾æ¥è®¾ç½®"><a href="#ç¤¾äº¤ç½‘ç«™é“¾æ¥è®¾ç½®" class="headerlink" title="ç¤¾äº¤ç½‘ç«™é“¾æ¥è®¾ç½®"></a>ç¤¾äº¤ç½‘ç«™é“¾æ¥è®¾ç½®</h4><p><strong><em>NexT v7.8.0 email social link bugï¼Œæš‚æ—¶æ²¡æœ‰å¾—åˆ°å®˜æ–¹çš„ä¿®å¤</em></strong></p><p><strong><em>æ‰€è®¾ç½®çš„</em></strong>  <u>mailto:<a href="mailto:siriuskevin@foxmail.com">siriuskevin@foxmail.com</a></u> <strong><em>åœ¨è½¬æ¢ä¸ºmdè½¬htmlä¹‹åä¼šåœ¨frontå¤šå‡ºä¸€ä¸ª</em></strong><code>/</code></p><p><strong><em>è¯¥bugå¯ä»¥é€šè¿‡ä¿®æ”¹æºç è§£å†³ï¼Œæ›´å¤šå¯ä»¥æŸ¥çœ‹</em></strong><a href="https://github.com/theme-next/hexo-theme-next/issues/1295">#1295</a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Social Links</span></span><br><span class="line"><span class="comment"># Usage: `Key: permalink || icon`</span></span><br><span class="line"><span class="comment"># Key is the link label showing to end users.</span></span><br><span class="line"><span class="comment"># Value before `||` delimeter is the target permalink.</span></span><br><span class="line"><span class="comment"># Value after `||` delimeter is the name of FontAwesome icon. If icon (with or without delimeter) is not specified, globe icon will be loaded.</span></span><br><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">GitHub:</span> <span class="string">https://github.com/Siriusq</span> <span class="string">||</span> <span class="string">github</span></span><br><span class="line">  <span class="attr">E-Mail:</span> <span class="string">mailto:siriuskevin@foxmail.com</span> <span class="string">||</span> <span class="string">envelope</span></span><br><span class="line">  <span class="comment">#Weibo: https://weibo.com/yourname || weibo</span></span><br><span class="line">  <span class="comment">#Google: https://plus.google.com/yourname || google</span></span><br><span class="line">  <span class="comment">#Twitter: https://twitter.com/yourname || twitter</span></span><br><span class="line">  <span class="comment">#FB Page: https://www.facebook.com/yourname || facebook</span></span><br><span class="line">  <span class="comment">#VK Group: https://vk.com/yourname || vk</span></span><br><span class="line">  <span class="comment">#StackOverflow: https://stackoverflow.com/yourname || stack-overflow</span></span><br><span class="line">  <span class="comment">#YouTube: https://youtube.com/yourname || youtube</span></span><br><span class="line">  <span class="comment">#Instagram: https://instagram.com/yourname || instagram</span></span><br><span class="line">  <span class="comment">#Skype: skype:yourname?call|chat || skype</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>||</code>å‰è¾“å…¥ä½ ç¤¾äº¤ä¸»é¡µçš„é“¾æ¥å³å¯ï¼Œåé¢ç”¨äºè®¾ç½®å›¾æ ‡<br><code>E-mail:</code>æ æ ¼å¼ä¸º<code>mailto:é‚®ç®±åœ°å€</code>ï¼Œåœ¨win10ç³»ç»Ÿå¯ä»¥è°ƒç”¨ç³»ç»Ÿé‚®ä»¶æœåŠ¡è‡ªåŠ¨å¡«å†™æ”¶ä»¶äºº</p><h4 id="å¤´åƒè®¾ç½®"><a href="#å¤´åƒè®¾ç½®" class="headerlink" title="å¤´åƒè®¾ç½®"></a>å¤´åƒè®¾ç½®</h4><p>ç”¨äºè®¾ç½®æ˜¯å¦åœ¨ä¾§è¾¹æ æ˜¾ç¤ºå¤´åƒ</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sidebar Avatar</span></span><br><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="comment"># In theme directory (source/images): /images/avatar.gif</span></span><br><span class="line">  <span class="comment"># In site directory (source/uploads): /uploads/avatar.gif</span></span><br><span class="line">  <span class="comment"># You can also use other linking images.</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">/images/avatar.gif</span></span><br><span class="line">  <span class="comment"># If true, the avatar would be dispalyed in circle.</span></span><br><span class="line">  <span class="attr">rounded:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># The value of opacity should be choose from 0 to 1 to set the opacity of the avatar.</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment"># If true, the avatar would be rotated with the cursor.</span></span><br><span class="line">  <span class="attr">rotated:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>url:</code>åå¡«å†™å¤´åƒå›¾ç‰‡çš„è·¯å¾„ï¼Œé»˜è®¤åœ¨<code>\themes\next\source\images</code>ä¸­<br><code>rounded:</code>ç”¨äºè®¾ç½®æ˜¯å¦æ˜¾ç¤ºåœ†å½¢å¤´åƒ<br><code>opacity:</code>ç”¨äºè®¾ç½®å¤´åƒé€æ˜åº¦ï¼Œ1ä¸ºä¸é€æ˜<br><code>rotated:</code>ç”¨äºè®¾ç½®å¤´åƒé¼ æ ‡ç§»åŠ¨åˆ°å¤´åƒä¸Šæ—¶å¤´åƒæ˜¯å¦æ—‹è½¬</p><h4 id="ä¾§è¾¹æ ç›®å½•è®¾ç½®"><a href="#ä¾§è¾¹æ ç›®å½•è®¾ç½®" class="headerlink" title="ä¾§è¾¹æ ç›®å½•è®¾ç½®"></a>ä¾§è¾¹æ ç›®å½•è®¾ç½®</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Table Of Contents in the Sidebar</span></span><br><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Automatically add list number to toc.</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># If true, all words will placed on next lines if header width longer then sidebar width.</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># If true, all level of TOC in a post will be displayed, rather than the activated part of it.</span></span><br><span class="line">  <span class="attr">expand_all:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Maximum heading depth of generated toc. You can set it in one post through `toc_max_depth` in Front Matter.</span></span><br><span class="line">  <span class="attr">max_depth:</span> <span class="number">6</span></span><br></pre></td></tr></table></figure><p><code>enable:</code>ç”¨äºè®¾ç½®æ˜¯å¦å¼€å¯ä¾§è¾¹æ ç›®å½•<br><code>number:</code>ç”¨äºè®¾ç½®è‡ªåŠ¨ç¼–å·<br><code>wrap:</code>ç”¨äºè®¾ç½®å½“æ ‡é¢˜é•¿åº¦è¶…è¿‡ä¾§è¾¹æ é•¿åº¦æ—¶æ˜¯å¦è‡ªåŠ¨æ¢è¡Œ<br><code>expand_all:</code>ç”¨äºè®¾ç½®æ˜¯å¦å±•å¼€å…¨éƒ¨ç›®å½•ï¼Œå¦çš„è¯ä¼šè‡ªåŠ¨å±•å¼€æ­£åœ¨çœ‹çš„é‚£éƒ¨åˆ†<br><code>max_depth:</code>ç”¨äºè®¾ç½®è‡ªåŠ¨ç”Ÿæˆç›®å½•çš„æœ€å¤§æ·±åº¦ï¼Œä¹Ÿå°±æ˜¯ç”Ÿæˆåˆ°å‡ çº§æ ‡é¢˜</p><h4 id="ä¾§è¾¹æ æ˜¾ç¤ºè®¾ç½®"><a href="#ä¾§è¾¹æ æ˜¾ç¤ºè®¾ç½®" class="headerlink" title="ä¾§è¾¹æ æ˜¾ç¤ºè®¾ç½®"></a>ä¾§è¾¹æ æ˜¾ç¤ºè®¾ç½®</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sidebar:</span></span><br><span class="line">  <span class="comment"># Sidebar Position, available values: left | right (only for Pisces | Gemini).</span></span><br><span class="line">  <span class="comment">#position: left</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">right</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Manual define the sidebar width. If commented, will be default for:</span></span><br><span class="line">  <span class="comment"># Muse | Mist: 320</span></span><br><span class="line">  <span class="comment"># Pisces | Gemini: 240</span></span><br><span class="line">  <span class="attr">width:</span> <span class="number">320</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Sidebar Display, available values (only for Muse | Mist):</span></span><br><span class="line">  <span class="comment">#  - post    expand on posts automatically. Default.</span></span><br><span class="line">  <span class="comment">#  - always  expand for all pages automatically.</span></span><br><span class="line">  <span class="comment">#  - hide    expand only when click on the sidebar toggle icon.</span></span><br><span class="line">  <span class="comment">#  - remove  totally remove sidebar including sidebar toggle.</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">post</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Sidebar offset from top menubar in pixels (only for Pisces | Gemini).</span></span><br><span class="line">  <span class="attr">offset:</span> <span class="number">12</span></span><br><span class="line">  <span class="comment"># Enable sidebar on narrow view (only for Muse | Mist).</span></span><br><span class="line">  <span class="attr">onmobile:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Click any blank part of the page to close sidebar (only for Muse | Mist).</span></span><br><span class="line">  <span class="attr">dimmer:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p><code>position:</code>ç”¨äºè®¾ç½®ä¾§è¾¹æ åœ¨å·¦è¾¹è¿˜æ˜¯å³è¾¹ï¼ŒæŠŠè¦é€‰æ‹©çš„ä½ç½®å‰é¢çš„<code>#</code>å»æ‰å†æŠŠå¦ä¸€ä¸ªå‰é¢åŠ ä¸Š<code>#</code>å³å¯ï¼Œè¿™ä¸ªé€‰é¡¹åªå¯¹<code>Pisces</code>å’Œ<code>Gemini</code>ä¸¤ä¸ªä¸»é¢˜èµ·ä½œç”¨<br><code>width:</code>ç”¨äºè®¾ç½®ä¾§è¾¹æ çš„å®½åº¦ï¼Œé»˜è®¤<code>Muse</code>å’Œ<code>Mist</code>æ˜¯320,<code>Pisces</code>å’Œ<code>Gemini</code>æ˜¯240<br><code>display:</code>ç”¨äºè®¾ç½®ä¾§è¾¹æ çš„æ˜¾ç¤ºæ–¹å¼ï¼Œåªå¯¹<code>Muse</code>å’Œ<code>Mist</code>ä¸¤ä¸ªä¸»é¢˜èµ·ä½œç”¨ï¼Œå¯ä»¥æŒ¨ä¸ªè¯•ä¸€ä¸‹<br><code>offset:</code>ç”¨äºè®¾ç½®ä¾§è¾¹æ è·ç¦»é¡¶éƒ¨ä»‹ç»çš„è·ç¦»ï¼Œåªå¯¹<code>Pisces</code>å’Œ<code>Gemini</code>ä¸¤ä¸ªä¸»é¢˜èµ·ä½œç”¨<br><code>onmobile:</code>ç”¨äºè®¾ç½®æ˜¯å¦åœ¨æ‰‹æœºç­‰å®½åº¦è¾ƒå°çš„è®¾å¤‡ä¸Šæ˜¾ç¤ºä¾§è¾¹æ ï¼Œåªå¯¹<code>Muse</code>å’Œ<code>Mist</code>ä¸¤ä¸ªä¸»é¢˜èµ·ä½œç”¨<br><code>dimmer:</code>ç”¨äºè®¾ç½®ç‚¹å‡»å±å¹•ç©ºç™½å¤„æ˜¯å¦å…³é—­ä¾§è¾¹æ ï¼ŒåŒæ ·åªå¯¹<code>Muse</code>å’Œ<code>Mist</code>ä¸¤ä¸ªä¸»é¢˜èµ·ä½œç”¨</p><h4 id="è¿”å›é¡¶éƒ¨æŒ‰é’®"><a href="#è¿”å›é¡¶éƒ¨æŒ‰é’®" class="headerlink" title="è¿”å›é¡¶éƒ¨æŒ‰é’®"></a>è¿”å›é¡¶éƒ¨æŒ‰é’®</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">back2top:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Back to top in sidebar.</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Scroll percent label in b2t button.</span></span><br><span class="line">  <span class="attr">scrollpercent:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p><code>enable:</code>ç”¨äºè®¾ç½®æ˜¯å¦å¼€å¯å›åˆ°é¡¶éƒ¨æŒ‰é’®<br><code>sidebar:</code>ç”¨äºè®¾ç½®æ˜¯å¦å°†æŒ‰é’®æ”¾åˆ°ä¾§è¾¹æ ä¸­<br><code>scrollpercent:</code>ç”¨äºè®¾ç½®æ˜¯å¦æ˜¾ç¤ºé˜…è¯»è¿›åº¦ç™¾åˆ†æ¯”</p><h4 id="å¼€å¯é˜…è¯»å…¨æ–‡é€‰é¡¹"><a href="#å¼€å¯é˜…è¯»å…¨æ–‡é€‰é¡¹" class="headerlink" title="å¼€å¯é˜…è¯»å…¨æ–‡é€‰é¡¹"></a>å¼€å¯<code>é˜…è¯»å…¨æ–‡</code>é€‰é¡¹</h4><p>ç”¨æœç´¢æ‰¾åˆ°è¿™ä¸€æ®µå¹¶æŠŠ<code>read_more_btn:</code>è®¾ä¸º<code>true</code>å³å¯</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Read more button</span></span><br><span class="line"><span class="comment"># If true, the read more button would be displayed in excerpt section.</span></span><br><span class="line"><span class="attr">read_more_btn:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢è¿™ä¸€æ®µç”¨äºè®¾ç½®è‡ªåŠ¨ç”Ÿæˆ<code>é˜…è¯»å…¨æ–‡</code>é€‰é¡¹</p><p><strong><em>NexTåœ¨7.3ç‰ˆæœ¬ä¹‹åå°±ä¸å†æ”¯æŒauto_excerptï¼Œè¯·æ·»åŠ </em></strong><code>&lt;!-- More --&gt;</code>åˆ°æ–‡ç« ä¸­æ‰‹åŠ¨è®¾ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Automatically Excerpt (Not recommend).</span></span><br><span class="line"><span class="comment"># Use &lt;!-- more --&gt; in the post to control excerpt accurately.</span></span><br><span class="line"><span class="attr">auto_excerpt:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">150</span></span><br></pre></td></tr></table></figure><p><code>length</code>è¡¨ç¤ºæˆªæ­¢åˆ°çš„å­—ç¬¦é•¿åº¦</p><p>è¿™ä¸€æ®µç”¨äºè®¾ç½®è‡ªåŠ¨è·³è½¬åˆ°<code>é˜…è¯»å…¨æ–‡</code>é€‰é¡¹ä¹‹åçš„ä½ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Automatically scroll page to section which is under &lt;!-- more --&gt; mark.</span></span><br><span class="line"><span class="attr">scroll_to_more:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>è®¾ç½®å®Œæˆåï¼Œåœ¨æ–‡ç« å†…åŠ å…¥``å­—æ®µå°±å¯ä»¥åœ¨é¦–é¡µéšå»å‰©ä¸‹çš„æ–‡å­—å¹¶æ˜¾ç¤º<code>é˜…è¯»å…¨æ–‡</code>æŒ‰é’®äº†</p><h4 id="ä»£ç å—å¤åˆ¶æŒ‰é’®"><a href="#ä»£ç å—å¤åˆ¶æŒ‰é’®" class="headerlink" title="ä»£ç å—å¤åˆ¶æŒ‰é’®"></a>ä»£ç å—å¤åˆ¶æŒ‰é’®</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">codeblock:</span></span><br><span class="line">  <span class="comment"># Manual define the border radius in codeblock, leave it blank for the default value: 1</span></span><br><span class="line">  <span class="attr">border_radius:</span></span><br><span class="line">  <span class="comment"># Add copy button on codeblock</span></span><br><span class="line">  <span class="attr">copy_button:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># Show text copy result</span></span><br><span class="line">    <span class="attr">show_result:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># Style: only 'flat' is currently available, leave it blank if you prefer default theme</span></span><br><span class="line">    <span class="attr">style:</span></span><br></pre></td></tr></table></figure><p><code>enableï¼š</code>ç”¨äºå¼€å¯ä»£ç å—å³ä¸Šè§’çš„å¤åˆ¶æŒ‰é’®<br><code>show_result:</code>ç”¨äºè®¾ç½®æ˜¯å¦æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º</p><h4 id="æ‰“èµ"><a href="#æ‰“èµ" class="headerlink" title="æ‰“èµ"></a>æ‰“èµ</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Reward (Donate)</span></span><br><span class="line"><span class="attr">reward_settings:</span></span><br><span class="line">  <span class="comment"># If true, reward would be displayed in every article by default.</span></span><br><span class="line">  <span class="comment"># You can show or hide reward in a specific article throuth `reward: true | false` in Front Matter.</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">animation:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment">#comment: Donate comment here</span></span><br><span class="line"></span><br><span class="line"><span class="attr">reward:</span></span><br><span class="line">  <span class="comment">#wechatpay: /images/wechatpay.png</span></span><br><span class="line">  <span class="comment">#alipay: /images/alipay.png</span></span><br><span class="line">  <span class="comment">#bitcoin: /images/bitcoin.png</span></span><br></pre></td></tr></table></figure><p><code>enable:</code>ç”¨äºè®¾ç½®æ˜¯å¦åœ¨æ–‡ç« æœ«å°¾æ˜¾ç¤ºæ‰“èµæŒ‰é’®<br><code>animation:</code>ç”¨äºè®¾ç½®æ‰“ä¸ŠæŒ‰é’®æ˜¯å¦æ˜¾ç¤ºåŠ¨ç”»<br><code>reward:</code>åé¢çš„é€‰é¡¹å»æ‰å‰é¢çš„<code>#</code>å³å¯å¼€å¯å¯¹åº”çš„æ‰“èµï¼Œè®°å¾—æ›¿æ¢æˆè‡ªå·±çš„å›¾ç‰‡ï¼Œè·¯å¾„åœ¨<code>\themes\next\source\images</code></p><h4 id="ä»£ç å—é«˜äº®ä¸»é¢˜"><a href="#ä»£ç å—é«˜äº®ä¸»é¢˜" class="headerlink" title="ä»£ç å—é«˜äº®ä¸»é¢˜"></a>ä»£ç å—é«˜äº®ä¸»é¢˜</h4><p>Nextä¸»é¢˜å†…ç½®äº†tomorrowä»£ç é«˜äº®ä¸»é¢˜ï¼Œä¸€å…±æœ‰äº”ä¸ªï¼Œå¯ä»¥å»<a href="https://github.com/chriskempson/tomorrow-theme">Tomorrow</a>æŸ¥çœ‹é¢„è§ˆæ•ˆæœï¼Œåœ¨ä¸‹é¢çš„<code>highlight_theme:</code>ä¸­æ”¹æˆè‡ªå·±æƒ³è¦çš„å³å¯</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Code Highlight theme</span></span><br><span class="line"><span class="comment"># Available values: normal | night | night eighties | night blue | night bright</span></span><br><span class="line"><span class="comment"># https://github.com/chriskempson/tomorrow-theme</span></span><br><span class="line"><span class="attr">highlight_theme:</span> <span class="string">night</span></span><br></pre></td></tr></table></figure><h4 id="ä¹¦ç­¾"><a href="#ä¹¦ç­¾" class="headerlink" title="ä¹¦ç­¾"></a>ä¹¦ç­¾</h4><p>åœ¨å·¦ä¸Šè§’æ˜¾ç¤ºä¸€ä¸ªä¹¦ç­¾æŒ‰é’®å¯ä»¥è·³è½¬åˆ°ä¸Šä¸€æ¬¡è®¾ç½®ä¹¦ç­¾çš„ä½ç½®<br>é¦–å…ˆæ‰§è¡Œå‘½ä»¤<code>git clone https://github.com/theme-next/theme-next-bookmark.git source/lib/bookmark</code>å®‰è£…<a href="https://github.com/theme-next/theme-next-bookmark">bookmark</a>æ’ä»¶<br>ç„¶ååœ¨ä¸‹é¢çš„é€‰é¡¹ä¸­å°†<code>enable:</code>è®¾ç½®ä¸º<code>true</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Bookmark Support</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-bookmark</span></span><br><span class="line"><span class="attr">bookmark:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># If auto, save the reading position when closing the page or clicking the bookmark-icon.</span></span><br><span class="line">  <span class="comment"># If manual, only save it by clicking the bookmark-icon.</span></span><br><span class="line">  <span class="attr">save:</span> <span class="string">auto</span></span><br></pre></td></tr></table></figure><h4 id="é»‘æš—æ¨¡å¼"><a href="#é»‘æš—æ¨¡å¼" class="headerlink" title="é»‘æš—æ¨¡å¼"></a>é»‘æš—æ¨¡å¼</h4><p>åœ¨config.ymlæ–‡ä»¶ä¸­æ‰¾åˆ°darkmodeå…³é”®å­—</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Dark Mode</span></span><br><span class="line"><span class="attr">darkmode:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>è®¾ç½®ä¸ºtrueå³å¯</p><h3 id="ä¸»é¢˜æ·±åº¦ç¾åŒ–"><a href="#ä¸»é¢˜æ·±åº¦ç¾åŒ–" class="headerlink" title="ä¸»é¢˜æ·±åº¦ç¾åŒ–"></a>ä¸»é¢˜æ·±åº¦ç¾åŒ–</h3><p><u>è¿™äº›ç¾åŒ–æ€»ç»“ä¸€ä¸‹å°±æ˜¯</u>ï¼š<strong>å¯ä»¥ä½†æ²¡å¿…è¦</strong></p><p>ğŸˆ¶ï¸é—²æƒ…é€¸è‡´ğŸ‰ï¸å¯ä»¥æä¸€ä¸‹ï¼Œ<del>è¿™æ˜¯ä¸€ä¸ªå¤§å‘ä¹‹åæœ‰æ—¶é—´å†æ›´</del></p><hr><h4 id="é¡¶éƒ¨é˜…è¯»è¿›åº¦æ¡"><a href="#é¡¶éƒ¨é˜…è¯»è¿›åº¦æ¡" class="headerlink" title="é¡¶éƒ¨é˜…è¯»è¿›åº¦æ¡"></a>é¡¶éƒ¨é˜…è¯»è¿›åº¦æ¡</h4><p>åœ¨åšæ–‡é¡µé¢é¡¶éƒ¨æ·»åŠ <a href="https://github.com/theme-next/theme-next-reading-progress">Reading Progress</a>è¿›åº¦æ¡ï¼Œè¡¨ç¤ºé˜…è¯»è¿›åº¦ï¼ŒNextä¸»é¢˜å·²å†…ç½®é…ç½®æ–‡ä»¶</p><h5 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><p>åˆ‡æ¢åˆ°Nextä¸»é¢˜æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> themes/next</span><br></pre></td></tr></table></figure><p>å®‰è£…æ¨¡å—åˆ°<code>source/lib</code>æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/theme-next/theme-next-reading-progress <span class="built_in">source</span>/lib/reading_progress</span><br></pre></td></tr></table></figure><h5 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h5><p>æ‰“å¼€Nextä¸»é¢˜è·¯å¾„ä¸‹çš„é…ç½®æ–‡ä»¶<code>_config.yml</code>ï¼Œæœç´¢<code>reading_progress</code>å®šä½åˆ°å¦‚ä¸‹ä»£ç å¹¶å°†<code>enable:</code>è®¾ç½®ä¸º<code>true</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Reading progress bar</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-reading-progress</span></span><br><span class="line">reading_progress:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  color: <span class="string">"#ffc0cb"</span> <span class="comment"># è°ƒæ•´çº¿æ¡é¢œè‰²</span></span><br><span class="line">  height: 3px <span class="comment"># è°ƒæ•´çº¿æ¡é«˜åº¦</span></span><br></pre></td></tr></table></figure><p>çº¿æ¡é¢œè‰²å¯ä»¥åœ¨<a href="http://www.atool9.com/colorpicker.php">ATOOL</a>æŸ¥è¯¢é¢œè‰²ä»£ç ç›´æ¥ä¿®æ”¹</p><h5 id="å‡çº§"><a href="#å‡çº§" class="headerlink" title="å‡çº§"></a>å‡çº§</h5><p>åˆ‡æ¢åˆ°å®‰è£…ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> themes/next/<span class="built_in">source</span>/lib/reading_progress</span><br></pre></td></tr></table></figure><p>æ›´æ–°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull</span><br></pre></td></tr></table></figure><h4 id="åŠ è½½æ¡"><a href="#åŠ è½½æ¡" class="headerlink" title="åŠ è½½æ¡"></a>åŠ è½½æ¡</h4><p>ç”¨äºåœ¨ç½‘é¡µåŠ è½½çš„è¿‡ç¨‹ä¸­æ˜¾ç¤ºåŠ è½½è¿›åº¦ï¼ŒNextä¸»é¢˜å·²æ”¯æŒ<a href="https://github.com/theme-next/theme-next-pace">PACE</a>åŠŸèƒ½<br>æœ‰å¤šç§åŠ è½½åŠ¨ç”»å¯é€‰</p><ul><li>pace-theme-big-counter</li><li>pace-theme-bounce</li><li>pace-theme-barber-shop</li><li>pace-theme-center-atom</li><li>pace-theme-center-circle</li><li>pace-theme-center-radar</li><li>pace-theme-center-simple</li><li>pace-theme-corner-indicator</li><li>pace-theme-fill-left</li><li>pace-theme-flash</li><li>pace-theme-loading-bar</li><li>pace-theme-mac-osx</li><li>pace-theme-minimal</li></ul><h5 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><p>åˆ‡æ¢åˆ°Nextä¸»é¢˜æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> themes/next</span><br></pre></td></tr></table></figure><p>å®‰è£…æ¨¡å—åˆ°<code>source/lib</code>æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/theme-next/theme-next-pace <span class="built_in">source</span>/lib/pace</span><br></pre></td></tr></table></figure><h5 id="ä¿®æ”¹é…ç½®æ–‡ä»¶-1"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶-1" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h5><p>æ‰“å¼€Nextä¸»é¢˜è·¯å¾„ä¸‹çš„é…ç½®æ–‡ä»¶<code>_config.yml</code>ï¼Œæœç´¢<code>pace</code>å®šä½åˆ°å¦‚ä¸‹ä»£ç </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Progress bar in the top during page loading.</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-pace</span></span><br><span class="line"><span class="attr">pace:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment"># Themes list:</span></span><br><span class="line"><span class="comment"># pace-theme-big-counter | pace-theme-bounce | pace-theme-barber-shop | pace-theme-center-atom</span></span><br><span class="line"><span class="comment"># pace-theme-center-circle | pace-theme-center-radar | pace-theme-center-simple | pace-theme-corner-indicator</span></span><br><span class="line"><span class="comment"># pace-theme-fill-left | pace-theme-flash | pace-theme-loading-bar | pace-theme-mac-osx | pace-theme-minimal</span></span><br><span class="line"><span class="attr">pace_theme:</span> <span class="string">pace-theme-flash</span></span><br></pre></td></tr></table></figure><p>å°†<code>pace:</code>è®¾ç½®ä¸º<code>true</code><br>å°†<code>pace_theme:</code>è®¾ç½®ä¸ºä¸Šé¢<code>Themes list:</code>ä¸­çš„ä¸€ç§ï¼Œä¸»é¢˜æ ·å¼å¯ä»¥åœ¨<a href="https://github.hubspot.com/pace/docs/welcome/">PACE</a>æŸ¥çœ‹</p><h5 id="è°ƒæ•´é¢œè‰²"><a href="#è°ƒæ•´é¢œè‰²" class="headerlink" title="è°ƒæ•´é¢œè‰²"></a>è°ƒæ•´é¢œè‰²</h5><p>ä¸ºäº†è®©è¿›åº¦æ¡å’Œä¸»é¢˜èƒŒæ™¯ç›¸åŒ¹é…ï¼Œå¯ä»¥åœ¨<code>./themes/next/source/lib/pace</code>ä¸­æ‰¾åˆ°ç›¸åº”ä¸»é¢˜çš„cssæ–‡ä»¶å¹¶ä¿®æ”¹é¢œè‰²é…ç½®<br>ä¸‹é¢ä»£ç ä»¥<code>pace-theme-flash.min.css</code>ç¤ºä¾‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.pace</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="string">-webkit-pointer-events:</span> <span class="string">none;</span></span><br><span class="line">  <span class="attr">pointer-events:</span> <span class="string">none;</span></span><br><span class="line">  <span class="string">-webkit-user-select:</span> <span class="string">none;</span></span><br><span class="line">  <span class="string">-moz-user-select:</span> <span class="string">none;</span></span><br><span class="line">  <span class="attr">user-select:</span> <span class="string">none;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">.pace-inactive</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">none;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">.pace</span> <span class="string">.pace-progress</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="attr">background:</span> <span class="comment">#ffc0cb;</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">fixed;</span></span><br><span class="line">  <span class="attr">z-index:</span> <span class="number">2000</span><span class="string">;</span></span><br><span class="line">  <span class="attr">top:</span> <span class="number">0</span><span class="string">;</span></span><br><span class="line">  <span class="attr">right:</span> <span class="number">100</span><span class="string">%;</span></span><br><span class="line">  <span class="attr">width:</span> <span class="number">100</span><span class="string">%;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">2px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">.pace</span> <span class="string">.pace-progress-inner</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">block;</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">absolute;</span></span><br><span class="line">  <span class="attr">right:</span> <span class="string">0px;</span></span><br><span class="line">  <span class="attr">width:</span> <span class="string">100px;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="number">100</span><span class="string">%;</span></span><br><span class="line">  <span class="attr">box-shadow:</span> <span class="number">0</span> <span class="number">0</span> <span class="string">10px</span> <span class="comment">#ffc0cb, 0 0 5px #ffc0cb;</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">1.0</span><span class="string">;</span></span><br><span class="line">  <span class="string">-webkit-transform:</span> <span class="string">rotate(3deg)</span> <span class="string">translate(0px,</span> <span class="string">-4px);</span></span><br><span class="line">  <span class="string">-moz-transform:</span> <span class="string">rotate(3deg)</span> <span class="string">translate(0px,</span> <span class="string">-4px);</span></span><br><span class="line">  <span class="string">-ms-transform:</span> <span class="string">rotate(3deg)</span> <span class="string">translate(0px,</span> <span class="string">-4px);</span></span><br><span class="line">  <span class="string">-o-transform:</span> <span class="string">rotate(3deg)</span> <span class="string">translate(0px,</span> <span class="string">-4px);</span></span><br><span class="line">  <span class="attr">transform:</span> <span class="string">rotate(3deg)</span> <span class="string">translate(0px,</span> <span class="string">-4px);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">.pace</span> <span class="string">.pace-activity</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">block;</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">fixed;</span></span><br><span class="line">  <span class="attr">z-index:</span> <span class="number">2000</span><span class="string">;</span></span><br><span class="line">  <span class="attr">top:</span> <span class="string">15px;</span></span><br><span class="line">  <span class="attr">right:</span> <span class="string">15px;</span></span><br><span class="line">  <span class="attr">width:</span> <span class="string">14px;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">14px;</span></span><br><span class="line">  <span class="attr">border:</span> <span class="string">solid</span> <span class="string">2px</span> <span class="string">transparent;</span></span><br><span class="line">  <span class="attr">border-top-color:</span> <span class="comment">#ffc0cb;</span></span><br><span class="line">  <span class="attr">border-left-color:</span> <span class="comment">#ffc0cb;</span></span><br><span class="line">  <span class="attr">border-radius:</span> <span class="string">10px;</span></span><br><span class="line">  <span class="string">-webkit-animation:</span> <span class="string">pace-spinner</span> <span class="string">400ms</span> <span class="string">linear</span> <span class="string">infinite;</span></span><br><span class="line">  <span class="string">-moz-animation:</span> <span class="string">pace-spinner</span> <span class="string">400ms</span> <span class="string">linear</span> <span class="string">infinite;</span></span><br><span class="line">  <span class="string">-ms-animation:</span> <span class="string">pace-spinner</span> <span class="string">400ms</span> <span class="string">linear</span> <span class="string">infinite;</span></span><br><span class="line">  <span class="string">-o-animation:</span> <span class="string">pace-spinner</span> <span class="string">400ms</span> <span class="string">linear</span> <span class="string">infinite;</span></span><br><span class="line">  <span class="attr">animation:</span> <span class="string">pace-spinner</span> <span class="string">400ms</span> <span class="string">linear</span> <span class="string">infinite;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">@-webkit-keyframes</span> <span class="string">pace-spinner</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="number">0</span><span class="string">%</span> <span class="string">&#123;</span> <span class="string">-webkit-transform:</span> <span class="string">rotate(0deg);</span> <span class="attr">transform:</span> <span class="string">rotate(0deg);</span> <span class="string">&#125;</span></span><br><span class="line">  <span class="number">100</span><span class="string">%</span> <span class="string">&#123;</span> <span class="string">-webkit-transform:</span> <span class="string">rotate(360deg);</span> <span class="attr">transform:</span> <span class="string">rotate(360deg);</span> <span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">@-moz-keyframes</span> <span class="string">pace-spinner</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="number">0</span><span class="string">%</span> <span class="string">&#123;</span> <span class="string">-moz-transform:</span> <span class="string">rotate(0deg);</span> <span class="attr">transform:</span> <span class="string">rotate(0deg);</span> <span class="string">&#125;</span></span><br><span class="line">  <span class="number">100</span><span class="string">%</span> <span class="string">&#123;</span> <span class="string">-moz-transform:</span> <span class="string">rotate(360deg);</span> <span class="attr">transform:</span> <span class="string">rotate(360deg);</span> <span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">@-o-keyframes</span> <span class="string">pace-spinner</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="number">0</span><span class="string">%</span> <span class="string">&#123;</span> <span class="string">-o-transform:</span> <span class="string">rotate(0deg);</span> <span class="attr">transform:</span> <span class="string">rotate(0deg);</span> <span class="string">&#125;</span></span><br><span class="line">  <span class="number">100</span><span class="string">%</span> <span class="string">&#123;</span> <span class="string">-o-transform:</span> <span class="string">rotate(360deg);</span> <span class="attr">transform:</span> <span class="string">rotate(360deg);</span> <span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">@-ms-keyframes</span> <span class="string">pace-spinner</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="number">0</span><span class="string">%</span> <span class="string">&#123;</span> <span class="string">-ms-transform:</span> <span class="string">rotate(0deg);</span> <span class="attr">transform:</span> <span class="string">rotate(0deg);</span> <span class="string">&#125;</span></span><br><span class="line">  <span class="number">100</span><span class="string">%</span> <span class="string">&#123;</span> <span class="string">-ms-transform:</span> <span class="string">rotate(360deg);</span> <span class="attr">transform:</span> <span class="string">rotate(360deg);</span> <span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">@keyframes</span> <span class="string">pace-spinner</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="number">0</span><span class="string">%</span> <span class="string">&#123;</span> <span class="attr">transform:</span> <span class="string">rotate(0deg);</span> <span class="attr">transform:</span> <span class="string">rotate(0deg);</span> <span class="string">&#125;</span></span><br><span class="line">  <span class="number">100</span><span class="string">%</span> <span class="string">&#123;</span> <span class="attr">transform:</span> <span class="string">rotate(360deg);</span> <span class="attr">transform:</span> <span class="string">rotate(360deg);</span> <span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æœç´¢åŠŸèƒ½æœç´¢<code>#</code>,å®šä½åˆ°é¢œè‰²è®¾ç½®ï¼Œä¸Šè¿°ä»£ç ä¸­ä¸€å…±æœ‰5å¤„ï¼Œé¢œè‰²æ›¿æ¢æ–¹æ³•å¦‚ä¸‹</p><ul><li>åœ¨<a href="http://www.atool9.com/colorpicker.php">ATOOL</a>æŸ¥è¯¢é¢œè‰²ä»£ç ç›´æ¥ä¿®æ”¹</li><li>ä½¿ç”¨<code>Visual Studio Code</code>å®‰è£…cssæ’ä»¶ç›´æ¥ç‚¹å‡»<code>#</code>ä¿®æ”¹é¢œè‰²</li><li>å‰å¾€<a href="https://github.hubspot.com/pace/docs/welcome/">PACE</a>é€‰æ‹©é¢œè‰²å¹¶å¤åˆ¶ä»£ç ç›´æ¥æ›¿æ¢åŸæ–‡ä»¶ä¸­çš„ä»£ç </li></ul><p>é»˜è®¤é¢œè‰²éƒ½æ˜¯è“è‰²ï¼Œä¸Šè¿°ä»£ç ä¿®æ”¹å®Œåæ˜¯ç²‰è‰²</p><h5 id="å‡çº§-1"><a href="#å‡çº§-1" class="headerlink" title="å‡çº§"></a>å‡çº§</h5><p>åˆ‡æ¢åˆ°å®‰è£…ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> themes/next/<span class="built_in">source</span>/lib/pace</span><br></pre></td></tr></table></figure><p>æ›´æ–°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://choubin.site/2019/12/30/CustomBlogTheme/">hexo ä¸ªäººåšå®¢åŸºäº NexT ä¸»é¢˜çš„åŸºæœ¬é…ç½®å’Œå®šåˆ¶ä¼˜åŒ–</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;NexTä¸»é¢˜é…ç½®-Version-7-8-0&quot;&gt;&lt;a href=&quot;#NexTä¸»é¢˜é…ç½®-Version-7-8-0&quot; class=&quot;headerlink&quot; title=&quot;NexTä¸»é¢˜é…ç½®(Version 7.8.0)&quot;&gt;&lt;/a&gt;NexTä¸»é¢˜é…ç½®(Version 7.8.0)&lt;/h1&gt;&lt;h2 id=&quot;è¯´æ˜&quot;&gt;&lt;a href=&quot;#è¯´æ˜&quot; class=&quot;headerlink&quot; title=&quot;è¯´æ˜&quot;&gt;&lt;/a&gt;è¯´æ˜&lt;/h2&gt;&lt;h3 id=&quot;å£°æ˜&quot;&gt;&lt;a href=&quot;#å£°æ˜&quot; class=&quot;headerlink&quot; title=&quot;å£°æ˜&quot;&gt;&lt;/a&gt;å£°æ˜&lt;/h3&gt;&lt;p&gt;æœ¬æ•™ç¨‹é¢å‘Hexo NexTä¸»é¢˜v7.3.0ä»¥ä¸Šç‰ˆæœ¬ï¼Œå…¼å®¹æœ€æ–°v7.8.0ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥ä½¿ç”¨v6.x.xæˆ–ä¹‹å‰çš„ç‰ˆæœ¬å¯èƒ½ä¼šå¯¼è‡´ä¸å…¼å®¹ï¼Œæˆ–æ–‡ä»¶ä¸å­˜åœ¨çš„é—®é¢˜ï¼Œæœ¬æ–‡ä¸­ä¹Ÿä¼šæé†’ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä»–Hexoä¸»é¢˜ä¸èƒ½ç›´æ¥å¥—ç”¨ï¼Œå»ºè®®è‡ªè¡Œä¿®æ”¹ä¹‹åå†ä½¿ç”¨ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Hexo" scheme="http://yifanzhang13.github.io/categories/Hexo/"/>
    
    
      <category term="configuration" scheme="http://yifanzhang13.github.io/tags/configuration/"/>
    
  </entry>
  
  <entry>
    <title>Hexo ERROR Render HTML failed</title>
    <link href="http://yifanzhang13.github.io/2020/04/01/Hexo-ERROR-Render-HTML-failed/"/>
    <id>http://yifanzhang13.github.io/2020/04/01/Hexo-ERROR-Render-HTML-failed/</id>
    <published>2020-04-01T10:30:00.000Z</published>
    <updated>2020-04-01T23:00:24.666Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ERROR-Render-HTML-failed"><a href="#ERROR-Render-HTML-failed" class="headerlink" title="ERROR-Render-HTML-failed"></a>ERROR-Render-HTML-failed</h1><p>Error reported when I entered <code>hexo g</code> to convert md file into HTML file</p><a id="more"></a><h2 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Files loaded <span class="keyword">in</span> 627 ms</span><br><span class="line">ERROR Render HTML failed: about/index.html</span><br><span class="line">TypeError: Cannot <span class="built_in">read</span> property <span class="string">'replace'</span> of null</span><br><span class="line">    at Hexo.externalLinkFilter (/Users/xiaqiulei/Documents/blog/node_modules/hexo/lib/plugins/filter/after_render/external_link.js:45:15)</span><br><span class="line">    at Hexo.tryCatcher (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/util.js:16:23)</span><br><span class="line">    at Hexo.&lt;anonymous&gt; (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/method.js:15:34)</span><br><span class="line">    at /Users/xiaqiulei/Documents/blog/node_modules/hexo/lib/extend/filter.js:60:50</span><br><span class="line">    at tryCatcher (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/util.js:16:23)</span><br><span class="line">    at Object.gotValue (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/reduce.js:155:18)</span><br><span class="line">    at Object.gotAccum (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/reduce.js:144:25)</span><br><span class="line">    at Object.tryCatcher (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/util.js:16:23)</span><br><span class="line">    at Promise._settlePromiseFromHandler (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/promise.js:512:31)</span><br><span class="line">    at Promise._settlePromise (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/promise.js:569:18)</span><br><span class="line">    at Promise._settlePromiseCtx (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/promise.js:606:10)</span><br><span class="line">    at _drainQueueStep (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/async.js:142:12)</span><br><span class="line">    at _drainQueue (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/async.js:131:9)</span><br><span class="line">    at Async._drainQueues (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/async.js:147:5)</span><br><span class="line">    at Immediate.Async.drainQueues [as _onImmediate] (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/async.js:17:14)</span><br><span class="line">    at processImmediate (internal/timers.js:439:21)</span><br><span class="line">ERROR Cannot <span class="built_in">read</span> property <span class="string">'replace'</span> of null</span><br><span class="line">TypeError: Cannot <span class="built_in">read</span> property <span class="string">'replace'</span> of null</span><br><span class="line">    at Hexo.externalLinkFilter (/Users/xiaqiulei/Documents/blog/node_modules/hexo/lib/plugins/filter/after_render/external_link.js:45:15)</span><br><span class="line">    at Hexo.tryCatcher (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/util.js:16:23)</span><br><span class="line">    at Hexo.&lt;anonymous&gt; (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/method.js:15:34)</span><br><span class="line">    at /Users/xiaqiulei/Documents/blog/node_modules/hexo/lib/extend/filter.js:60:50</span><br><span class="line">    at tryCatcher (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/util.js:16:23)</span><br><span class="line">    at Object.gotValue (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/reduce.js:155:18)</span><br><span class="line">    at Object.gotAccum (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/reduce.js:144:25)</span><br><span class="line">    at Object.tryCatcher (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/util.js:16:23)</span><br><span class="line">    at Promise._settlePromiseFromHandler (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/promise.js:512:31)</span><br><span class="line">    at Promise._settlePromise (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/promise.js:569:18)</span><br><span class="line">    at Promise._settlePromiseCtx (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/promise.js:606:10)</span><br><span class="line">    at _drainQueueStep (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/async.js:142:12)</span><br><span class="line">    at _drainQueue (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/async.js:131:9)</span><br><span class="line">    at Async._drainQueues (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/async.js:147:5)</span><br><span class="line">    at Immediate.Async.drainQueues [as _onImmediate] (/Users/xiaqiulei/Documents/blog/node_modules/bluebird/js/release/async.js:17:14)</span><br><span class="line">    at processImmediate (internal/timers.js:439:21)</span><br><span class="line">INFO  0 files generated <span class="keyword">in</span> 1.6 s</span><br></pre></td></tr></table></figure><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul><li><p>Uninstall the extension of â€˜Relative article recommendationâ€™</p></li><li><p>Set the <code>enable</code> into false</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">external_link:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span> <span class="comment"># Open external links in new tab</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">site</span> <span class="comment"># Apply to the whole site</span></span><br><span class="line">  <span class="attr">exclude:</span> <span class="string">'</span></span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ERROR-Render-HTML-failed&quot;&gt;&lt;a href=&quot;#ERROR-Render-HTML-failed&quot; class=&quot;headerlink&quot; title=&quot;ERROR-Render-HTML-failed&quot;&gt;&lt;/a&gt;ERROR-Render-HTML-failed&lt;/h1&gt;&lt;p&gt;Error reported when I entered &lt;code&gt;hexo g&lt;/code&gt; to convert md file into HTML file&lt;/p&gt;
    
    </summary>
    
    
      <category term="Hexo" scheme="http://yifanzhang13.github.io/categories/Hexo/"/>
    
    
      <category term="ERROR" scheme="http://yifanzhang13.github.io/tags/ERROR/"/>
    
  </entry>
  
  <entry>
    <title>Interview - Java Basics</title>
    <link href="http://yifanzhang13.github.io/2020/04/01/javabasics/"/>
    <id>http://yifanzhang13.github.io/2020/04/01/javabasics/</id>
    <published>2020-03-31T16:32:22.000Z</published>
    <updated>2020-04-01T16:09:47.575Z</updated>
    
    <content type="html"><![CDATA[<h2 id="2-1-JavaåŸºç¡€"><a href="#2-1-JavaåŸºç¡€" class="headerlink" title="2.1 JavaåŸºç¡€"></a>2.1 JavaåŸºç¡€</h2><p><a href="https://github.com/Snailclimb/JavaGuide-Interview">Original Blog</a></p><h3 id="1-é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«"><a href="#1-é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«" class="headerlink" title="1. é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«"></a>1. é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«</h3><ul><li><strong>é¢å‘è¿‡ç¨‹</strong> ï¼š<strong>é¢å‘è¿‡ç¨‹æ€§èƒ½æ¯”é¢å‘å¯¹è±¡é«˜ã€‚</strong> å› ä¸ºç±»è°ƒç”¨æ—¶éœ€è¦å®ä¾‹åŒ–ï¼Œå¼€é”€æ¯”è¾ƒå¤§ï¼Œæ¯”è¾ƒæ¶ˆè€—èµ„æºï¼Œæ‰€ä»¥å½“æ€§èƒ½æ˜¯æœ€é‡è¦çš„è€ƒé‡å› ç´ çš„æ—¶å€™ï¼Œæ¯”å¦‚å•ç‰‡æœºã€åµŒå…¥å¼å¼€å‘ã€Linux/Unix ç­‰ä¸€èˆ¬é‡‡ç”¨é¢å‘è¿‡ç¨‹å¼€å‘ã€‚ä½†æ˜¯ï¼Œ<strong>é¢å‘è¿‡ç¨‹æ²¡æœ‰é¢å‘å¯¹è±¡æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ã€‚</strong></li><li><strong>é¢å‘å¯¹è±¡</strong> ï¼š<strong>é¢å‘å¯¹è±¡æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ã€‚</strong> å› ä¸ºé¢å‘å¯¹è±¡æœ‰å°è£…ã€ç»§æ‰¿ã€å¤šæ€æ€§çš„ç‰¹æ€§ï¼Œæ‰€ä»¥å¯ä»¥è®¾è®¡å‡ºä½è€¦åˆçš„ç³»ç»Ÿï¼Œä½¿ç³»ç»Ÿæ›´åŠ çµæ´»ã€æ›´åŠ æ˜“äºç»´æŠ¤ã€‚ä½†æ˜¯ï¼Œ<strong>é¢å‘å¯¹è±¡æ€§èƒ½æ¯”é¢å‘è¿‡ç¨‹ä½</strong>ã€‚</li></ul><p>å‚è§ issue : <a href="https://github.com/Snailclimb/JavaGuide/issues/431">é¢å‘è¿‡ç¨‹ ï¼šé¢å‘è¿‡ç¨‹æ€§èƒ½æ¯”é¢å‘å¯¹è±¡é«˜ï¼Ÿï¼Ÿ</a></p><blockquote><p>è¿™ä¸ªå¹¶ä¸æ˜¯æ ¹æœ¬åŸå› ï¼Œé¢å‘è¿‡ç¨‹ä¹Ÿéœ€è¦åˆ†é…å†…å­˜ï¼Œè®¡ç®—å†…å­˜åç§»é‡ï¼ŒJava æ€§èƒ½å·®çš„ä¸»è¦åŸå› å¹¶ä¸æ˜¯å› ä¸ºå®ƒæ˜¯é¢å‘å¯¹è±¡è¯­è¨€ï¼Œè€Œæ˜¯ Java æ˜¯åŠç¼–è¯‘è¯­è¨€ï¼Œæœ€ç»ˆçš„æ‰§è¡Œä»£ç å¹¶ä¸æ˜¯å¯ä»¥ç›´æ¥è¢« CPU æ‰§è¡Œçš„äºŒè¿›åˆ¶æœºæ¢°ç ã€‚</p><p>è€Œé¢å‘è¿‡ç¨‹è¯­è¨€å¤§å¤šéƒ½æ˜¯ç›´æ¥ç¼–è¯‘æˆæœºæ¢°ç åœ¨ç”µè„‘ä¸Šæ‰§è¡Œï¼Œå¹¶ä¸”å…¶å®ƒä¸€äº›é¢å‘è¿‡ç¨‹çš„è„šæœ¬è¯­è¨€æ€§èƒ½ä¹Ÿå¹¶ä¸ä¸€å®šæ¯” Java å¥½ã€‚</p></blockquote><a id="more"></a><h3 id="2-Java-è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹"><a href="#2-Java-è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹" class="headerlink" title="2. Java è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹?"></a>2. Java è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹?</h3><ol><li>ç®€å•æ˜“å­¦ï¼›</li><li>é¢å‘å¯¹è±¡ï¼ˆå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼‰ï¼›</li><li>å¹³å°æ— å…³æ€§ï¼ˆ Java è™šæ‹Ÿæœºå®ç°å¹³å°æ— å…³æ€§ï¼‰ï¼›</li><li>å¯é æ€§ï¼›</li><li>å®‰å…¨æ€§ï¼›</li><li>æ”¯æŒå¤šçº¿ç¨‹ï¼ˆ C++ è¯­è¨€æ²¡æœ‰å†…ç½®çš„å¤šçº¿ç¨‹æœºåˆ¶ï¼Œå› æ­¤å¿…é¡»è°ƒç”¨æ“ä½œç³»ç»Ÿçš„å¤šçº¿ç¨‹åŠŸèƒ½æ¥è¿›è¡Œå¤šçº¿ç¨‹ç¨‹åºè®¾è®¡ï¼Œè€Œ Java è¯­è¨€å´æä¾›äº†å¤šçº¿ç¨‹æ”¯æŒï¼‰ï¼›</li><li>æ”¯æŒç½‘ç»œç¼–ç¨‹å¹¶ä¸”å¾ˆæ–¹ä¾¿ï¼ˆ Java è¯­è¨€è¯ç”Ÿæœ¬èº«å°±æ˜¯ä¸ºç®€åŒ–ç½‘ç»œç¼–ç¨‹è®¾è®¡çš„ï¼Œå› æ­¤ Java è¯­è¨€ä¸ä»…æ”¯æŒç½‘ç»œç¼–ç¨‹è€Œä¸”å¾ˆæ–¹ä¾¿ï¼‰ï¼›</li><li>ç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜ï¼›</li></ol><blockquote><p>ä¿®æ­£ï¼ˆå‚è§ï¼š <a href="https://github.com/Snailclimb/JavaGuide/issues/544">issue#544</a>ï¼‰ï¼šC++11 å¼€å§‹ï¼ˆ2011 å¹´çš„æ—¶å€™ï¼‰,C++å°±å¼•å…¥äº†å¤šçº¿ç¨‹åº“ï¼Œåœ¨ windowsã€linuxã€macos éƒ½å¯ä»¥ä½¿ç”¨<code>std::thread</code>å’Œ<code>std::async</code>æ¥åˆ›å»ºçº¿ç¨‹ã€‚å‚è€ƒé“¾æ¥ï¼š<a href="http://www.cplusplus.com/reference/thread/thread/?kw=thread">http://www.cplusplus.com/reference/thread/thread/?kw=thread</a></p></blockquote><h3 id="3-å…³äº-JVM-JDK-å’Œ-JRE-æœ€è¯¦ç»†é€šä¿—çš„è§£ç­”"><a href="#3-å…³äº-JVM-JDK-å’Œ-JRE-æœ€è¯¦ç»†é€šä¿—çš„è§£ç­”" class="headerlink" title="3. å…³äº JVM JDK å’Œ JRE æœ€è¯¦ç»†é€šä¿—çš„è§£ç­”"></a>3. å…³äº JVM JDK å’Œ JRE æœ€è¯¦ç»†é€šä¿—çš„è§£ç­”</h3><h4 id="JVM"><a href="#JVM" class="headerlink" title="JVM"></a>JVM</h4><p>Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰æ˜¯è¿è¡Œ Java å­—èŠ‚ç çš„è™šæ‹Ÿæœºã€‚JVM æœ‰é’ˆå¯¹ä¸åŒç³»ç»Ÿçš„ç‰¹å®šå®ç°ï¼ˆWindowsï¼ŒLinuxï¼ŒmacOSï¼‰ï¼Œç›®çš„æ˜¯ä½¿ç”¨ç›¸åŒçš„å­—èŠ‚ç ï¼Œå®ƒä»¬éƒ½ä¼šç»™å‡ºç›¸åŒçš„ç»“æœã€‚</p><p><strong>ä»€ä¹ˆæ˜¯å­—èŠ‚ç ?é‡‡ç”¨å­—èŠ‚ç çš„å¥½å¤„æ˜¯ä»€ä¹ˆ?</strong></p><blockquote><p>åœ¨ Java ä¸­ï¼ŒJVM å¯ä»¥ç†è§£çš„ä»£ç å°±å«åš<code>å­—èŠ‚ç </code>ï¼ˆå³æ‰©å±•åä¸º <code>.class</code> çš„æ–‡ä»¶ï¼‰ï¼Œå®ƒä¸é¢å‘ä»»ä½•ç‰¹å®šçš„å¤„ç†å™¨ï¼Œåªé¢å‘è™šæ‹Ÿæœºã€‚Java è¯­è¨€é€šè¿‡å­—èŠ‚ç çš„æ–¹å¼ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†ä¼ ç»Ÿè§£é‡Šå‹è¯­è¨€æ‰§è¡Œæ•ˆç‡ä½çš„é—®é¢˜ï¼ŒåŒæ—¶åˆä¿ç•™äº†è§£é‡Šå‹è¯­è¨€å¯ç§»æ¤çš„ç‰¹ç‚¹ã€‚æ‰€ä»¥ Java ç¨‹åºè¿è¡Œæ—¶æ¯”è¾ƒé«˜æ•ˆï¼Œè€Œä¸”ï¼Œç”±äºå­—èŠ‚ç å¹¶ä¸é’ˆå¯¹ä¸€ç§ç‰¹å®šçš„æœºå™¨ï¼Œå› æ­¤ï¼ŒJava ç¨‹åºæ— é¡»é‡æ–°ç¼–è¯‘ä¾¿å¯åœ¨å¤šç§ä¸åŒæ“ä½œç³»ç»Ÿçš„è®¡ç®—æœºä¸Šè¿è¡Œã€‚</p></blockquote><p><strong>Java ç¨‹åºä»æºä»£ç åˆ°è¿è¡Œä¸€èˆ¬æœ‰ä¸‹é¢ 3 æ­¥ï¼š</strong></p><p><img src="https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/Java%20%E7%A8%8B%E5%BA%8F%E8%BF%90%E8%A1%8C%E8%BF%87%E7%A8%8B.png" alt="Javaç¨‹åºè¿è¡Œè¿‡ç¨‹"></p><p>æˆ‘ä»¬éœ€è¦æ ¼å¤–æ³¨æ„çš„æ˜¯ .class-&gt;æœºå™¨ç  è¿™ä¸€æ­¥ã€‚åœ¨è¿™ä¸€æ­¥ JVM ç±»åŠ è½½å™¨é¦–å…ˆåŠ è½½å­—èŠ‚ç æ–‡ä»¶ï¼Œç„¶åé€šè¿‡è§£é‡Šå™¨é€è¡Œè§£é‡Šæ‰§è¡Œï¼Œè¿™ç§æ–¹å¼çš„æ‰§è¡Œé€Ÿåº¦ä¼šç›¸å¯¹æ¯”è¾ƒæ…¢ã€‚è€Œä¸”ï¼Œæœ‰äº›æ–¹æ³•å’Œä»£ç å—æ˜¯ç»å¸¸éœ€è¦è¢«è°ƒç”¨çš„(ä¹Ÿå°±æ˜¯æ‰€è°“çš„çƒ­ç‚¹ä»£ç )ï¼Œæ‰€ä»¥åé¢å¼•è¿›äº† JIT ç¼–è¯‘å™¨ï¼Œè€Œ JIT å±äºè¿è¡Œæ—¶ç¼–è¯‘ã€‚å½“ JIT ç¼–è¯‘å™¨å®Œæˆç¬¬ä¸€æ¬¡ç¼–è¯‘åï¼Œå…¶ä¼šå°†å­—èŠ‚ç å¯¹åº”çš„æœºå™¨ç ä¿å­˜ä¸‹æ¥ï¼Œä¸‹æ¬¡å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚è€Œæˆ‘ä»¬çŸ¥é“ï¼Œæœºå™¨ç çš„è¿è¡Œæ•ˆç‡è‚¯å®šæ˜¯é«˜äº Java è§£é‡Šå™¨çš„ã€‚è¿™ä¹Ÿè§£é‡Šäº†æˆ‘ä»¬ä¸ºä»€ä¹ˆç»å¸¸ä¼šè¯´ Java æ˜¯ç¼–è¯‘ä¸è§£é‡Šå…±å­˜çš„è¯­è¨€ã€‚</p><blockquote><p>HotSpot é‡‡ç”¨äº†æƒ°æ€§è¯„ä¼°(Lazy Evaluation)çš„åšæ³•ï¼Œæ ¹æ®äºŒå…«å®šå¾‹ï¼Œæ¶ˆè€—å¤§éƒ¨åˆ†ç³»ç»Ÿèµ„æºçš„åªæœ‰é‚£ä¸€å°éƒ¨åˆ†çš„ä»£ç ï¼ˆçƒ­ç‚¹ä»£ç ï¼‰ï¼Œè€Œè¿™ä¹Ÿå°±æ˜¯ JIT æ‰€éœ€è¦ç¼–è¯‘çš„éƒ¨åˆ†ã€‚JVM ä¼šæ ¹æ®ä»£ç æ¯æ¬¡è¢«æ‰§è¡Œçš„æƒ…å†µæ”¶é›†ä¿¡æ¯å¹¶ç›¸åº”åœ°åšå‡ºä¸€äº›ä¼˜åŒ–ï¼Œå› æ­¤æ‰§è¡Œçš„æ¬¡æ•°è¶Šå¤šï¼Œå®ƒçš„é€Ÿåº¦å°±è¶Šå¿«ã€‚JDK 9 å¼•å…¥äº†ä¸€ç§æ–°çš„ç¼–è¯‘æ¨¡å¼ AOT(Ahead of Time Compilation)ï¼Œå®ƒæ˜¯ç›´æ¥å°†å­—èŠ‚ç ç¼–è¯‘æˆæœºå™¨ç ï¼Œè¿™æ ·å°±é¿å…äº† JIT é¢„çƒ­ç­‰å„æ–¹é¢çš„å¼€é”€ã€‚JDK æ”¯æŒåˆ†å±‚ç¼–è¯‘å’Œ AOT åä½œä½¿ç”¨ã€‚ä½†æ˜¯ ï¼ŒAOT ç¼–è¯‘å™¨çš„ç¼–è¯‘è´¨é‡æ˜¯è‚¯å®šæ¯”ä¸ä¸Š JIT ç¼–è¯‘å™¨çš„ã€‚</p></blockquote><p><strong>æ€»ç»“ï¼š</strong></p><p>Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰æ˜¯è¿è¡Œ Java å­—èŠ‚ç çš„è™šæ‹Ÿæœºã€‚JVM æœ‰é’ˆå¯¹ä¸åŒç³»ç»Ÿçš„ç‰¹å®šå®ç°ï¼ˆWindowsï¼ŒLinuxï¼ŒmacOSï¼‰ï¼Œç›®çš„æ˜¯ä½¿ç”¨ç›¸åŒçš„å­—èŠ‚ç ï¼Œå®ƒä»¬éƒ½ä¼šç»™å‡ºç›¸åŒçš„ç»“æœã€‚å­—èŠ‚ç å’Œä¸åŒç³»ç»Ÿçš„ JVM å®ç°æ˜¯ Java è¯­è¨€â€œä¸€æ¬¡ç¼–è¯‘ï¼Œéšå¤„å¯ä»¥è¿è¡Œâ€çš„å…³é”®æ‰€åœ¨ã€‚</p><h4 id="JDK-å’Œ-JRE"><a href="#JDK-å’Œ-JRE" class="headerlink" title="JDK å’Œ JRE"></a>JDK å’Œ JRE</h4><p>JDK æ˜¯ Java Development Kitï¼Œå®ƒæ˜¯åŠŸèƒ½é½å…¨çš„ Java SDKã€‚å®ƒæ‹¥æœ‰ JRE æ‰€æ‹¥æœ‰çš„ä¸€åˆ‡ï¼Œè¿˜æœ‰ç¼–è¯‘å™¨ï¼ˆjavacï¼‰å’Œå·¥å…·ï¼ˆå¦‚ javadoc å’Œ jdbï¼‰ã€‚å®ƒèƒ½å¤Ÿåˆ›å»ºå’Œç¼–è¯‘ç¨‹åºã€‚</p><p>JRE æ˜¯ Java è¿è¡Œæ—¶ç¯å¢ƒã€‚å®ƒæ˜¯è¿è¡Œå·²ç¼–è¯‘ Java ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰å†…å®¹çš„é›†åˆï¼ŒåŒ…æ‹¬ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰ï¼ŒJava ç±»åº“ï¼Œjava å‘½ä»¤å’Œå…¶ä»–çš„ä¸€äº›åŸºç¡€æ„ä»¶ã€‚ä½†æ˜¯ï¼Œå®ƒä¸èƒ½ç”¨äºåˆ›å»ºæ–°ç¨‹åºã€‚</p><p>å¦‚æœä½ åªæ˜¯ä¸ºäº†è¿è¡Œä¸€ä¸‹ Java ç¨‹åºçš„è¯ï¼Œé‚£ä¹ˆä½ åªéœ€è¦å®‰è£… JRE å°±å¯ä»¥äº†ã€‚å¦‚æœä½ éœ€è¦è¿›è¡Œä¸€äº› Java ç¼–ç¨‹æ–¹é¢çš„å·¥ä½œï¼Œé‚£ä¹ˆä½ å°±éœ€è¦å®‰è£… JDK äº†ã€‚ä½†æ˜¯ï¼Œè¿™ä¸æ˜¯ç»å¯¹çš„ã€‚æœ‰æ—¶ï¼Œå³ä½¿æ‚¨ä¸æ‰“ç®—åœ¨è®¡ç®—æœºä¸Šè¿›è¡Œä»»ä½• Java å¼€å‘ï¼Œä»ç„¶éœ€è¦å®‰è£… JDKã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦ä½¿ç”¨ JSP éƒ¨ç½² Web åº”ç”¨ç¨‹åºï¼Œé‚£ä¹ˆä»æŠ€æœ¯ä¸Šè®²ï¼Œæ‚¨åªæ˜¯åœ¨åº”ç”¨ç¨‹åºæœåŠ¡å™¨ä¸­è¿è¡Œ Java ç¨‹åºã€‚é‚£ä½ ä¸ºä»€ä¹ˆéœ€è¦ JDK å‘¢ï¼Ÿå› ä¸ºåº”ç”¨ç¨‹åºæœåŠ¡å™¨ä¼šå°† JSP è½¬æ¢ä¸º Java servletï¼Œå¹¶ä¸”éœ€è¦ä½¿ç”¨ JDK æ¥ç¼–è¯‘ servletã€‚</p><h3 id="4-Oracle-JDK-å’Œ-OpenJDK-çš„å¯¹æ¯”"><a href="#4-Oracle-JDK-å’Œ-OpenJDK-çš„å¯¹æ¯”" class="headerlink" title="4. Oracle JDK å’Œ OpenJDK çš„å¯¹æ¯”"></a>4. Oracle JDK å’Œ OpenJDK çš„å¯¹æ¯”</h3><p>å¯èƒ½åœ¨çœ‹è¿™ä¸ªé—®é¢˜ä¹‹å‰å¾ˆå¤šäººå’Œæˆ‘ä¸€æ ·å¹¶æ²¡æœ‰æ¥è§¦å’Œä½¿ç”¨è¿‡ OpenJDK ã€‚é‚£ä¹ˆ Oracle å’Œ OpenJDK ä¹‹é—´æ˜¯å¦å­˜åœ¨é‡å¤§å·®å¼‚ï¼Ÿä¸‹é¢æˆ‘é€šè¿‡æ”¶é›†åˆ°çš„ä¸€äº›èµ„æ–™ï¼Œä¸ºä½ è§£ç­”è¿™ä¸ªè¢«å¾ˆå¤šäººå¿½è§†çš„é—®é¢˜ã€‚</p><p>å¯¹äº Java 7ï¼Œæ²¡ä»€ä¹ˆå…³é”®çš„åœ°æ–¹ã€‚OpenJDK é¡¹ç›®ä¸»è¦åŸºäº Sun æèµ çš„ HotSpot æºä»£ç ã€‚æ­¤å¤–ï¼ŒOpenJDK è¢«é€‰ä¸º Java 7 çš„å‚è€ƒå®ç°ï¼Œç”± Oracle å·¥ç¨‹å¸ˆç»´æŠ¤ã€‚å…³äº JVMï¼ŒJDKï¼ŒJRE å’Œ OpenJDK ä¹‹é—´çš„åŒºåˆ«ï¼ŒOracle åšå®¢å¸–å­åœ¨ 2012 å¹´æœ‰ä¸€ä¸ªæ›´è¯¦ç»†çš„ç­”æ¡ˆï¼š</p><blockquote><p>é—®ï¼šOpenJDK å­˜å‚¨åº“ä¸­çš„æºä»£ç ä¸ç”¨äºæ„å»º Oracle JDK çš„ä»£ç ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><p>ç­”ï¼šéå¸¸æ¥è¿‘ - æˆ‘ä»¬çš„ Oracle JDK ç‰ˆæœ¬æ„å»ºè¿‡ç¨‹åŸºäº OpenJDK 7 æ„å»ºï¼Œåªæ·»åŠ äº†å‡ ä¸ªéƒ¨åˆ†ï¼Œä¾‹å¦‚éƒ¨ç½²ä»£ç ï¼Œå…¶ä¸­åŒ…æ‹¬ Oracle çš„ Java æ’ä»¶å’Œ Java WebStart çš„å®ç°ï¼Œä»¥åŠä¸€äº›å°é—­çš„æºä»£ç æ´¾å¯¹ç»„ä»¶ï¼Œå¦‚å›¾å½¢å…‰æ …åŒ–å™¨ï¼Œä¸€äº›å¼€æºçš„ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼Œå¦‚ Rhinoï¼Œä»¥åŠä¸€äº›é›¶ç¢çš„ä¸œè¥¿ï¼Œå¦‚é™„åŠ æ–‡æ¡£æˆ–ç¬¬ä¸‰æ–¹å­—ä½“ã€‚å±•æœ›æœªæ¥ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯å¼€æº Oracle JDK çš„æ‰€æœ‰éƒ¨åˆ†ï¼Œé™¤äº†æˆ‘ä»¬è€ƒè™‘å•†ä¸šåŠŸèƒ½çš„éƒ¨åˆ†ã€‚</p></blockquote><p><strong>æ€»ç»“ï¼š</strong></p><ol><li>Oracle JDK å¤§æ¦‚æ¯ 6 ä¸ªæœˆå‘ä¸€æ¬¡ä¸»è¦ç‰ˆæœ¬ï¼Œè€Œ OpenJDK ç‰ˆæœ¬å¤§æ¦‚æ¯ä¸‰ä¸ªæœˆå‘å¸ƒä¸€æ¬¡ã€‚ä½†è¿™ä¸æ˜¯å›ºå®šçš„ï¼Œæˆ‘è§‰å¾—äº†è§£è¿™ä¸ªæ²¡å•¥ç”¨å¤„ã€‚è¯¦æƒ…å‚è§ï¼š<a href="https://blogs.oracle.com/java-platform-group/update-and-faq-on-the-java-se-release-cadenceã€‚">https://blogs.oracle.com/java-platform-group/update-and-faq-on-the-java-se-release-cadenceã€‚</a></li><li>OpenJDK æ˜¯ä¸€ä¸ªå‚è€ƒæ¨¡å‹å¹¶ä¸”æ˜¯å®Œå…¨å¼€æºçš„ï¼Œè€Œ Oracle JDK æ˜¯ OpenJDK çš„ä¸€ä¸ªå®ç°ï¼Œå¹¶ä¸æ˜¯å®Œå…¨å¼€æºçš„ï¼›</li><li>Oracle JDK æ¯” OpenJDK æ›´ç¨³å®šã€‚OpenJDK å’Œ Oracle JDK çš„ä»£ç å‡ ä¹ç›¸åŒï¼Œä½† Oracle JDK æœ‰æ›´å¤šçš„ç±»å’Œä¸€äº›é”™è¯¯ä¿®å¤ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨æƒ³å¼€å‘ä¼ä¸š/å•†ä¸šè½¯ä»¶ï¼Œæˆ‘å»ºè®®æ‚¨é€‰æ‹© Oracle JDKï¼Œå› ä¸ºå®ƒç»è¿‡äº†å½»åº•çš„æµ‹è¯•å’Œç¨³å®šã€‚æŸäº›æƒ…å†µä¸‹ï¼Œæœ‰äº›äººæåˆ°åœ¨ä½¿ç”¨ OpenJDK å¯èƒ½ä¼šé‡åˆ°äº†è®¸å¤šåº”ç”¨ç¨‹åºå´©æºƒçš„é—®é¢˜ï¼Œä½†æ˜¯ï¼Œåªéœ€åˆ‡æ¢åˆ° Oracle JDK å°±å¯ä»¥è§£å†³é—®é¢˜ï¼›</li><li>åœ¨å“åº”æ€§å’Œ JVM æ€§èƒ½æ–¹é¢ï¼ŒOracle JDK ä¸ OpenJDK ç›¸æ¯”æä¾›äº†æ›´å¥½çš„æ€§èƒ½ï¼›</li><li>Oracle JDK ä¸ä¼šä¸ºå³å°†å‘å¸ƒçš„ç‰ˆæœ¬æä¾›é•¿æœŸæ”¯æŒï¼Œç”¨æˆ·æ¯æ¬¡éƒ½å¿…é¡»é€šè¿‡æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬è·å¾—æ”¯æŒæ¥è·å–æœ€æ–°ç‰ˆæœ¬ï¼›</li><li>Oracle JDK æ ¹æ®äºŒè¿›åˆ¶ä»£ç è®¸å¯åè®®è·å¾—è®¸å¯ï¼Œè€Œ OpenJDK æ ¹æ® GPL v2 è®¸å¯è·å¾—è®¸å¯ã€‚</li></ol><h3 id="5-Java-å’Œ-C-çš„åŒºåˆ«"><a href="#5-Java-å’Œ-C-çš„åŒºåˆ«" class="headerlink" title="5. Java å’Œ C++çš„åŒºåˆ«?"></a>5. Java å’Œ C++çš„åŒºåˆ«?</h3><p>æˆ‘çŸ¥é“å¾ˆå¤šäººæ²¡å­¦è¿‡ C++ï¼Œä½†æ˜¯é¢è¯•å®˜å°±æ˜¯æ²¡äº‹å–œæ¬¢æ‹¿å’±ä»¬ Java å’Œ C++ æ¯”å‘€ï¼æ²¡åŠæ³•ï¼ï¼ï¼å°±ç®—æ²¡å­¦è¿‡ C++ï¼Œä¹Ÿè¦è®°ä¸‹æ¥ï¼</p><ul><li>éƒ½æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œéƒ½æ”¯æŒå°è£…ã€ç»§æ‰¿å’Œå¤šæ€</li><li>Java ä¸æä¾›æŒ‡é’ˆæ¥ç›´æ¥è®¿é—®å†…å­˜ï¼Œç¨‹åºå†…å­˜æ›´åŠ å®‰å…¨</li><li>Java çš„ç±»æ˜¯å•ç»§æ‰¿çš„ï¼ŒC++ æ”¯æŒå¤šé‡ç»§æ‰¿ï¼›è™½ç„¶ Java çš„ç±»ä¸å¯ä»¥å¤šç»§æ‰¿ï¼Œä½†æ˜¯æ¥å£å¯ä»¥å¤šç»§æ‰¿ã€‚</li><li>Java æœ‰è‡ªåŠ¨å†…å­˜ç®¡ç†æœºåˆ¶ï¼Œä¸éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾æ— ç”¨å†…å­˜</li><li><strong>åœ¨ C è¯­è¨€ä¸­ï¼Œå­—ç¬¦ä¸²æˆ–å­—ç¬¦æ•°ç»„æœ€åéƒ½ä¼šæœ‰ä¸€ä¸ªé¢å¤–çš„å­—ç¬¦â€˜\0â€™æ¥è¡¨ç¤ºç»“æŸã€‚ä½†æ˜¯ï¼ŒJava è¯­è¨€ä¸­æ²¡æœ‰ç»“æŸç¬¦è¿™ä¸€æ¦‚å¿µã€‚</strong> è¿™æ˜¯ä¸€ä¸ªå€¼å¾—æ·±åº¦æ€è€ƒçš„é—®é¢˜ï¼Œå…·ä½“åŸå› æ¨èçœ‹è¿™ç¯‡æ–‡ç« ï¼š <a href="https://blog.csdn.net/sszgg2006/article/details/49148189">https://blog.csdn.net/sszgg2006/article/details/49148189</a></li></ul><blockquote><p>ä½œè€…ï¼šGuideå“¥ã€‚</p><p><strong>ä»‹ç»:</strong> Github 70k Star é¡¹ç›®  <strong><a href="https://github.com/Snailclimb/JavaGuide">JavaGuide</a></strong>ï¼ˆå…¬ä¼—å·åŒåï¼‰ ä½œè€…ã€‚æ¯å‘¨éƒ½ä¼šåœ¨å…¬ä¼—å·æ›´æ–°ä¸€äº›è‡ªå·±åŸåˆ›å¹²è´§ã€‚å…¬ä¼—å·åå°å›å¤â€œ1â€é¢†å–Javaå·¥ç¨‹å¸ˆå¿…å¤‡å­¦ä¹ èµ„æ–™+é¢è¯•çªå‡»pdfã€‚</p></blockquote><h3 id="6-ä»€ä¹ˆæ˜¯-Java-ç¨‹åºçš„ä¸»ç±»-åº”ç”¨ç¨‹åºå’Œå°ç¨‹åºçš„ä¸»ç±»æœ‰ä½•ä¸åŒ"><a href="#6-ä»€ä¹ˆæ˜¯-Java-ç¨‹åºçš„ä¸»ç±»-åº”ç”¨ç¨‹åºå’Œå°ç¨‹åºçš„ä¸»ç±»æœ‰ä½•ä¸åŒ" class="headerlink" title="6. ä»€ä¹ˆæ˜¯ Java ç¨‹åºçš„ä¸»ç±» åº”ç”¨ç¨‹åºå’Œå°ç¨‹åºçš„ä¸»ç±»æœ‰ä½•ä¸åŒ?"></a>6. ä»€ä¹ˆæ˜¯ Java ç¨‹åºçš„ä¸»ç±» åº”ç”¨ç¨‹åºå’Œå°ç¨‹åºçš„ä¸»ç±»æœ‰ä½•ä¸åŒ?</h3><p>ä¸€ä¸ªç¨‹åºä¸­å¯ä»¥æœ‰å¤šä¸ªç±»ï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªç±»æ˜¯ä¸»ç±»ã€‚åœ¨ Java åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™ä¸ªä¸»ç±»æ˜¯æŒ‡åŒ…å« mainï¼ˆï¼‰æ–¹æ³•çš„ç±»ã€‚è€Œåœ¨ Java å°ç¨‹åºä¸­ï¼Œè¿™ä¸ªä¸»ç±»æ˜¯ä¸€ä¸ªç»§æ‰¿è‡ªç³»ç»Ÿç±» JApplet æˆ– Applet çš„å­ç±»ã€‚åº”ç”¨ç¨‹åºçš„ä¸»ç±»ä¸ä¸€å®šè¦æ±‚æ˜¯ public ç±»ï¼Œä½†å°ç¨‹åºçš„ä¸»ç±»è¦æ±‚å¿…é¡»æ˜¯ public ç±»ã€‚ä¸»ç±»æ˜¯ Java ç¨‹åºæ‰§è¡Œçš„å…¥å£ç‚¹ã€‚</p><h3 id="7-Java-åº”ç”¨ç¨‹åºä¸å°ç¨‹åºä¹‹é—´æœ‰å“ªäº›å·®åˆ«"><a href="#7-Java-åº”ç”¨ç¨‹åºä¸å°ç¨‹åºä¹‹é—´æœ‰å“ªäº›å·®åˆ«" class="headerlink" title="7. Java åº”ç”¨ç¨‹åºä¸å°ç¨‹åºä¹‹é—´æœ‰å“ªäº›å·®åˆ«?"></a>7. Java åº”ç”¨ç¨‹åºä¸å°ç¨‹åºä¹‹é—´æœ‰å“ªäº›å·®åˆ«?</h3><p>ç®€å•è¯´åº”ç”¨ç¨‹åºæ˜¯ä»ä¸»çº¿ç¨‹å¯åŠ¨(ä¹Ÿå°±æ˜¯ <code>main()</code> æ–¹æ³•)ã€‚applet å°ç¨‹åºæ²¡æœ‰ <code>main()</code> æ–¹æ³•ï¼Œä¸»è¦æ˜¯åµŒåœ¨æµè§ˆå™¨é¡µé¢ä¸Šè¿è¡Œ(è°ƒç”¨<code>init()</code>æˆ–è€…<code>run()</code>æ¥å¯åŠ¨)ï¼ŒåµŒå…¥æµè§ˆå™¨è¿™ç‚¹è·Ÿ flash çš„å°æ¸¸æˆç±»ä¼¼ã€‚</p><h3 id="8-å­—ç¬¦å‹å¸¸é‡å’Œå­—ç¬¦ä¸²å¸¸é‡çš„åŒºåˆ«"><a href="#8-å­—ç¬¦å‹å¸¸é‡å’Œå­—ç¬¦ä¸²å¸¸é‡çš„åŒºåˆ«" class="headerlink" title="8. å­—ç¬¦å‹å¸¸é‡å’Œå­—ç¬¦ä¸²å¸¸é‡çš„åŒºåˆ«?"></a>8. å­—ç¬¦å‹å¸¸é‡å’Œå­—ç¬¦ä¸²å¸¸é‡çš„åŒºåˆ«?</h3><ol><li>å½¢å¼ä¸Š: å­—ç¬¦å¸¸é‡æ˜¯å•å¼•å·å¼•èµ·çš„ä¸€ä¸ªå­—ç¬¦; å­—ç¬¦ä¸²å¸¸é‡æ˜¯åŒå¼•å·å¼•èµ·çš„è‹¥å¹²ä¸ªå­—ç¬¦</li><li>å«ä¹‰ä¸Š: å­—ç¬¦å¸¸é‡ç›¸å½“äºä¸€ä¸ªæ•´å‹å€¼( ASCII å€¼),å¯ä»¥å‚åŠ è¡¨è¾¾å¼è¿ç®—; å­—ç¬¦ä¸²å¸¸é‡ä»£è¡¨ä¸€ä¸ªåœ°å€å€¼(è¯¥å­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­å­˜æ”¾ä½ç½®)</li><li>å å†…å­˜å¤§å° å­—ç¬¦å¸¸é‡åªå  2 ä¸ªå­—èŠ‚; å­—ç¬¦ä¸²å¸¸é‡å è‹¥å¹²ä¸ªå­—èŠ‚ (<strong>æ³¨æ„ï¼š char åœ¨ Java ä¸­å ä¸¤ä¸ªå­—èŠ‚</strong>)</li></ol><blockquote><p>java ç¼–ç¨‹æ€æƒ³ç¬¬å››ç‰ˆï¼š2.2.2 èŠ‚<br><img src="http://my-blog-to-use.oss-cn-beijing.aliyuncs.com/18-9-15/86735519.jpg" alt=""></p></blockquote><h3 id="9-æ„é€ å™¨-Constructor-æ˜¯å¦å¯è¢«-override"><a href="#9-æ„é€ å™¨-Constructor-æ˜¯å¦å¯è¢«-override" class="headerlink" title="9. æ„é€ å™¨ Constructor æ˜¯å¦å¯è¢« override?"></a>9. æ„é€ å™¨ Constructor æ˜¯å¦å¯è¢« override?</h3><p>Constructor ä¸èƒ½è¢« overrideï¼ˆé‡å†™ï¼‰,ä½†æ˜¯å¯ä»¥ overloadï¼ˆé‡è½½ï¼‰,æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç±»ä¸­æœ‰å¤šä¸ªæ„é€ å‡½æ•°çš„æƒ…å†µã€‚</p><h3 id="10-é‡è½½å’Œé‡å†™çš„åŒºåˆ«"><a href="#10-é‡è½½å’Œé‡å†™çš„åŒºåˆ«" class="headerlink" title="10. é‡è½½å’Œé‡å†™çš„åŒºåˆ«"></a>10. é‡è½½å’Œé‡å†™çš„åŒºåˆ«</h3><h4 id="é‡è½½"><a href="#é‡è½½" class="headerlink" title="é‡è½½"></a>é‡è½½</h4><p>å‘ç”Ÿåœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œæ–¹æ³•åå¿…é¡»ç›¸åŒï¼Œå‚æ•°ç±»å‹ä¸åŒã€ä¸ªæ•°ä¸åŒã€é¡ºåºä¸åŒï¼Œæ–¹æ³•è¿”å›å€¼å’Œè®¿é—®ä¿®é¥°ç¬¦å¯ä»¥ä¸åŒã€‚</p><p>ä¸‹é¢æ˜¯ã€ŠJava æ ¸å¿ƒæŠ€æœ¯ã€‹å¯¹é‡è½½è¿™ä¸ªæ¦‚å¿µçš„ä»‹ç»ï¼š</p><p><img src="https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/bg/desktopjava%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF-%E9%87%8D%E8%BD%BD.jpg" alt=""></p><h4 id="é‡å†™"><a href="#é‡å†™" class="headerlink" title="é‡å†™"></a>é‡å†™</h4><p>é‡å†™æ˜¯å­ç±»å¯¹çˆ¶ç±»çš„å…è®¸è®¿é—®çš„æ–¹æ³•çš„å®ç°è¿‡ç¨‹è¿›è¡Œé‡æ–°ç¼–å†™,å‘ç”Ÿåœ¨å­ç±»ä¸­ï¼Œæ–¹æ³•åã€å‚æ•°åˆ—è¡¨å¿…é¡»ç›¸åŒï¼Œè¿”å›å€¼èŒƒå›´å°äºç­‰äºçˆ¶ç±»ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸èŒƒå›´å°äºç­‰äºçˆ¶ç±»ï¼Œè®¿é—®ä¿®é¥°ç¬¦èŒƒå›´å¤§äºç­‰äºçˆ¶ç±»ã€‚å¦å¤–ï¼Œå¦‚æœçˆ¶ç±»æ–¹æ³•è®¿é—®ä¿®é¥°ç¬¦ä¸º private åˆ™å­ç±»å°±ä¸èƒ½é‡å†™è¯¥æ–¹æ³•ã€‚<strong>ä¹Ÿå°±æ˜¯è¯´æ–¹æ³•æä¾›çš„è¡Œä¸ºæ”¹å˜ï¼Œè€Œæ–¹æ³•çš„å¤–è²Œå¹¶æ²¡æœ‰æ”¹å˜ã€‚</strong></p><h3 id="11-Java-é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸‰å¤§ç‰¹æ€§-å°è£…-ç»§æ‰¿-å¤šæ€"><a href="#11-Java-é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸‰å¤§ç‰¹æ€§-å°è£…-ç»§æ‰¿-å¤šæ€" class="headerlink" title="11. Java é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸‰å¤§ç‰¹æ€§: å°è£… ç»§æ‰¿ å¤šæ€"></a>11. Java é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸‰å¤§ç‰¹æ€§: å°è£… ç»§æ‰¿ å¤šæ€</h3><h4 id="å°è£…"><a href="#å°è£…" class="headerlink" title="å°è£…"></a>å°è£…</h4><p>å°è£…æŠŠä¸€ä¸ªå¯¹è±¡çš„å±æ€§ç§æœ‰åŒ–ï¼ŒåŒæ—¶æä¾›ä¸€äº›å¯ä»¥è¢«å¤–ç•Œè®¿é—®çš„å±æ€§çš„æ–¹æ³•ï¼Œå¦‚æœå±æ€§ä¸æƒ³è¢«å¤–ç•Œè®¿é—®ï¼Œæˆ‘ä»¬å¤§å¯ä¸å¿…æä¾›æ–¹æ³•ç»™å¤–ç•Œè®¿é—®ã€‚ä½†æ˜¯å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰æä¾›ç»™å¤–ç•Œè®¿é—®çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ„ä¹‰äº†ã€‚</p><h4 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h4><p>ç»§æ‰¿æ˜¯ä½¿ç”¨å·²å­˜åœ¨çš„ç±»çš„å®šä¹‰ä½œä¸ºåŸºç¡€å»ºç«‹æ–°ç±»çš„æŠ€æœ¯ï¼Œæ–°ç±»çš„å®šä¹‰å¯ä»¥å¢åŠ æ–°çš„æ•°æ®æˆ–æ–°çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½é€‰æ‹©æ€§åœ°ç»§æ‰¿çˆ¶ç±»ã€‚é€šè¿‡ä½¿ç”¨ç»§æ‰¿æˆ‘ä»¬èƒ½å¤Ÿéå¸¸æ–¹ä¾¿åœ°å¤ç”¨ä»¥å‰çš„ä»£ç ã€‚</p><p><strong>å…³äºç»§æ‰¿å¦‚ä¸‹ 3 ç‚¹è¯·è®°ä½ï¼š</strong></p><ol><li>å­ç±»æ‹¥æœ‰çˆ¶ç±»å¯¹è±¡æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼ˆåŒ…æ‹¬ç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•ï¼‰ï¼Œä½†æ˜¯çˆ¶ç±»ä¸­çš„ç§æœ‰å±æ€§å’Œæ–¹æ³•å­ç±»æ˜¯æ— æ³•è®¿é—®ï¼Œ<strong>åªæ˜¯æ‹¥æœ‰</strong>ã€‚</li><li>å­ç±»å¯ä»¥æ‹¥æœ‰è‡ªå·±å±æ€§å’Œæ–¹æ³•ï¼Œå³å­ç±»å¯ä»¥å¯¹çˆ¶ç±»è¿›è¡Œæ‰©å±•ã€‚</li><li>å­ç±»å¯ä»¥ç”¨è‡ªå·±çš„æ–¹å¼å®ç°çˆ¶ç±»çš„æ–¹æ³•ã€‚ï¼ˆä»¥åä»‹ç»ï¼‰ã€‚</li></ol><h4 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h4><p>æ‰€è°“å¤šæ€å°±æ˜¯æŒ‡ç¨‹åºä¸­å®šä¹‰çš„å¼•ç”¨å˜é‡æ‰€æŒ‡å‘çš„å…·ä½“ç±»å‹å’Œé€šè¿‡è¯¥å¼•ç”¨å˜é‡å‘å‡ºçš„æ–¹æ³•è°ƒç”¨åœ¨ç¼–ç¨‹æ—¶å¹¶ä¸ç¡®å®šï¼Œè€Œæ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ‰ç¡®å®šï¼Œå³ä¸€ä¸ªå¼•ç”¨å˜é‡åˆ°åº•ä¼šæŒ‡å‘å“ªä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè¯¥å¼•ç”¨å˜é‡å‘å‡ºçš„æ–¹æ³•è°ƒç”¨åˆ°åº•æ˜¯å“ªä¸ªç±»ä¸­å®ç°çš„æ–¹æ³•ï¼Œå¿…é¡»åœ¨ç”±ç¨‹åºè¿è¡ŒæœŸé—´æ‰èƒ½å†³å®šã€‚</p><p>åœ¨ Java ä¸­æœ‰ä¸¤ç§å½¢å¼å¯ä»¥å®ç°å¤šæ€ï¼šç»§æ‰¿ï¼ˆå¤šä¸ªå­ç±»å¯¹åŒä¸€æ–¹æ³•çš„é‡å†™ï¼‰å’Œæ¥å£ï¼ˆå®ç°æ¥å£å¹¶è¦†ç›–æ¥å£ä¸­åŒä¸€æ–¹æ³•ï¼‰ã€‚</p><h3 id="12-String-StringBuffer-å’Œ-StringBuilder-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ-String-ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„"><a href="#12-String-StringBuffer-å’Œ-StringBuilder-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ-String-ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„" class="headerlink" title="12. String StringBuffer å’Œ StringBuilder çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ? String ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„?"></a>12. String StringBuffer å’Œ StringBuilder çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ? String ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„?</h3><p><strong>å¯å˜æ€§</strong></p><p>ç®€å•çš„æ¥è¯´ï¼šString ç±»ä¸­ä½¿ç”¨ final å…³é”®å­—ä¿®é¥°å­—ç¬¦æ•°ç»„æ¥ä¿å­˜å­—ç¬¦ä¸²ï¼Œ<code>private final char value[]</code>ï¼Œæ‰€ä»¥ String å¯¹è±¡æ˜¯ä¸å¯å˜çš„ã€‚</p><blockquote><p>è¡¥å……ï¼ˆæ¥è‡ª<a href="https://github.com/Snailclimb/JavaGuide/issues/675">issue 675</a>ï¼‰ï¼šåœ¨ Java 9 ä¹‹åï¼ŒString ç±»çš„å®ç°æ”¹ç”¨ byte æ•°ç»„å­˜å‚¨å­—ç¬¦ä¸² <code>private final byte[] value</code></p></blockquote><p>è€Œ StringBuilder ä¸ StringBuffer éƒ½ç»§æ‰¿è‡ª AbstractStringBuilder ç±»ï¼Œåœ¨ AbstractStringBuilder ä¸­ä¹Ÿæ˜¯ä½¿ç”¨å­—ç¬¦æ•°ç»„ä¿å­˜å­—ç¬¦ä¸²<code>char[]value</code> ä½†æ˜¯æ²¡æœ‰ç”¨ final å…³é”®å­—ä¿®é¥°ï¼Œæ‰€ä»¥è¿™ä¸¤ç§å¯¹è±¡éƒ½æ˜¯å¯å˜çš„ã€‚</p><p>StringBuilder ä¸ StringBuffer çš„æ„é€ æ–¹æ³•éƒ½æ˜¯è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•ä¹Ÿå°±æ˜¯ AbstractStringBuilder å®ç°çš„ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥é˜…æºç ã€‚</p><p><code>AbstractStringBuilder.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractStringBuilder</span> <span class="keyword">implements</span> <span class="title">Appendable</span>, <span class="title">CharSequence</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The value is used for character storage.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">char</span>[] value;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The count is the number of characters used.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line">    AbstractStringBuilder(<span class="keyword">int</span> capacity) &#123;</span><br><span class="line">        value = <span class="keyword">new</span> <span class="keyword">char</span>[capacity];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>çº¿ç¨‹å®‰å…¨æ€§</strong></p><p>String ä¸­çš„å¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œä¹Ÿå°±å¯ä»¥ç†è§£ä¸ºå¸¸é‡ï¼Œçº¿ç¨‹å®‰å…¨ã€‚AbstractStringBuilder æ˜¯ StringBuilder ä¸ StringBuffer çš„å…¬å…±çˆ¶ç±»ï¼Œå®šä¹‰äº†ä¸€äº›å­—ç¬¦ä¸²çš„åŸºæœ¬æ“ä½œï¼Œå¦‚ expandCapacityã€appendã€insertã€indexOf ç­‰å…¬å…±æ–¹æ³•ã€‚StringBuffer å¯¹æ–¹æ³•åŠ äº†åŒæ­¥é”æˆ–è€…å¯¹è°ƒç”¨çš„æ–¹æ³•åŠ äº†åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚StringBuilder å¹¶æ²¡æœ‰å¯¹æ–¹æ³•è¿›è¡ŒåŠ åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚</p><p><strong>æ€§èƒ½</strong></p><p>æ¯æ¬¡å¯¹ String ç±»å‹è¿›è¡Œæ”¹å˜çš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ String å¯¹è±¡ï¼Œç„¶åå°†æŒ‡é’ˆæŒ‡å‘æ–°çš„ String å¯¹è±¡ã€‚StringBuffer æ¯æ¬¡éƒ½ä¼šå¯¹ StringBuffer å¯¹è±¡æœ¬èº«è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯ç”Ÿæˆæ–°çš„å¯¹è±¡å¹¶æ”¹å˜å¯¹è±¡å¼•ç”¨ã€‚ç›¸åŒæƒ…å†µä¸‹ä½¿ç”¨ StringBuilder ç›¸æ¯”ä½¿ç”¨ StringBuffer ä»…èƒ½è·å¾— 10%~15% å·¦å³çš„æ€§èƒ½æå‡ï¼Œä½†å´è¦å†’å¤šçº¿ç¨‹ä¸å®‰å…¨çš„é£é™©ã€‚</p><p><strong>å¯¹äºä¸‰è€…ä½¿ç”¨çš„æ€»ç»“ï¼š</strong></p><ol><li>æ“ä½œå°‘é‡çš„æ•°æ®: é€‚ç”¨ String</li><li>å•çº¿ç¨‹æ“ä½œå­—ç¬¦ä¸²ç¼“å†²åŒºä¸‹æ“ä½œå¤§é‡æ•°æ®: é€‚ç”¨ StringBuilder</li><li>å¤šçº¿ç¨‹æ“ä½œå­—ç¬¦ä¸²ç¼“å†²åŒºä¸‹æ“ä½œå¤§é‡æ•°æ®: é€‚ç”¨ StringBuffer</li></ol><h3 id="13-è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±"><a href="#13-è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±" class="headerlink" title="13. è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±"></a>13. è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±</h3><ul><li><strong>è£…ç®±</strong>ï¼šå°†åŸºæœ¬ç±»å‹ç”¨å®ƒä»¬å¯¹åº”çš„å¼•ç”¨ç±»å‹åŒ…è£…èµ·æ¥ï¼›</li><li><strong>æ‹†ç®±</strong>ï¼šå°†åŒ…è£…ç±»å‹è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼›</li></ul><p>æ›´å¤šå†…å®¹è§ï¼š<a href="https://www.cnblogs.com/dolphin0520/p/3780005.html">æ·±å…¥å‰–æJavaä¸­çš„è£…ç®±å’Œæ‹†ç®±</a></p><h3 id="14-åœ¨ä¸€ä¸ªé™æ€æ–¹æ³•å†…è°ƒç”¨ä¸€ä¸ªéé™æ€æˆå‘˜ä¸ºä»€ä¹ˆæ˜¯éæ³•çš„"><a href="#14-åœ¨ä¸€ä¸ªé™æ€æ–¹æ³•å†…è°ƒç”¨ä¸€ä¸ªéé™æ€æˆå‘˜ä¸ºä»€ä¹ˆæ˜¯éæ³•çš„" class="headerlink" title="14. åœ¨ä¸€ä¸ªé™æ€æ–¹æ³•å†…è°ƒç”¨ä¸€ä¸ªéé™æ€æˆå‘˜ä¸ºä»€ä¹ˆæ˜¯éæ³•çš„?"></a>14. åœ¨ä¸€ä¸ªé™æ€æ–¹æ³•å†…è°ƒç”¨ä¸€ä¸ªéé™æ€æˆå‘˜ä¸ºä»€ä¹ˆæ˜¯éæ³•çš„?</h3><p>ç”±äºé™æ€æ–¹æ³•å¯ä»¥ä¸é€šè¿‡å¯¹è±¡è¿›è¡Œè°ƒç”¨ï¼Œå› æ­¤åœ¨é™æ€æ–¹æ³•é‡Œï¼Œä¸èƒ½è°ƒç”¨å…¶ä»–éé™æ€å˜é‡ï¼Œä¹Ÿä¸å¯ä»¥è®¿é—®éé™æ€å˜é‡æˆå‘˜ã€‚</p><h3 id="15-åœ¨-Java-ä¸­å®šä¹‰ä¸€ä¸ªä¸åšäº‹ä¸”æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•çš„ä½œç”¨"><a href="#15-åœ¨-Java-ä¸­å®šä¹‰ä¸€ä¸ªä¸åšäº‹ä¸”æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•çš„ä½œç”¨" class="headerlink" title="15. åœ¨ Java ä¸­å®šä¹‰ä¸€ä¸ªä¸åšäº‹ä¸”æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•çš„ä½œç”¨"></a>15. åœ¨ Java ä¸­å®šä¹‰ä¸€ä¸ªä¸åšäº‹ä¸”æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•çš„ä½œç”¨</h3><p>Java ç¨‹åºåœ¨æ‰§è¡Œå­ç±»çš„æ„é€ æ–¹æ³•ä¹‹å‰ï¼Œå¦‚æœæ²¡æœ‰ç”¨ <code>super()</code>æ¥è°ƒç”¨çˆ¶ç±»ç‰¹å®šçš„æ„é€ æ–¹æ³•ï¼Œåˆ™ä¼šè°ƒç”¨çˆ¶ç±»ä¸­â€œæ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•â€ã€‚å› æ­¤ï¼Œå¦‚æœçˆ¶ç±»ä¸­åªå®šä¹‰äº†æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œè€Œåœ¨å­ç±»çš„æ„é€ æ–¹æ³•ä¸­åˆæ²¡æœ‰ç”¨ <code>super()</code>æ¥è°ƒç”¨çˆ¶ç±»ä¸­ç‰¹å®šçš„æ„é€ æ–¹æ³•ï¼Œåˆ™ç¼–è¯‘æ—¶å°†å‘ç”Ÿé”™è¯¯ï¼Œå› ä¸º Java ç¨‹åºåœ¨çˆ¶ç±»ä¸­æ‰¾ä¸åˆ°æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•å¯ä¾›æ‰§è¡Œã€‚è§£å†³åŠæ³•æ˜¯åœ¨çˆ¶ç±»é‡ŒåŠ ä¸Šä¸€ä¸ªä¸åšäº‹ä¸”æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ã€‚</p><h3 id="16-import-java-å’Œ-javax-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#16-import-java-å’Œ-javax-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="16. import java å’Œ javax æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>16. import java å’Œ javax æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>åˆšå¼€å§‹çš„æ—¶å€™ JavaAPI æ‰€å¿…éœ€çš„åŒ…æ˜¯ java å¼€å¤´çš„åŒ…ï¼Œjavax å½“æ—¶åªæ˜¯æ‰©å±• API åŒ…æ¥ä½¿ç”¨ã€‚ç„¶è€Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œjavax é€æ¸åœ°æ‰©å±•æˆä¸º Java API çš„ç»„æˆéƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œå°†æ‰©å±•ä» javax åŒ…ç§»åŠ¨åˆ° java åŒ…ç¡®å®å¤ªéº»çƒ¦äº†ï¼Œæœ€ç»ˆä¼šç ´åä¸€å †ç°æœ‰çš„ä»£ç ã€‚å› æ­¤ï¼Œæœ€ç»ˆå†³å®š javax åŒ…å°†æˆä¸ºæ ‡å‡† API çš„ä¸€éƒ¨åˆ†ã€‚</p><p>æ‰€ä»¥ï¼Œå®é™…ä¸Š java å’Œ javax æ²¡æœ‰åŒºåˆ«ã€‚è¿™éƒ½æ˜¯ä¸€ä¸ªåå­—ã€‚</p><h3 id="17-æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#17-æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="17. æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>17. æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ol><li>æ¥å£çš„æ–¹æ³•é»˜è®¤æ˜¯ publicï¼Œæ‰€æœ‰æ–¹æ³•åœ¨æ¥å£ä¸­ä¸èƒ½æœ‰å®ç°(Java 8 å¼€å§‹æ¥å£æ–¹æ³•å¯ä»¥æœ‰é»˜è®¤å®ç°ï¼‰ï¼Œè€ŒæŠ½è±¡ç±»å¯ä»¥æœ‰éæŠ½è±¡çš„æ–¹æ³•ã€‚</li><li>æ¥å£ä¸­é™¤äº† staticã€final å˜é‡ï¼Œä¸èƒ½æœ‰å…¶ä»–å˜é‡ï¼Œè€ŒæŠ½è±¡ç±»ä¸­åˆ™ä¸ä¸€å®šã€‚</li><li>ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œä½†åªèƒ½å®ç°ä¸€ä¸ªæŠ½è±¡ç±»ã€‚æ¥å£è‡ªå·±æœ¬èº«å¯ä»¥é€šè¿‡ extends å…³é”®å­—æ‰©å±•å¤šä¸ªæ¥å£ã€‚</li><li>æ¥å£æ–¹æ³•é»˜è®¤ä¿®é¥°ç¬¦æ˜¯ publicï¼ŒæŠ½è±¡æ–¹æ³•å¯ä»¥æœ‰ publicã€protected å’Œ default è¿™äº›ä¿®é¥°ç¬¦ï¼ˆæŠ½è±¡æ–¹æ³•å°±æ˜¯ä¸ºäº†è¢«é‡å†™æ‰€ä»¥ä¸èƒ½ä½¿ç”¨ private å…³é”®å­—ä¿®é¥°ï¼ï¼‰ã€‚</li><li>ä»è®¾è®¡å±‚é¢æ¥è¯´ï¼ŒæŠ½è±¡æ˜¯å¯¹ç±»çš„æŠ½è±¡ï¼Œæ˜¯ä¸€ç§æ¨¡æ¿è®¾è®¡ï¼Œè€Œæ¥å£æ˜¯å¯¹è¡Œä¸ºçš„æŠ½è±¡ï¼Œæ˜¯ä¸€ç§è¡Œä¸ºçš„è§„èŒƒã€‚</li></ol><blockquote><p>å¤‡æ³¨ï¼š</p><ol><li>åœ¨ JDK8 ä¸­ï¼Œæ¥å£ä¹Ÿå¯ä»¥å®šä¹‰é™æ€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥ç”¨æ¥å£åè°ƒç”¨ã€‚å®ç°ç±»å’Œå®ç°æ˜¯ä¸å¯ä»¥è°ƒç”¨çš„ã€‚å¦‚æœåŒæ—¶å®ç°ä¸¤ä¸ªæ¥å£ï¼Œæ¥å£ä¸­å®šä¹‰äº†ä¸€æ ·çš„é»˜è®¤æ–¹æ³•ï¼Œåˆ™å¿…é¡»é‡å†™ï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚(è¯¦è§ issue:<a href="https://github.com/Snailclimb/JavaGuide/issues/146">https://github.com/Snailclimb/JavaGuide/issues/146</a>ã€‚</li><li>jdk9 çš„æ¥å£è¢«å…è®¸å®šä¹‰ç§æœ‰æ–¹æ³• ã€‚</li></ol></blockquote><p>æ€»ç»“ä¸€ä¸‹ jdk7~jdk9 Java ä¸­æ¥å£æ¦‚å¿µçš„å˜åŒ–ï¼ˆ<a href="https://www.geeksforgeeks.org/private-methods-java-9-interfaces/">ç›¸å…³é˜…è¯»</a>ï¼‰ï¼š</p><ol><li>åœ¨ jdk 7 æˆ–æ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œæ¥å£é‡Œé¢åªèƒ½æœ‰å¸¸é‡å˜é‡å’ŒæŠ½è±¡æ–¹æ³•ã€‚è¿™äº›æ¥å£æ–¹æ³•å¿…é¡»ç”±é€‰æ‹©å®ç°æ¥å£çš„ç±»å®ç°ã€‚</li><li>jdk8 çš„æ—¶å€™æ¥å£å¯ä»¥æœ‰é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•åŠŸèƒ½ã€‚</li><li>Jdk 9 åœ¨æ¥å£ä¸­å¼•å…¥äº†ç§æœ‰æ–¹æ³•å’Œç§æœ‰é™æ€æ–¹æ³•ã€‚</li></ol><h3 id="18-æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ"><a href="#18-æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="18. æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ"></a>18. æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ</h3><ol><li>ä»è¯­æ³•å½¢å¼ä¸Šçœ‹:æˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ï¼Œè€Œå±€éƒ¨å˜é‡æ˜¯åœ¨æ–¹æ³•ä¸­å®šä¹‰çš„å˜é‡æˆ–æ˜¯æ–¹æ³•çš„å‚æ•°ï¼›æˆå‘˜å˜é‡å¯ä»¥è¢« public,private,static ç­‰ä¿®é¥°ç¬¦æ‰€ä¿®é¥°ï¼Œè€Œå±€éƒ¨å˜é‡ä¸èƒ½è¢«è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦åŠ static æ‰€ä¿®é¥°ï¼›ä½†æ˜¯ï¼Œæˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡éƒ½èƒ½è¢« final æ‰€ä¿®é¥°ã€‚</li><li>ä»å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼æ¥çœ‹:å¦‚æœæˆå‘˜å˜é‡æ˜¯ä½¿ç”¨<code>static</code>ä¿®é¥°çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨<code>static</code>ä¿®é¥°ï¼Œè¿™ä¸ªæˆå‘˜å˜é‡æ˜¯å±äºå®ä¾‹çš„ã€‚è€Œå¯¹è±¡å­˜åœ¨äºå †å†…å­˜ï¼Œå±€éƒ¨å˜é‡åˆ™å­˜åœ¨äºæ ˆå†…å­˜ã€‚</li><li>ä»å˜é‡åœ¨å†…å­˜ä¸­çš„ç”Ÿå­˜æ—¶é—´ä¸Šçœ‹:æˆå‘˜å˜é‡æ˜¯å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒéšç€å¯¹è±¡çš„åˆ›å»ºè€Œå­˜åœ¨ï¼Œè€Œå±€éƒ¨å˜é‡éšç€æ–¹æ³•çš„è°ƒç”¨è€Œè‡ªåŠ¨æ¶ˆå¤±ã€‚</li><li>æˆå‘˜å˜é‡å¦‚æœæ²¡æœ‰è¢«èµ‹åˆå€¼:åˆ™ä¼šè‡ªåŠ¨ä»¥ç±»å‹çš„é»˜è®¤å€¼è€Œèµ‹å€¼ï¼ˆä¸€ç§æƒ…å†µä¾‹å¤–:è¢« final ä¿®é¥°çš„æˆå‘˜å˜é‡ä¹Ÿå¿…é¡»æ˜¾å¼åœ°èµ‹å€¼ï¼‰ï¼Œè€Œå±€éƒ¨å˜é‡åˆ™ä¸ä¼šè‡ªåŠ¨èµ‹å€¼ã€‚</li></ol><h3 id="19-åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç”¨ä»€ä¹ˆè¿ç®—ç¬¦-å¯¹è±¡å®ä½“ä¸å¯¹è±¡å¼•ç”¨æœ‰ä½•ä¸åŒ"><a href="#19-åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç”¨ä»€ä¹ˆè¿ç®—ç¬¦-å¯¹è±¡å®ä½“ä¸å¯¹è±¡å¼•ç”¨æœ‰ä½•ä¸åŒ" class="headerlink" title="19. åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç”¨ä»€ä¹ˆè¿ç®—ç¬¦?å¯¹è±¡å®ä½“ä¸å¯¹è±¡å¼•ç”¨æœ‰ä½•ä¸åŒ?"></a>19. åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç”¨ä»€ä¹ˆè¿ç®—ç¬¦?å¯¹è±¡å®ä½“ä¸å¯¹è±¡å¼•ç”¨æœ‰ä½•ä¸åŒ?</h3><p>new è¿ç®—ç¬¦ï¼Œnew åˆ›å»ºå¯¹è±¡å®ä¾‹ï¼ˆå¯¹è±¡å®ä¾‹åœ¨å †å†…å­˜ä¸­ï¼‰ï¼Œå¯¹è±¡å¼•ç”¨æŒ‡å‘å¯¹è±¡å®ä¾‹ï¼ˆå¯¹è±¡å¼•ç”¨å­˜æ”¾åœ¨æ ˆå†…å­˜ä¸­ï¼‰ã€‚ä¸€ä¸ªå¯¹è±¡å¼•ç”¨å¯ä»¥æŒ‡å‘ 0 ä¸ªæˆ– 1 ä¸ªå¯¹è±¡ï¼ˆä¸€æ ¹ç»³å­å¯ä»¥ä¸ç³»æ°”çƒï¼Œä¹Ÿå¯ä»¥ç³»ä¸€ä¸ªæ°”çƒï¼‰;ä¸€ä¸ªå¯¹è±¡å¯ä»¥æœ‰ n ä¸ªå¼•ç”¨æŒ‡å‘å®ƒï¼ˆå¯ä»¥ç”¨ n æ¡ç»³å­ç³»ä½ä¸€ä¸ªæ°”çƒï¼‰ã€‚</p><h3 id="20-ä»€ä¹ˆæ˜¯æ–¹æ³•çš„è¿”å›å€¼-è¿”å›å€¼åœ¨ç±»çš„æ–¹æ³•é‡Œçš„ä½œç”¨æ˜¯ä»€ä¹ˆ"><a href="#20-ä»€ä¹ˆæ˜¯æ–¹æ³•çš„è¿”å›å€¼-è¿”å›å€¼åœ¨ç±»çš„æ–¹æ³•é‡Œçš„ä½œç”¨æ˜¯ä»€ä¹ˆ" class="headerlink" title="20. ä»€ä¹ˆæ˜¯æ–¹æ³•çš„è¿”å›å€¼?è¿”å›å€¼åœ¨ç±»çš„æ–¹æ³•é‡Œçš„ä½œç”¨æ˜¯ä»€ä¹ˆ?"></a>20. ä»€ä¹ˆæ˜¯æ–¹æ³•çš„è¿”å›å€¼?è¿”å›å€¼åœ¨ç±»çš„æ–¹æ³•é‡Œçš„ä½œç”¨æ˜¯ä»€ä¹ˆ?</h3><p>æ–¹æ³•çš„è¿”å›å€¼æ˜¯æŒ‡æˆ‘ä»¬è·å–åˆ°çš„æŸä¸ªæ–¹æ³•ä½“ä¸­çš„ä»£ç æ‰§è¡Œåäº§ç”Ÿçš„ç»“æœï¼ï¼ˆå‰ææ˜¯è¯¥æ–¹æ³•å¯èƒ½äº§ç”Ÿç»“æœï¼‰ã€‚è¿”å›å€¼çš„ä½œç”¨:æ¥æ”¶å‡ºç»“æœï¼Œä½¿å¾—å®ƒå¯ä»¥ç”¨äºå…¶ä»–çš„æ“ä½œï¼</p><h3 id="21-ä¸€ä¸ªç±»çš„æ„é€ æ–¹æ³•çš„ä½œç”¨æ˜¯ä»€ä¹ˆ-è‹¥ä¸€ä¸ªç±»æ²¡æœ‰å£°æ˜æ„é€ æ–¹æ³•ï¼Œè¯¥ç¨‹åºèƒ½æ­£ç¡®æ‰§è¡Œå—-ä¸ºä»€ä¹ˆ"><a href="#21-ä¸€ä¸ªç±»çš„æ„é€ æ–¹æ³•çš„ä½œç”¨æ˜¯ä»€ä¹ˆ-è‹¥ä¸€ä¸ªç±»æ²¡æœ‰å£°æ˜æ„é€ æ–¹æ³•ï¼Œè¯¥ç¨‹åºèƒ½æ­£ç¡®æ‰§è¡Œå—-ä¸ºä»€ä¹ˆ" class="headerlink" title="21. ä¸€ä¸ªç±»çš„æ„é€ æ–¹æ³•çš„ä½œç”¨æ˜¯ä»€ä¹ˆ? è‹¥ä¸€ä¸ªç±»æ²¡æœ‰å£°æ˜æ„é€ æ–¹æ³•ï¼Œè¯¥ç¨‹åºèƒ½æ­£ç¡®æ‰§è¡Œå—? ä¸ºä»€ä¹ˆ?"></a>21. ä¸€ä¸ªç±»çš„æ„é€ æ–¹æ³•çš„ä½œç”¨æ˜¯ä»€ä¹ˆ? è‹¥ä¸€ä¸ªç±»æ²¡æœ‰å£°æ˜æ„é€ æ–¹æ³•ï¼Œè¯¥ç¨‹åºèƒ½æ­£ç¡®æ‰§è¡Œå—? ä¸ºä»€ä¹ˆ?</h3><p>ä¸»è¦ä½œç”¨æ˜¯å®Œæˆå¯¹ç±»å¯¹è±¡çš„åˆå§‹åŒ–å·¥ä½œã€‚å¯ä»¥æ‰§è¡Œã€‚å› ä¸ºä¸€ä¸ªç±»å³ä½¿æ²¡æœ‰å£°æ˜æ„é€ æ–¹æ³•ä¹Ÿä¼šæœ‰é»˜è®¤çš„ä¸å¸¦å‚æ•°çš„æ„é€ æ–¹æ³•ã€‚</p><h3 id="22-æ„é€ æ–¹æ³•æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ"><a href="#22-æ„é€ æ–¹æ³•æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ" class="headerlink" title="22. æ„é€ æ–¹æ³•æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ"></a>22. æ„é€ æ–¹æ³•æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ</h3><ol><li>åå­—ä¸ç±»åç›¸åŒã€‚</li><li>æ²¡æœ‰è¿”å›å€¼ï¼Œä½†ä¸èƒ½ç”¨ void å£°æ˜æ„é€ å‡½æ•°ã€‚</li><li>ç”Ÿæˆç±»çš„å¯¹è±¡æ—¶è‡ªåŠ¨æ‰§è¡Œï¼Œæ— éœ€è°ƒç”¨ã€‚</li></ol><h3 id="23-é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•æœ‰ä½•ä¸åŒ"><a href="#23-é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•æœ‰ä½•ä¸åŒ" class="headerlink" title="23. é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•æœ‰ä½•ä¸åŒ"></a>23. é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•æœ‰ä½•ä¸åŒ</h3><ol><li><p>åœ¨å¤–éƒ¨è°ƒç”¨é™æ€æ–¹æ³•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨â€ç±»å.æ–¹æ³•åâ€çš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨â€å¯¹è±¡å.æ–¹æ³•åâ€çš„æ–¹å¼ã€‚è€Œå®ä¾‹æ–¹æ³•åªæœ‰åé¢è¿™ç§æ–¹å¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè°ƒç”¨é™æ€æ–¹æ³•å¯ä»¥æ— éœ€åˆ›å»ºå¯¹è±¡ã€‚</p></li><li><p>é™æ€æ–¹æ³•åœ¨è®¿é—®æœ¬ç±»çš„æˆå‘˜æ—¶ï¼Œåªå…è®¸è®¿é—®é™æ€æˆå‘˜ï¼ˆå³é™æ€æˆå‘˜å˜é‡å’Œé™æ€æ–¹æ³•ï¼‰ï¼Œè€Œä¸å…è®¸è®¿é—®å®ä¾‹æˆå‘˜å˜é‡å’Œå®ä¾‹æ–¹æ³•ï¼›å®ä¾‹æ–¹æ³•åˆ™æ— æ­¤é™åˆ¶ã€‚</p></li></ol><h3 id="24-å¯¹è±¡çš„ç›¸ç­‰ä¸æŒ‡å‘ä»–ä»¬çš„å¼•ç”¨ç›¸ç­‰-ä¸¤è€…æœ‰ä»€ä¹ˆä¸åŒ"><a href="#24-å¯¹è±¡çš„ç›¸ç­‰ä¸æŒ‡å‘ä»–ä»¬çš„å¼•ç”¨ç›¸ç­‰-ä¸¤è€…æœ‰ä»€ä¹ˆä¸åŒ" class="headerlink" title="24. å¯¹è±¡çš„ç›¸ç­‰ä¸æŒ‡å‘ä»–ä»¬çš„å¼•ç”¨ç›¸ç­‰,ä¸¤è€…æœ‰ä»€ä¹ˆä¸åŒ?"></a>24. å¯¹è±¡çš„ç›¸ç­‰ä¸æŒ‡å‘ä»–ä»¬çš„å¼•ç”¨ç›¸ç­‰,ä¸¤è€…æœ‰ä»€ä¹ˆä¸åŒ?</h3><p>å¯¹è±¡çš„ç›¸ç­‰ï¼Œæ¯”çš„æ˜¯å†…å­˜ä¸­å­˜æ”¾çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ã€‚è€Œå¼•ç”¨ç›¸ç­‰ï¼Œæ¯”è¾ƒçš„æ˜¯ä»–ä»¬æŒ‡å‘çš„å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰ã€‚</p><h3 id="25-åœ¨è°ƒç”¨å­ç±»æ„é€ æ–¹æ³•ä¹‹å‰ä¼šå…ˆè°ƒç”¨çˆ¶ç±»æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•-å…¶ç›®çš„æ˜¯"><a href="#25-åœ¨è°ƒç”¨å­ç±»æ„é€ æ–¹æ³•ä¹‹å‰ä¼šå…ˆè°ƒç”¨çˆ¶ç±»æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•-å…¶ç›®çš„æ˜¯" class="headerlink" title="25. åœ¨è°ƒç”¨å­ç±»æ„é€ æ–¹æ³•ä¹‹å‰ä¼šå…ˆè°ƒç”¨çˆ¶ç±»æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•,å…¶ç›®çš„æ˜¯?"></a>25. åœ¨è°ƒç”¨å­ç±»æ„é€ æ–¹æ³•ä¹‹å‰ä¼šå…ˆè°ƒç”¨çˆ¶ç±»æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•,å…¶ç›®çš„æ˜¯?</h3><p>å¸®åŠ©å­ç±»åšåˆå§‹åŒ–å·¥ä½œã€‚</p><h3 id="26-ä¸-equals-é‡è¦"><a href="#26-ä¸-equals-é‡è¦" class="headerlink" title="26. == ä¸ equals(é‡è¦)"></a>26. == ä¸ equals(é‡è¦)</h3><p><strong>==</strong> : å®ƒçš„ä½œç”¨æ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„åœ°å€æ˜¯ä¸æ˜¯ç›¸ç­‰ã€‚å³ï¼Œåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡(åŸºæœ¬æ•°æ®ç±»å‹==æ¯”è¾ƒçš„æ˜¯å€¼ï¼Œå¼•ç”¨æ•°æ®ç±»å‹==æ¯”è¾ƒçš„æ˜¯å†…å­˜åœ°å€)ã€‚</p><p><strong>equals()</strong> : å®ƒçš„ä½œç”¨ä¹Ÿæ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚ä½†å®ƒä¸€èˆ¬æœ‰ä¸¤ç§ä½¿ç”¨æƒ…å†µï¼š</p><ul><li>æƒ…å†µ 1ï¼šç±»æ²¡æœ‰è¦†ç›– equals() æ–¹æ³•ã€‚åˆ™é€šè¿‡ equals() æ¯”è¾ƒè¯¥ç±»çš„ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œç­‰ä»·äºé€šè¿‡â€œ==â€æ¯”è¾ƒè¿™ä¸¤ä¸ªå¯¹è±¡ã€‚</li><li>æƒ…å†µ 2ï¼šç±»è¦†ç›–äº† equals() æ–¹æ³•ã€‚ä¸€èˆ¬ï¼Œæˆ‘ä»¬éƒ½è¦†ç›– equals() æ–¹æ³•æ¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ï¼›è‹¥å®ƒä»¬çš„å†…å®¹ç›¸ç­‰ï¼Œåˆ™è¿”å› true (å³ï¼Œè®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰)ã€‚</li></ul><p><strong>ä¸¾ä¸ªä¾‹å­ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String a = <span class="keyword">new</span> String(<span class="string">"ab"</span>); <span class="comment">// a ä¸ºä¸€ä¸ªå¼•ç”¨</span></span><br><span class="line">        String b = <span class="keyword">new</span> String(<span class="string">"ab"</span>); <span class="comment">// bä¸ºå¦ä¸€ä¸ªå¼•ç”¨,å¯¹è±¡çš„å†…å®¹ä¸€æ ·</span></span><br><span class="line">        String aa = <span class="string">"ab"</span>; <span class="comment">// æ”¾åœ¨å¸¸é‡æ± ä¸­</span></span><br><span class="line">        String bb = <span class="string">"ab"</span>; <span class="comment">// ä»å¸¸é‡æ± ä¸­æŸ¥æ‰¾</span></span><br><span class="line">        <span class="keyword">if</span> (aa == bb) <span class="comment">// true</span></span><br><span class="line">            System.out.println(<span class="string">"aa==bb"</span>);</span><br><span class="line">        <span class="keyword">if</span> (a == b) <span class="comment">// falseï¼ŒéåŒä¸€å¯¹è±¡</span></span><br><span class="line">            System.out.println(<span class="string">"a==b"</span>);</span><br><span class="line">        <span class="keyword">if</span> (a.equals(b)) <span class="comment">// true</span></span><br><span class="line">            System.out.println(<span class="string">"aEQb"</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">42</span> == <span class="number">42.0</span>) &#123; <span class="comment">// true</span></span><br><span class="line">            System.out.println(<span class="string">"true"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜ï¼š</strong></p><ul><li>String ä¸­çš„ equals æ–¹æ³•æ˜¯è¢«é‡å†™è¿‡çš„ï¼Œå› ä¸º object çš„ equals æ–¹æ³•æ˜¯æ¯”è¾ƒçš„å¯¹è±¡çš„å†…å­˜åœ°å€ï¼Œè€Œ String çš„ equals æ–¹æ³•æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å€¼ã€‚</li><li>å½“åˆ›å»º String ç±»å‹çš„å¯¹è±¡æ—¶ï¼Œè™šæ‹Ÿæœºä¼šåœ¨å¸¸é‡æ± ä¸­æŸ¥æ‰¾æœ‰æ²¡æœ‰å·²ç»å­˜åœ¨çš„å€¼å’Œè¦åˆ›å»ºçš„å€¼ç›¸åŒçš„å¯¹è±¡ï¼Œå¦‚æœæœ‰å°±æŠŠå®ƒèµ‹ç»™å½“å‰å¼•ç”¨ã€‚å¦‚æœæ²¡æœ‰å°±åœ¨å¸¸é‡æ± ä¸­é‡æ–°åˆ›å»ºä¸€ä¸ª String å¯¹è±¡ã€‚</li></ul><h3 id="27-hashCode-ä¸-equals-é‡è¦"><a href="#27-hashCode-ä¸-equals-é‡è¦" class="headerlink" title="27. hashCode ä¸ equals (é‡è¦)"></a>27. hashCode ä¸ equals (é‡è¦)</h3><p>é¢è¯•å®˜å¯èƒ½ä¼šé—®ä½ ï¼šâ€œä½ é‡å†™è¿‡ hashcode å’Œ equals ä¹ˆï¼Œä¸ºä»€ä¹ˆé‡å†™ equals æ—¶å¿…é¡»é‡å†™ hashCode æ–¹æ³•ï¼Ÿâ€</p><h4 id="hashCodeï¼ˆï¼‰ä»‹ç»"><a href="#hashCodeï¼ˆï¼‰ä»‹ç»" class="headerlink" title="hashCodeï¼ˆï¼‰ä»‹ç»"></a>hashCodeï¼ˆï¼‰ä»‹ç»</h4><p>hashCode() çš„ä½œç”¨æ˜¯è·å–å“ˆå¸Œç ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ï¼›å®ƒå®é™…ä¸Šæ˜¯è¿”å›ä¸€ä¸ª int æ•´æ•°ã€‚è¿™ä¸ªå“ˆå¸Œç çš„ä½œç”¨æ˜¯ç¡®å®šè¯¥å¯¹è±¡åœ¨å“ˆå¸Œè¡¨ä¸­çš„ç´¢å¼•ä½ç½®ã€‚hashCode() å®šä¹‰åœ¨ JDK çš„ Object.java ä¸­ï¼Œè¿™å°±æ„å‘³ç€ Java ä¸­çš„ä»»ä½•ç±»éƒ½åŒ…å«æœ‰ hashCode() å‡½æ•°ã€‚</p><p>æ•£åˆ—è¡¨å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹(key-value)ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼šèƒ½æ ¹æ®â€œé”®â€å¿«é€Ÿçš„æ£€ç´¢å‡ºå¯¹åº”çš„â€œå€¼â€ã€‚è¿™å…¶ä¸­å°±åˆ©ç”¨åˆ°äº†æ•£åˆ—ç ï¼ï¼ˆå¯ä»¥å¿«é€Ÿæ‰¾åˆ°æ‰€éœ€è¦çš„å¯¹è±¡ï¼‰</p><h4 id="ä¸ºä»€ä¹ˆè¦æœ‰-hashCode"><a href="#ä¸ºä»€ä¹ˆè¦æœ‰-hashCode" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æœ‰ hashCode"></a>ä¸ºä»€ä¹ˆè¦æœ‰ hashCode</h4><p><strong>æˆ‘ä»¬å…ˆä»¥â€œHashSet å¦‚ä½•æ£€æŸ¥é‡å¤â€ä¸ºä¾‹å­æ¥è¯´æ˜ä¸ºä»€ä¹ˆè¦æœ‰ hashCodeï¼š</strong> å½“ä½ æŠŠå¯¹è±¡åŠ å…¥ HashSet æ—¶ï¼ŒHashSet ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ hashcode å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼ŒåŒæ—¶ä¹Ÿä¼šä¸è¯¥ä½ç½®å…¶ä»–å·²ç»åŠ å…¥çš„å¯¹è±¡çš„ hashcode å€¼ä½œæ¯”è¾ƒï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„ hashcodeï¼ŒHashSet ä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒ hashcode å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ <code>equals()</code>æ–¹æ³•æ¥æ£€æŸ¥ hashcode ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼ŒHashSet å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚ï¼ˆæ‘˜è‡ªæˆ‘çš„ Java å¯è’™ä¹¦ã€ŠHead first javaã€‹ç¬¬äºŒç‰ˆï¼‰ã€‚è¿™æ ·æˆ‘ä»¬å°±å¤§å¤§å‡å°‘äº† equals çš„æ¬¡æ•°ï¼Œç›¸åº”å°±å¤§å¤§æé«˜äº†æ‰§è¡Œé€Ÿåº¦ã€‚</p><p>é€šè¿‡æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š<code>hashCode()</code> çš„ä½œç”¨å°±æ˜¯<strong>è·å–å“ˆå¸Œç </strong>ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ï¼›å®ƒå®é™…ä¸Šæ˜¯è¿”å›ä¸€ä¸ª int æ•´æ•°ã€‚è¿™ä¸ª<strong>å“ˆå¸Œç çš„ä½œç”¨</strong>æ˜¯ç¡®å®šè¯¥å¯¹è±¡åœ¨å“ˆå¸Œè¡¨ä¸­çš„ç´¢å¼•ä½ç½®ã€‚<strong><code>hashCode()</code>åœ¨æ•£åˆ—è¡¨ä¸­æ‰æœ‰ç”¨ï¼Œåœ¨å…¶å®ƒæƒ…å†µä¸‹æ²¡ç”¨</strong>ã€‚åœ¨æ•£åˆ—è¡¨ä¸­ hashCode() çš„ä½œç”¨æ˜¯è·å–å¯¹è±¡çš„æ•£åˆ—ç ï¼Œè¿›è€Œç¡®å®šè¯¥å¯¹è±¡åœ¨æ•£åˆ—è¡¨ä¸­çš„ä½ç½®ã€‚</p><h4 id="hashCodeï¼ˆï¼‰ä¸-equalsï¼ˆï¼‰çš„ç›¸å…³è§„å®š"><a href="#hashCodeï¼ˆï¼‰ä¸-equalsï¼ˆï¼‰çš„ç›¸å…³è§„å®š" class="headerlink" title="hashCodeï¼ˆï¼‰ä¸ equalsï¼ˆï¼‰çš„ç›¸å…³è§„å®š"></a>hashCodeï¼ˆï¼‰ä¸ equalsï¼ˆï¼‰çš„ç›¸å…³è§„å®š</h4><ol><li>å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œåˆ™ hashcode ä¸€å®šä¹Ÿæ˜¯ç›¸åŒçš„</li><li>ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰,å¯¹ä¸¤ä¸ªå¯¹è±¡åˆ†åˆ«è°ƒç”¨ equals æ–¹æ³•éƒ½è¿”å› true</li><li>ä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„ hashcode å€¼ï¼Œå®ƒä»¬ä¹Ÿä¸ä¸€å®šæ˜¯ç›¸ç­‰çš„</li><li><strong>å› æ­¤ï¼Œequals æ–¹æ³•è¢«è¦†ç›–è¿‡ï¼Œåˆ™ hashCode æ–¹æ³•ä¹Ÿå¿…é¡»è¢«è¦†ç›–</strong></li><li>hashCode() çš„é»˜è®¤è¡Œä¸ºæ˜¯å¯¹å †ä¸Šçš„å¯¹è±¡äº§ç”Ÿç‹¬ç‰¹å€¼ã€‚å¦‚æœæ²¡æœ‰é‡å†™ hashCode()ï¼Œåˆ™è¯¥ class çš„ä¸¤ä¸ªå¯¹è±¡æ— è®ºå¦‚ä½•éƒ½ä¸ä¼šç›¸ç­‰ï¼ˆå³ä½¿è¿™ä¸¤ä¸ªå¯¹è±¡æŒ‡å‘ç›¸åŒçš„æ•°æ®ï¼‰</li></ol><p>æ¨èé˜…è¯»ï¼š<a href="https://www.cnblogs.com/skywang12345/p/3324958.html">Java hashCode() å’Œ equals()çš„è‹¥å¹²é—®é¢˜è§£ç­”</a></p><h3 id="28-ä¸ºä»€ä¹ˆ-Java-ä¸­åªæœ‰å€¼ä¼ é€’ï¼Ÿ"><a href="#28-ä¸ºä»€ä¹ˆ-Java-ä¸­åªæœ‰å€¼ä¼ é€’ï¼Ÿ" class="headerlink" title="28. ä¸ºä»€ä¹ˆ Java ä¸­åªæœ‰å€¼ä¼ é€’ï¼Ÿ"></a>28. ä¸ºä»€ä¹ˆ Java ä¸­åªæœ‰å€¼ä¼ é€’ï¼Ÿ</h3><p><a href="https://juejin.im/post/5e18879e6fb9a02fc63602e2">ä¸ºä»€ä¹ˆ Java ä¸­åªæœ‰å€¼ä¼ é€’ï¼Ÿ</a></p><h3 id="29-ç®€è¿°çº¿ç¨‹ã€ç¨‹åºã€è¿›ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€‚ä»¥åŠä»–ä»¬ä¹‹é—´å…³ç³»æ˜¯ä»€ä¹ˆ"><a href="#29-ç®€è¿°çº¿ç¨‹ã€ç¨‹åºã€è¿›ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€‚ä»¥åŠä»–ä»¬ä¹‹é—´å…³ç³»æ˜¯ä»€ä¹ˆ" class="headerlink" title="29. ç®€è¿°çº¿ç¨‹ã€ç¨‹åºã€è¿›ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€‚ä»¥åŠä»–ä»¬ä¹‹é—´å…³ç³»æ˜¯ä»€ä¹ˆ?"></a>29. ç®€è¿°çº¿ç¨‹ã€ç¨‹åºã€è¿›ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€‚ä»¥åŠä»–ä»¬ä¹‹é—´å…³ç³»æ˜¯ä»€ä¹ˆ?</h3><p><strong>çº¿ç¨‹</strong>ä¸è¿›ç¨‹ç›¸ä¼¼ï¼Œä½†çº¿ç¨‹æ˜¯ä¸€ä¸ªæ¯”è¿›ç¨‹æ›´å°çš„æ‰§è¡Œå•ä½ã€‚ä¸€ä¸ªè¿›ç¨‹åœ¨å…¶æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å¯ä»¥äº§ç”Ÿå¤šä¸ªçº¿ç¨‹ã€‚ä¸è¿›ç¨‹ä¸åŒçš„æ˜¯åŒç±»çš„å¤šä¸ªçº¿ç¨‹å…±äº«åŒä¸€å—å†…å­˜ç©ºé—´å’Œä¸€ç»„ç³»ç»Ÿèµ„æºï¼Œæ‰€ä»¥ç³»ç»Ÿåœ¨äº§ç”Ÿä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ–æ˜¯åœ¨å„ä¸ªçº¿ç¨‹ä¹‹é—´ä½œåˆ‡æ¢å·¥ä½œæ—¶ï¼Œè´Ÿæ‹…è¦æ¯”è¿›ç¨‹å°å¾—å¤šï¼Œä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œçº¿ç¨‹ä¹Ÿè¢«ç§°ä¸ºè½»é‡çº§è¿›ç¨‹ã€‚</p><p><strong>ç¨‹åº</strong>æ˜¯å«æœ‰æŒ‡ä»¤å’Œæ•°æ®çš„æ–‡ä»¶ï¼Œè¢«å­˜å‚¨åœ¨ç£ç›˜æˆ–å…¶ä»–çš„æ•°æ®å­˜å‚¨è®¾å¤‡ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ç¨‹åºæ˜¯é™æ€çš„ä»£ç ã€‚</p><p><strong>è¿›ç¨‹</strong>æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œæ˜¯ç³»ç»Ÿè¿è¡Œç¨‹åºçš„åŸºæœ¬å•ä½ï¼Œå› æ­¤è¿›ç¨‹æ˜¯åŠ¨æ€çš„ã€‚ç³»ç»Ÿè¿è¡Œä¸€ä¸ªç¨‹åºå³æ˜¯ä¸€ä¸ªè¿›ç¨‹ä»åˆ›å»ºï¼Œè¿è¡Œåˆ°æ¶ˆäº¡çš„è¿‡ç¨‹ã€‚ç®€å•æ¥è¯´ï¼Œä¸€ä¸ªè¿›ç¨‹å°±æ˜¯ä¸€ä¸ªæ‰§è¡Œä¸­çš„ç¨‹åºï¼Œå®ƒåœ¨è®¡ç®—æœºä¸­ä¸€ä¸ªæŒ‡ä»¤æ¥ç€ä¸€ä¸ªæŒ‡ä»¤åœ°æ‰§è¡Œç€ï¼ŒåŒæ—¶ï¼Œæ¯ä¸ªè¿›ç¨‹è¿˜å æœ‰æŸäº›ç³»ç»Ÿèµ„æºå¦‚ CPU æ—¶é—´ï¼Œå†…å­˜ç©ºé—´ï¼Œæ–‡ä»¶ï¼Œè¾“å…¥è¾“å‡ºè®¾å¤‡çš„ä½¿ç”¨æƒç­‰ç­‰ã€‚æ¢å¥è¯è¯´ï¼Œå½“ç¨‹åºåœ¨æ‰§è¡Œæ—¶ï¼Œå°†ä¼šè¢«æ“ä½œç³»ç»Ÿè½½å…¥å†…å­˜ä¸­ã€‚<br>çº¿ç¨‹æ˜¯è¿›ç¨‹åˆ’åˆ†æˆçš„æ›´å°çš„è¿è¡Œå•ä½ã€‚çº¿ç¨‹å’Œè¿›ç¨‹æœ€å¤§çš„ä¸åŒåœ¨äºåŸºæœ¬ä¸Šå„è¿›ç¨‹æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œå„çº¿ç¨‹åˆ™ä¸ä¸€å®šï¼Œå› ä¸ºåŒä¸€è¿›ç¨‹ä¸­çš„çº¿ç¨‹ææœ‰å¯èƒ½ä¼šç›¸äº’å½±å“ã€‚ä»å¦ä¸€è§’åº¦æ¥è¯´ï¼Œè¿›ç¨‹å±äºæ“ä½œç³»ç»Ÿçš„èŒƒç•´ï¼Œä¸»è¦æ˜¯åŒä¸€æ®µæ—¶é—´å†…ï¼Œå¯ä»¥åŒæ—¶æ‰§è¡Œä¸€ä¸ªä»¥ä¸Šçš„ç¨‹åºï¼Œè€Œçº¿ç¨‹åˆ™æ˜¯åœ¨åŒä¸€ç¨‹åºå†…å‡ ä¹åŒæ—¶æ‰§è¡Œä¸€ä¸ªä»¥ä¸Šçš„ç¨‹åºæ®µã€‚</p><h3 id="30-çº¿ç¨‹æœ‰å“ªäº›åŸºæœ¬çŠ¶æ€"><a href="#30-çº¿ç¨‹æœ‰å“ªäº›åŸºæœ¬çŠ¶æ€" class="headerlink" title="30. çº¿ç¨‹æœ‰å“ªäº›åŸºæœ¬çŠ¶æ€?"></a>30. çº¿ç¨‹æœ‰å“ªäº›åŸºæœ¬çŠ¶æ€?</h3><p>Java çº¿ç¨‹åœ¨è¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­çš„æŒ‡å®šæ—¶åˆ»åªå¯èƒ½å¤„äºä¸‹é¢ 6 ç§ä¸åŒçŠ¶æ€çš„å…¶ä¸­ä¸€ä¸ªçŠ¶æ€ï¼ˆå›¾æºã€ŠJava å¹¶å‘ç¼–ç¨‹è‰ºæœ¯ã€‹4.1.4 èŠ‚ï¼‰ã€‚</p><p><img src="https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/19-1-29/Java%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%8A%B6%E6%80%81.png" alt="Javaçº¿ç¨‹çš„çŠ¶æ€"></p><p>çº¿ç¨‹åœ¨ç”Ÿå‘½å‘¨æœŸä¸­å¹¶ä¸æ˜¯å›ºå®šå¤„äºæŸä¸€ä¸ªçŠ¶æ€è€Œæ˜¯éšç€ä»£ç çš„æ‰§è¡Œåœ¨ä¸åŒçŠ¶æ€ä¹‹é—´åˆ‡æ¢ã€‚Java çº¿ç¨‹çŠ¶æ€å˜è¿å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå›¾æºã€ŠJava å¹¶å‘ç¼–ç¨‹è‰ºæœ¯ã€‹4.1.4 èŠ‚ï¼‰ï¼š</p><p><img src="https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/19-1-29/Java%20%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81%E5%8F%98%E8%BF%81.png" alt="Javaçº¿ç¨‹çŠ¶æ€å˜è¿"></p><p>ç”±ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼š</p><p>çº¿ç¨‹åˆ›å»ºä¹‹åå®ƒå°†å¤„äº <strong>NEWï¼ˆæ–°å»ºï¼‰</strong> çŠ¶æ€ï¼Œè°ƒç”¨ <code>start()</code> æ–¹æ³•åå¼€å§‹è¿è¡Œï¼Œçº¿ç¨‹è¿™æ—¶å€™å¤„äº <strong>READYï¼ˆå¯è¿è¡Œï¼‰</strong> çŠ¶æ€ã€‚å¯è¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹è·å¾—äº† cpu æ—¶é—´ç‰‡ï¼ˆtimesliceï¼‰åå°±å¤„äº <strong>RUNNINGï¼ˆè¿è¡Œï¼‰</strong> çŠ¶æ€ã€‚</p><blockquote><p>æ“ä½œç³»ç»Ÿéšè— Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸­çš„ READY å’Œ RUNNING çŠ¶æ€ï¼Œå®ƒåªèƒ½çœ‹åˆ° RUNNABLE çŠ¶æ€ï¼ˆå›¾æºï¼š<a href="https://howtodoinjava.com/">HowToDoInJava</a>ï¼š<a href="https://howtodoinjava.com/java/multi-threading/java-thread-life-cycle-and-thread-states/">Java Thread Life Cycle and Thread States</a>ï¼‰ï¼Œæ‰€ä»¥ Java ç³»ç»Ÿä¸€èˆ¬å°†è¿™ä¸¤ä¸ªçŠ¶æ€ç»Ÿç§°ä¸º <strong>RUNNABLEï¼ˆè¿è¡Œä¸­ï¼‰</strong> çŠ¶æ€ ã€‚</p></blockquote><p><img src="https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-3/RUNNABLE-VS-RUNNING.png" alt="RUNNABLE-VS-RUNNING"></p><p>å½“çº¿ç¨‹æ‰§è¡Œ <code>wait()</code>æ–¹æ³•ä¹‹åï¼Œçº¿ç¨‹è¿›å…¥ <strong>WAITINGï¼ˆç­‰å¾…ï¼‰</strong>çŠ¶æ€ã€‚è¿›å…¥ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹éœ€è¦ä¾é å…¶ä»–çº¿ç¨‹çš„é€šçŸ¥æ‰èƒ½å¤Ÿè¿”å›åˆ°è¿è¡ŒçŠ¶æ€ï¼Œè€Œ <strong>TIME_WAITING(è¶…æ—¶ç­‰å¾…)</strong> çŠ¶æ€ç›¸å½“äºåœ¨ç­‰å¾…çŠ¶æ€çš„åŸºç¡€ä¸Šå¢åŠ äº†è¶…æ—¶é™åˆ¶ï¼Œæ¯”å¦‚é€šè¿‡ <code>sleepï¼ˆlong millisï¼‰</code>æ–¹æ³•æˆ– <code>waitï¼ˆlong millisï¼‰</code>æ–¹æ³•å¯ä»¥å°† Java çº¿ç¨‹ç½®äº TIMED WAITING çŠ¶æ€ã€‚å½“è¶…æ—¶æ—¶é—´åˆ°è¾¾å Java çº¿ç¨‹å°†ä¼šè¿”å›åˆ° RUNNABLE çŠ¶æ€ã€‚å½“çº¿ç¨‹è°ƒç”¨åŒæ­¥æ–¹æ³•æ—¶ï¼Œåœ¨æ²¡æœ‰è·å–åˆ°é”çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹å°†ä¼šè¿›å…¥åˆ° <strong>BLOCKEDï¼ˆé˜»å¡ï¼‰</strong> çŠ¶æ€ã€‚çº¿ç¨‹åœ¨æ‰§è¡Œ Runnable çš„<code>run()</code>æ–¹æ³•ä¹‹åå°†ä¼šè¿›å…¥åˆ° <strong>TERMINATEDï¼ˆç»ˆæ­¢ï¼‰</strong> çŠ¶æ€ã€‚</p><h3 id="31-å…³äº-final-å…³é”®å­—çš„ä¸€äº›æ€»ç»“"><a href="#31-å…³äº-final-å…³é”®å­—çš„ä¸€äº›æ€»ç»“" class="headerlink" title="31 å…³äº final å…³é”®å­—çš„ä¸€äº›æ€»ç»“"></a>31 å…³äº final å…³é”®å­—çš„ä¸€äº›æ€»ç»“</h3><p>final å…³é”®å­—ä¸»è¦ç”¨åœ¨ä¸‰ä¸ªåœ°æ–¹ï¼šå˜é‡ã€æ–¹æ³•ã€ç±»ã€‚</p><ol><li>å¯¹äºä¸€ä¸ª final å˜é‡ï¼Œå¦‚æœæ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œåˆ™å…¶æ•°å€¼ä¸€æ—¦åœ¨åˆå§‹åŒ–ä¹‹åä¾¿ä¸èƒ½æ›´æ”¹ï¼›å¦‚æœæ˜¯å¼•ç”¨ç±»å‹çš„å˜é‡ï¼Œåˆ™åœ¨å¯¹å…¶åˆå§‹åŒ–ä¹‹åä¾¿ä¸èƒ½å†è®©å…¶æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ã€‚</li><li>å½“ç”¨ final ä¿®é¥°ä¸€ä¸ªç±»æ—¶ï¼Œè¡¨æ˜è¿™ä¸ªç±»ä¸èƒ½è¢«ç»§æ‰¿ã€‚final ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜æ–¹æ³•éƒ½ä¼šè¢«éšå¼åœ°æŒ‡å®šä¸º final æ–¹æ³•ã€‚</li><li>ä½¿ç”¨ final æ–¹æ³•çš„åŸå› æœ‰ä¸¤ä¸ªã€‚ç¬¬ä¸€ä¸ªåŸå› æ˜¯æŠŠæ–¹æ³•é”å®šï¼Œä»¥é˜²ä»»ä½•ç»§æ‰¿ç±»ä¿®æ”¹å®ƒçš„å«ä¹‰ï¼›ç¬¬äºŒä¸ªåŸå› æ˜¯æ•ˆç‡ã€‚åœ¨æ—©æœŸçš„ Java å®ç°ç‰ˆæœ¬ä¸­ï¼Œä¼šå°† final æ–¹æ³•è½¬ä¸ºå†…åµŒè°ƒç”¨ã€‚ä½†æ˜¯å¦‚æœæ–¹æ³•è¿‡äºåºå¤§ï¼Œå¯èƒ½çœ‹ä¸åˆ°å†…åµŒè°ƒç”¨å¸¦æ¥çš„ä»»ä½•æ€§èƒ½æå‡ï¼ˆç°åœ¨çš„ Java ç‰ˆæœ¬å·²ç»ä¸éœ€è¦ä½¿ç”¨ final æ–¹æ³•è¿›è¡Œè¿™äº›ä¼˜åŒ–äº†ï¼‰ã€‚ç±»ä¸­æ‰€æœ‰çš„ private æ–¹æ³•éƒ½éšå¼åœ°æŒ‡å®šä¸º finalã€‚</li></ol><h3 id="32-Java-ä¸­çš„å¼‚å¸¸å¤„ç†"><a href="#32-Java-ä¸­çš„å¼‚å¸¸å¤„ç†" class="headerlink" title="32 Java ä¸­çš„å¼‚å¸¸å¤„ç†"></a>32 Java ä¸­çš„å¼‚å¸¸å¤„ç†</h3><h4 id="Java-å¼‚å¸¸ç±»å±‚æ¬¡ç»“æ„å›¾"><a href="#Java-å¼‚å¸¸ç±»å±‚æ¬¡ç»“æ„å›¾" class="headerlink" title="Java å¼‚å¸¸ç±»å±‚æ¬¡ç»“æ„å›¾"></a>Java å¼‚å¸¸ç±»å±‚æ¬¡ç»“æ„å›¾</h4><p><img src="https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-2/Exception.png" alt="Javaå¼‚å¸¸ç±»å±‚æ¬¡ç»“æ„å›¾"></p><p>åœ¨ Java ä¸­ï¼Œæ‰€æœ‰çš„å¼‚å¸¸éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„ç¥–å…ˆ java.lang åŒ…ä¸­çš„ <strong>Throwable ç±»</strong>ã€‚Throwableï¼š æœ‰ä¸¤ä¸ªé‡è¦çš„å­ç±»ï¼š<strong>Exceptionï¼ˆå¼‚å¸¸ï¼‰</strong> å’Œ <strong>Errorï¼ˆé”™è¯¯ï¼‰</strong> ï¼ŒäºŒè€…éƒ½æ˜¯ Java å¼‚å¸¸å¤„ç†çš„é‡è¦å­ç±»ï¼Œå„è‡ªéƒ½åŒ…å«å¤§é‡å­ç±»ã€‚</p><p><strong>Errorï¼ˆé”™è¯¯ï¼‰:æ˜¯ç¨‹åºæ— æ³•å¤„ç†çš„é”™è¯¯</strong>ï¼Œè¡¨ç¤ºè¿è¡Œåº”ç”¨ç¨‹åºä¸­è¾ƒä¸¥é‡é—®é¢˜ã€‚å¤§å¤šæ•°é”™è¯¯ä¸ä»£ç ç¼–å†™è€…æ‰§è¡Œçš„æ“ä½œæ— å…³ï¼Œè€Œè¡¨ç¤ºä»£ç è¿è¡Œæ—¶ JVMï¼ˆJava è™šæ‹Ÿæœºï¼‰å‡ºç°çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼ŒJava è™šæ‹Ÿæœºè¿è¡Œé”™è¯¯ï¼ˆVirtual MachineErrorï¼‰ï¼Œå½“ JVM ä¸å†æœ‰ç»§ç»­æ‰§è¡Œæ“ä½œæ‰€éœ€çš„å†…å­˜èµ„æºæ—¶ï¼Œå°†å‡ºç° OutOfMemoryErrorã€‚è¿™äº›å¼‚å¸¸å‘ç”Ÿæ—¶ï¼ŒJava è™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸€èˆ¬ä¼šé€‰æ‹©çº¿ç¨‹ç»ˆæ­¢ã€‚</p><p>è¿™äº›é”™è¯¯è¡¨ç¤ºæ•…éšœå‘ç”Ÿäºè™šæ‹Ÿæœºè‡ªèº«ã€æˆ–è€…å‘ç”Ÿåœ¨è™šæ‹Ÿæœºè¯•å›¾æ‰§è¡Œåº”ç”¨æ—¶ï¼Œå¦‚ Java è™šæ‹Ÿæœºè¿è¡Œé”™è¯¯ï¼ˆVirtual MachineErrorï¼‰ã€ç±»å®šä¹‰é”™è¯¯ï¼ˆNoClassDefFoundErrorï¼‰ç­‰ã€‚è¿™äº›é”™è¯¯æ˜¯ä¸å¯æŸ¥çš„ï¼Œå› ä¸ºå®ƒä»¬åœ¨åº”ç”¨ç¨‹åºçš„æ§åˆ¶å’Œå¤„ç†èƒ½åŠ›ä¹‹ å¤–ï¼Œè€Œä¸”ç»å¤§å¤šæ•°æ˜¯ç¨‹åºè¿è¡Œæ—¶ä¸å…è®¸å‡ºç°çš„çŠ¶å†µã€‚å¯¹äºè®¾è®¡åˆç†çš„åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œå³ä½¿ç¡®å®å‘ç”Ÿäº†é”™è¯¯ï¼Œæœ¬è´¨ä¸Šä¹Ÿä¸åº”è¯¥è¯•å›¾å»å¤„ç†å®ƒæ‰€å¼•èµ·çš„å¼‚å¸¸çŠ¶å†µã€‚åœ¨ Java ä¸­ï¼Œé”™è¯¯é€šè¿‡ Error çš„å­ç±»æè¿°ã€‚</p><p><strong>Exceptionï¼ˆå¼‚å¸¸ï¼‰:æ˜¯ç¨‹åºæœ¬èº«å¯ä»¥å¤„ç†çš„å¼‚å¸¸</strong>ã€‚</font>Exception ç±»æœ‰ä¸€ä¸ªé‡è¦çš„å­ç±» <strong>RuntimeException</strong>ã€‚RuntimeException å¼‚å¸¸ç”± Java è™šæ‹ŸæœºæŠ›å‡ºã€‚<strong>NullPointerException</strong>ï¼ˆè¦è®¿é—®çš„å˜é‡æ²¡æœ‰å¼•ç”¨ä»»ä½•å¯¹è±¡æ—¶ï¼ŒæŠ›å‡ºè¯¥å¼‚å¸¸ï¼‰ã€<strong>ArithmeticException</strong>ï¼ˆç®—æœ¯è¿ç®—å¼‚å¸¸ï¼Œä¸€ä¸ªæ•´æ•°é™¤ä»¥ 0 æ—¶ï¼ŒæŠ›å‡ºè¯¥å¼‚å¸¸ï¼‰å’Œ <strong>ArrayIndexOutOfBoundsException</strong> ï¼ˆä¸‹æ ‡è¶Šç•Œå¼‚å¸¸ï¼‰ã€‚</p><p><strong>æ³¨æ„ï¼šå¼‚å¸¸å’Œé”™è¯¯çš„åŒºåˆ«ï¼šå¼‚å¸¸èƒ½è¢«ç¨‹åºæœ¬èº«å¤„ç†ï¼Œé”™è¯¯æ˜¯æ— æ³•å¤„ç†ã€‚</strong></p><h4 id="Throwable-ç±»å¸¸ç”¨æ–¹æ³•"><a href="#Throwable-ç±»å¸¸ç”¨æ–¹æ³•" class="headerlink" title="Throwable ç±»å¸¸ç”¨æ–¹æ³•"></a>Throwable ç±»å¸¸ç”¨æ–¹æ³•</h4><ul><li><strong>public string getMessage()</strong>:è¿”å›å¼‚å¸¸å‘ç”Ÿæ—¶çš„ç®€è¦æè¿°</li><li><strong>public string toString()</strong>:è¿”å›å¼‚å¸¸å‘ç”Ÿæ—¶çš„è¯¦ç»†ä¿¡æ¯</li><li><strong>public string getLocalizedMessage()</strong>:è¿”å›å¼‚å¸¸å¯¹è±¡çš„æœ¬åœ°åŒ–ä¿¡æ¯ã€‚ä½¿ç”¨ Throwable çš„å­ç±»è¦†ç›–è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”Ÿæˆæœ¬åœ°åŒ–ä¿¡æ¯ã€‚å¦‚æœå­ç±»æ²¡æœ‰è¦†ç›–è¯¥æ–¹æ³•ï¼Œåˆ™è¯¥æ–¹æ³•è¿”å›çš„ä¿¡æ¯ä¸ getMessageï¼ˆï¼‰è¿”å›çš„ç»“æœç›¸åŒ</li><li><strong>public void printStackTrace()</strong>:åœ¨æ§åˆ¶å°ä¸Šæ‰“å° Throwable å¯¹è±¡å°è£…çš„å¼‚å¸¸ä¿¡æ¯</li></ul><h4 id="å¼‚å¸¸å¤„ç†æ€»ç»“"><a href="#å¼‚å¸¸å¤„ç†æ€»ç»“" class="headerlink" title="å¼‚å¸¸å¤„ç†æ€»ç»“"></a>å¼‚å¸¸å¤„ç†æ€»ç»“</h4><ul><li><strong>try å—ï¼š</strong> ç”¨äºæ•è·å¼‚å¸¸ã€‚å…¶åå¯æ¥é›¶ä¸ªæˆ–å¤šä¸ª catch å—ï¼Œå¦‚æœæ²¡æœ‰ catch å—ï¼Œåˆ™å¿…é¡»è·Ÿä¸€ä¸ª finally å—ã€‚</li><li><strong>catch å—ï¼š</strong> ç”¨äºå¤„ç† try æ•è·åˆ°çš„å¼‚å¸¸ã€‚</li><li><strong>finally å—ï¼š</strong> æ— è®ºæ˜¯å¦æ•è·æˆ–å¤„ç†å¼‚å¸¸ï¼Œfinally å—é‡Œçš„è¯­å¥éƒ½ä¼šè¢«æ‰§è¡Œã€‚å½“åœ¨ try å—æˆ– catch å—ä¸­é‡åˆ° return<br>è¯­å¥æ—¶ï¼Œfinally è¯­å¥å—å°†åœ¨æ–¹æ³•è¿”å›ä¹‹å‰è¢«æ‰§è¡Œã€‚</li></ul><p><strong>åœ¨ä»¥ä¸‹ 4 ç§ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œfinally å—ä¸ä¼šè¢«æ‰§è¡Œï¼š</strong></p><ol><li>åœ¨ finally è¯­å¥å—ç¬¬ä¸€è¡Œå‘ç”Ÿäº†å¼‚å¸¸ã€‚ å› ä¸ºåœ¨å…¶ä»–è¡Œï¼Œfinally å—è¿˜æ˜¯ä¼šå¾—åˆ°æ‰§è¡Œ</li><li>åœ¨å‰é¢çš„ä»£ç ä¸­ç”¨äº† System.exit(int)å·²é€€å‡ºç¨‹åºã€‚ exit æ˜¯å¸¦å‚å‡½æ•° ï¼›è‹¥è¯¥è¯­å¥åœ¨å¼‚å¸¸è¯­å¥ä¹‹åï¼Œfinally ä¼šæ‰§è¡Œ</li><li>ç¨‹åºæ‰€åœ¨çš„çº¿ç¨‹æ­»äº¡ã€‚</li><li>å…³é—­ CPUã€‚</li></ol><p>ä¸‹é¢è¿™éƒ¨åˆ†å†…å®¹æ¥è‡ª issue:<a href="https://github.com/Snailclimb/JavaGuide/issues/190">https://github.com/Snailclimb/JavaGuide/issues/190</a>ã€‚</p><p><strong>æ³¨æ„ï¼š</strong> å½“ try è¯­å¥å’Œ finally è¯­å¥ä¸­éƒ½æœ‰ return è¯­å¥æ—¶ï¼Œåœ¨æ–¹æ³•è¿”å›ä¹‹å‰ï¼Œfinally è¯­å¥çš„å†…å®¹å°†è¢«æ‰§è¡Œï¼Œå¹¶ä¸” finally è¯­å¥çš„è¿”å›å€¼å°†ä¼šè¦†ç›–åŸå§‹çš„è¿”å›å€¼ã€‚å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value * value;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (value == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœè°ƒç”¨ <code>f(2)</code>ï¼Œè¿”å›å€¼å°†æ˜¯ 0ï¼Œå› ä¸º finally è¯­å¥çš„è¿”å›å€¼è¦†ç›–äº† try è¯­å¥å—çš„è¿”å›å€¼ã€‚</p><h3 id="33-Java-åºåˆ—åŒ–ä¸­å¦‚æœæœ‰äº›å­—æ®µä¸æƒ³è¿›è¡Œåºåˆ—åŒ–ï¼Œæ€ä¹ˆåŠï¼Ÿ"><a href="#33-Java-åºåˆ—åŒ–ä¸­å¦‚æœæœ‰äº›å­—æ®µä¸æƒ³è¿›è¡Œåºåˆ—åŒ–ï¼Œæ€ä¹ˆåŠï¼Ÿ" class="headerlink" title="33 Java åºåˆ—åŒ–ä¸­å¦‚æœæœ‰äº›å­—æ®µä¸æƒ³è¿›è¡Œåºåˆ—åŒ–ï¼Œæ€ä¹ˆåŠï¼Ÿ"></a>33 Java åºåˆ—åŒ–ä¸­å¦‚æœæœ‰äº›å­—æ®µä¸æƒ³è¿›è¡Œåºåˆ—åŒ–ï¼Œæ€ä¹ˆåŠï¼Ÿ</h3><p>å¯¹äºä¸æƒ³è¿›è¡Œåºåˆ—åŒ–çš„å˜é‡ï¼Œä½¿ç”¨ transient å…³é”®å­—ä¿®é¥°ã€‚</p><p>transient å…³é”®å­—çš„ä½œç”¨æ˜¯ï¼šé˜»æ­¢å®ä¾‹ä¸­é‚£äº›ç”¨æ­¤å…³é”®å­—ä¿®é¥°çš„çš„å˜é‡åºåˆ—åŒ–ï¼›å½“å¯¹è±¡è¢«ååºåˆ—åŒ–æ—¶ï¼Œè¢« transient ä¿®é¥°çš„å˜é‡å€¼ä¸ä¼šè¢«æŒä¹…åŒ–å’Œæ¢å¤ã€‚transient åªèƒ½ä¿®é¥°å˜é‡ï¼Œä¸èƒ½ä¿®é¥°ç±»å’Œæ–¹æ³•ã€‚</p><h3 id="34-è·å–ç”¨é”®ç›˜è¾“å…¥å¸¸ç”¨çš„ä¸¤ç§æ–¹æ³•"><a href="#34-è·å–ç”¨é”®ç›˜è¾“å…¥å¸¸ç”¨çš„ä¸¤ç§æ–¹æ³•" class="headerlink" title="34 è·å–ç”¨é”®ç›˜è¾“å…¥å¸¸ç”¨çš„ä¸¤ç§æ–¹æ³•"></a>34 è·å–ç”¨é”®ç›˜è¾“å…¥å¸¸ç”¨çš„ä¸¤ç§æ–¹æ³•</h3><p>æ–¹æ³• 1ï¼šé€šè¿‡ Scanner</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Scanner input = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">String s  = input.nextLine();</span><br><span class="line">input.close();</span><br></pre></td></tr></table></figure><p>æ–¹æ³• 2ï¼šé€šè¿‡ BufferedReader</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BufferedReader input = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">String s = input.readLine();</span><br></pre></td></tr></table></figure><h3 id="35-Java-ä¸­-IO-æµ"><a href="#35-Java-ä¸­-IO-æµ" class="headerlink" title="35 Java ä¸­ IO æµ"></a>35 Java ä¸­ IO æµ</h3><h4 id="Java-ä¸­-IO-æµåˆ†ä¸ºå‡ ç§"><a href="#Java-ä¸­-IO-æµåˆ†ä¸ºå‡ ç§" class="headerlink" title="Java ä¸­ IO æµåˆ†ä¸ºå‡ ç§?"></a>Java ä¸­ IO æµåˆ†ä¸ºå‡ ç§?</h4><ul><li>æŒ‰ç…§æµçš„æµå‘åˆ†ï¼Œå¯ä»¥åˆ†ä¸ºè¾“å…¥æµå’Œè¾“å‡ºæµï¼›</li><li>æŒ‰ç…§æ“ä½œå•å…ƒåˆ’åˆ†ï¼Œå¯ä»¥åˆ’åˆ†ä¸ºå­—èŠ‚æµå’Œå­—ç¬¦æµï¼›</li><li>æŒ‰ç…§æµçš„è§’è‰²åˆ’åˆ†ä¸ºèŠ‚ç‚¹æµå’Œå¤„ç†æµã€‚</li></ul><p>Java Io æµå…±æ¶‰åŠ 40 å¤šä¸ªç±»ï¼Œè¿™äº›ç±»çœ‹ä¸Šå»å¾ˆæ‚ä¹±ï¼Œä½†å®é™…ä¸Šå¾ˆæœ‰è§„åˆ™ï¼Œè€Œä¸”å½¼æ­¤ä¹‹é—´å­˜åœ¨éå¸¸ç´§å¯†çš„è”ç³»ï¼Œ Java I0 æµçš„ 40 å¤šä¸ªç±»éƒ½æ˜¯ä»å¦‚ä¸‹ 4 ä¸ªæŠ½è±¡ç±»åŸºç±»ä¸­æ´¾ç”Ÿå‡ºæ¥çš„ã€‚</p><ul><li>InputStream/Reader: æ‰€æœ‰çš„è¾“å…¥æµçš„åŸºç±»ï¼Œå‰è€…æ˜¯å­—èŠ‚è¾“å…¥æµï¼Œåè€…æ˜¯å­—ç¬¦è¾“å…¥æµã€‚</li><li>OutputStream/Writer: æ‰€æœ‰è¾“å‡ºæµçš„åŸºç±»ï¼Œå‰è€…æ˜¯å­—èŠ‚è¾“å‡ºæµï¼Œåè€…æ˜¯å­—ç¬¦è¾“å‡ºæµã€‚</li></ul><p>æŒ‰æ“ä½œæ–¹å¼åˆ†ç±»ç»“æ„å›¾ï¼š</p><p><img src="https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-6/IO-%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F%E5%88%86%E7%B1%BB.png" alt="IO-æ“ä½œæ–¹å¼åˆ†ç±»"></p><p>æŒ‰æ“ä½œå¯¹è±¡åˆ†ç±»ç»“æ„å›¾ï¼š</p><p><img src="https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-6/IO-%E6%93%8D%E4%BD%9C%E5%AF%B9%E8%B1%A1%E5%88%86%E7%B1%BB.png" alt="IO-æ“ä½œå¯¹è±¡åˆ†ç±»"></p><h4 id="æ—¢ç„¶æœ‰äº†å­—èŠ‚æµ-ä¸ºä»€ä¹ˆè¿˜è¦æœ‰å­—ç¬¦æµ"><a href="#æ—¢ç„¶æœ‰äº†å­—èŠ‚æµ-ä¸ºä»€ä¹ˆè¿˜è¦æœ‰å­—ç¬¦æµ" class="headerlink" title="æ—¢ç„¶æœ‰äº†å­—èŠ‚æµ,ä¸ºä»€ä¹ˆè¿˜è¦æœ‰å­—ç¬¦æµ?"></a>æ—¢ç„¶æœ‰äº†å­—èŠ‚æµ,ä¸ºä»€ä¹ˆè¿˜è¦æœ‰å­—ç¬¦æµ?</h4><p>é—®é¢˜æœ¬è´¨æƒ³é—®ï¼š<strong>ä¸ç®¡æ˜¯æ–‡ä»¶è¯»å†™è¿˜æ˜¯ç½‘ç»œå‘é€æ¥æ”¶ï¼Œä¿¡æ¯çš„æœ€å°å­˜å‚¨å•å…ƒéƒ½æ˜¯å­—èŠ‚ï¼Œé‚£ä¸ºä»€ä¹ˆ I/O æµæ“ä½œè¦åˆ†ä¸ºå­—èŠ‚æµæ“ä½œå’Œå­—ç¬¦æµæ“ä½œå‘¢ï¼Ÿ</strong></p><p>å›ç­”ï¼šå­—ç¬¦æµæ˜¯ç”± Java è™šæ‹Ÿæœºå°†å­—èŠ‚è½¬æ¢å¾—åˆ°çš„ï¼Œé—®é¢˜å°±å‡ºåœ¨è¿™ä¸ªè¿‡ç¨‹è¿˜ç®—æ˜¯éå¸¸è€—æ—¶ï¼Œå¹¶ä¸”ï¼Œå¦‚æœæˆ‘ä»¬ä¸çŸ¥é“ç¼–ç ç±»å‹å°±å¾ˆå®¹æ˜“å‡ºç°ä¹±ç é—®é¢˜ã€‚æ‰€ä»¥ï¼Œ I/O æµå°±å¹²è„†æä¾›äº†ä¸€ä¸ªç›´æ¥æ“ä½œå­—ç¬¦çš„æ¥å£ï¼Œæ–¹ä¾¿æˆ‘ä»¬å¹³æ—¶å¯¹å­—ç¬¦è¿›è¡Œæµæ“ä½œã€‚å¦‚æœéŸ³é¢‘æ–‡ä»¶ã€å›¾ç‰‡ç­‰åª’ä½“æ–‡ä»¶ç”¨å­—èŠ‚æµæ¯”è¾ƒå¥½ï¼Œå¦‚æœæ¶‰åŠåˆ°å­—ç¬¦çš„è¯ä½¿ç”¨å­—ç¬¦æµæ¯”è¾ƒå¥½ã€‚</p><h4 id="BIO-NIO-AIO-æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#BIO-NIO-AIO-æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="BIO,NIO,AIO æœ‰ä»€ä¹ˆåŒºåˆ«?"></a>BIO,NIO,AIO æœ‰ä»€ä¹ˆåŒºåˆ«?</h4><ul><li><strong>BIO (Blocking I/O):</strong> åŒæ­¥é˜»å¡ I/O æ¨¡å¼ï¼Œæ•°æ®çš„è¯»å–å†™å…¥å¿…é¡»é˜»å¡åœ¨ä¸€ä¸ªçº¿ç¨‹å†…ç­‰å¾…å…¶å®Œæˆã€‚åœ¨æ´»åŠ¨è¿æ¥æ•°ä¸æ˜¯ç‰¹åˆ«é«˜ï¼ˆå°äºå•æœº 1000ï¼‰çš„æƒ…å†µä¸‹ï¼Œè¿™ç§æ¨¡å‹æ˜¯æ¯”è¾ƒä¸é”™çš„ï¼Œå¯ä»¥è®©æ¯ä¸€ä¸ªè¿æ¥ä¸“æ³¨äºè‡ªå·±çš„ I/O å¹¶ä¸”ç¼–ç¨‹æ¨¡å‹ç®€å•ï¼Œä¹Ÿä¸ç”¨è¿‡å¤šè€ƒè™‘ç³»ç»Ÿçš„è¿‡è½½ã€é™æµç­‰é—®é¢˜ã€‚çº¿ç¨‹æ± æœ¬èº«å°±æ˜¯ä¸€ä¸ªå¤©ç„¶çš„æ¼æ–—ï¼Œå¯ä»¥ç¼“å†²ä¸€äº›ç³»ç»Ÿå¤„ç†ä¸äº†çš„è¿æ¥æˆ–è¯·æ±‚ã€‚ä½†æ˜¯ï¼Œå½“é¢å¯¹åä¸‡ç”šè‡³ç™¾ä¸‡çº§è¿æ¥çš„æ—¶å€™ï¼Œä¼ ç»Ÿçš„ BIO æ¨¡å‹æ˜¯æ— èƒ½ä¸ºåŠ›çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ›´é«˜æ•ˆçš„ I/O å¤„ç†æ¨¡å‹æ¥åº”å¯¹æ›´é«˜çš„å¹¶å‘é‡ã€‚</li><li><strong>NIO (Non-blocking/New I/O):</strong> NIO æ˜¯ä¸€ç§åŒæ­¥éé˜»å¡çš„ I/O æ¨¡å‹ï¼Œåœ¨ Java 1.4 ä¸­å¼•å…¥äº† NIO æ¡†æ¶ï¼Œå¯¹åº” java.nio åŒ…ï¼Œæä¾›äº† Channel , Selectorï¼ŒBuffer ç­‰æŠ½è±¡ã€‚NIO ä¸­çš„ N å¯ä»¥ç†è§£ä¸º Non-blockingï¼Œä¸å•çº¯æ˜¯ Newã€‚å®ƒæ”¯æŒé¢å‘ç¼“å†²çš„ï¼ŒåŸºäºé€šé“çš„ I/O æ“ä½œæ–¹æ³•ã€‚ NIO æä¾›äº†ä¸ä¼ ç»Ÿ BIO æ¨¡å‹ä¸­çš„ <code>Socket</code> å’Œ <code>ServerSocket</code> ç›¸å¯¹åº”çš„ <code>SocketChannel</code> å’Œ <code>ServerSocketChannel</code> ä¸¤ç§ä¸åŒçš„å¥—æ¥å­—é€šé“å®ç°,ä¸¤ç§é€šé“éƒ½æ”¯æŒé˜»å¡å’Œéé˜»å¡ä¸¤ç§æ¨¡å¼ã€‚é˜»å¡æ¨¡å¼ä½¿ç”¨å°±åƒä¼ ç»Ÿä¸­çš„æ”¯æŒä¸€æ ·ï¼Œæ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯æ€§èƒ½å’Œå¯é æ€§éƒ½ä¸å¥½ï¼›éé˜»å¡æ¨¡å¼æ­£å¥½ä¸ä¹‹ç›¸åã€‚å¯¹äºä½è´Ÿè½½ã€ä½å¹¶å‘çš„åº”ç”¨ç¨‹åºï¼Œå¯ä»¥ä½¿ç”¨åŒæ­¥é˜»å¡ I/O æ¥æå‡å¼€å‘é€Ÿç‡å’Œæ›´å¥½çš„ç»´æŠ¤æ€§ï¼›å¯¹äºé«˜è´Ÿè½½ã€é«˜å¹¶å‘çš„ï¼ˆç½‘ç»œï¼‰åº”ç”¨ï¼Œåº”ä½¿ç”¨ NIO çš„éé˜»å¡æ¨¡å¼æ¥å¼€å‘</li><li><strong>AIO (Asynchronous I/O):</strong> AIO ä¹Ÿå°±æ˜¯ NIO 2ã€‚åœ¨ Java 7 ä¸­å¼•å…¥äº† NIO çš„æ”¹è¿›ç‰ˆ NIO 2,å®ƒæ˜¯å¼‚æ­¥éé˜»å¡çš„ IO æ¨¡å‹ã€‚å¼‚æ­¥ IO æ˜¯åŸºäºäº‹ä»¶å’Œå›è°ƒæœºåˆ¶å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨æ“ä½œä¹‹åä¼šç›´æ¥è¿”å›ï¼Œä¸ä¼šå µå¡åœ¨é‚£é‡Œï¼Œå½“åå°å¤„ç†å®Œæˆï¼Œæ“ä½œç³»ç»Ÿä¼šé€šçŸ¥ç›¸åº”çš„çº¿ç¨‹è¿›è¡Œåç»­çš„æ“ä½œã€‚AIO æ˜¯å¼‚æ­¥ IO çš„ç¼©å†™ï¼Œè™½ç„¶ NIO åœ¨ç½‘ç»œæ“ä½œä¸­ï¼Œæä¾›äº†éé˜»å¡çš„æ–¹æ³•ï¼Œä½†æ˜¯ NIO çš„ IO è¡Œä¸ºè¿˜æ˜¯åŒæ­¥çš„ã€‚å¯¹äº NIO æ¥è¯´ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡çº¿ç¨‹æ˜¯åœ¨ IO æ“ä½œå‡†å¤‡å¥½æ—¶ï¼Œå¾—åˆ°é€šçŸ¥ï¼Œæ¥ç€å°±ç”±è¿™ä¸ªçº¿ç¨‹è‡ªè¡Œè¿›è¡Œ IO æ“ä½œï¼ŒIO æ“ä½œæœ¬èº«æ˜¯åŒæ­¥çš„ã€‚æŸ¥é˜…ç½‘ä¸Šç›¸å…³èµ„æ–™ï¼Œæˆ‘å‘ç°å°±ç›®å‰æ¥è¯´ AIO çš„åº”ç”¨è¿˜ä¸æ˜¯å¾ˆå¹¿æ³›ï¼ŒNetty ä¹‹å‰ä¹Ÿå°è¯•ä½¿ç”¨è¿‡ AIOï¼Œä¸è¿‡åˆæ”¾å¼ƒäº†ã€‚</li></ul><h3 id="36-å¸¸è§å…³é”®å­—æ€»ç»“-static-final-this-super"><a href="#36-å¸¸è§å…³é”®å­—æ€»ç»“-static-final-this-super" class="headerlink" title="36. å¸¸è§å…³é”®å­—æ€»ç»“:static,final,this,super"></a>36. å¸¸è§å…³é”®å­—æ€»ç»“:static,final,this,super</h3><p>è¯¦è§ç¬”ä¸»çš„è¿™ç¯‡æ–‡ç« :  <a href="https://gitee.com/SnailClimb/JavaGuide/blob/master/docs/java/basic/final,static,this,super.md">https://gitee.com/SnailClimb/JavaGuide/blob/master/docs/java/basic/final,static,this,super.md</a></p><h3 id="37-Collections-å·¥å…·ç±»å’Œ-Arrays-å·¥å…·ç±»å¸¸è§æ–¹æ³•æ€»ç»“"><a href="#37-Collections-å·¥å…·ç±»å’Œ-Arrays-å·¥å…·ç±»å¸¸è§æ–¹æ³•æ€»ç»“" class="headerlink" title="37. Collections å·¥å…·ç±»å’Œ Arrays å·¥å…·ç±»å¸¸è§æ–¹æ³•æ€»ç»“"></a>37. Collections å·¥å…·ç±»å’Œ Arrays å·¥å…·ç±»å¸¸è§æ–¹æ³•æ€»ç»“</h3><p>è¯¦è§ç¬”ä¸»çš„è¿™ç¯‡æ–‡ç« :  <a href="https://gitee.com/SnailClimb/JavaGuide/blob/master/docs/java/basic/Arrays,CollectionsCommonMethods.md">https://gitee.com/SnailClimb/JavaGuide/blob/master/docs/java/basic/Arrays,CollectionsCommonMethods.md</a></p><h3 id="38-æ·±æ‹·è´-vs-æµ…æ‹·è´"><a href="#38-æ·±æ‹·è´-vs-æµ…æ‹·è´" class="headerlink" title="38. æ·±æ‹·è´ vs æµ…æ‹·è´"></a>38. æ·±æ‹·è´ vs æµ…æ‹·è´</h3><ol><li><strong>æµ…æ‹·è´</strong>ï¼šå¯¹åŸºæœ¬æ•°æ®ç±»å‹è¿›è¡Œå€¼ä¼ é€’ï¼Œå¯¹å¼•ç”¨æ•°æ®ç±»å‹è¿›è¡Œå¼•ç”¨ä¼ é€’èˆ¬çš„æ‹·è´ï¼Œæ­¤ä¸ºæµ…æ‹·è´ã€‚</li><li><strong>æ·±æ‹·è´</strong>ï¼šå¯¹åŸºæœ¬æ•°æ®ç±»å‹è¿›è¡Œå€¼ä¼ é€’ï¼Œå¯¹å¼•ç”¨æ•°æ®ç±»å‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¹¶å¤åˆ¶å…¶å†…å®¹ï¼Œæ­¤ä¸ºæ·±æ‹·è´ã€‚</li></ol><p><img src="https://my-blog-to-use.oss-cn-beijing.aliyuncs.com/2019-7/java-deep-and-shallow-copy.jpg" alt="deep and shallow copy"></p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul><li><a href="https://stackoverflow.com/questions/1906445/what-is-the-difference-between-jdk-and-jre">https://stackoverflow.com/questions/1906445/what-is-the-difference-between-jdk-and-jre</a></li><li><a href="https://www.educba.com/oracle-vs-openjdk/">https://www.educba.com/oracle-vs-openjdk/</a></li><li><a href="https://stackoverflow.com/questions/22358071/differences-between-oracle-jdk-and-openjdk?answertab=active#tab-top">https://stackoverflow.com/questions/22358071/differences-between-oracle-jdk-and-openjdk?answertab=active#tab-top</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;2-1-JavaåŸºç¡€&quot;&gt;&lt;a href=&quot;#2-1-JavaåŸºç¡€&quot; class=&quot;headerlink&quot; title=&quot;2.1 JavaåŸºç¡€&quot;&gt;&lt;/a&gt;2.1 JavaåŸºç¡€&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/Snailclimb/JavaGuide-Interview&quot;&gt;Original Blog&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;1-é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«&quot;&gt;&lt;a href=&quot;#1-é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«&quot; class=&quot;headerlink&quot; title=&quot;1. é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«&quot;&gt;&lt;/a&gt;1. é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é¢å‘è¿‡ç¨‹&lt;/strong&gt; ï¼š&lt;strong&gt;é¢å‘è¿‡ç¨‹æ€§èƒ½æ¯”é¢å‘å¯¹è±¡é«˜ã€‚&lt;/strong&gt; å› ä¸ºç±»è°ƒç”¨æ—¶éœ€è¦å®ä¾‹åŒ–ï¼Œå¼€é”€æ¯”è¾ƒå¤§ï¼Œæ¯”è¾ƒæ¶ˆè€—èµ„æºï¼Œæ‰€ä»¥å½“æ€§èƒ½æ˜¯æœ€é‡è¦çš„è€ƒé‡å› ç´ çš„æ—¶å€™ï¼Œæ¯”å¦‚å•ç‰‡æœºã€åµŒå…¥å¼å¼€å‘ã€Linux/Unix ç­‰ä¸€èˆ¬é‡‡ç”¨é¢å‘è¿‡ç¨‹å¼€å‘ã€‚ä½†æ˜¯ï¼Œ&lt;strong&gt;é¢å‘è¿‡ç¨‹æ²¡æœ‰é¢å‘å¯¹è±¡æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢å‘å¯¹è±¡&lt;/strong&gt; ï¼š&lt;strong&gt;é¢å‘å¯¹è±¡æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ã€‚&lt;/strong&gt; å› ä¸ºé¢å‘å¯¹è±¡æœ‰å°è£…ã€ç»§æ‰¿ã€å¤šæ€æ€§çš„ç‰¹æ€§ï¼Œæ‰€ä»¥å¯ä»¥è®¾è®¡å‡ºä½è€¦åˆçš„ç³»ç»Ÿï¼Œä½¿ç³»ç»Ÿæ›´åŠ çµæ´»ã€æ›´åŠ æ˜“äºç»´æŠ¤ã€‚ä½†æ˜¯ï¼Œ&lt;strong&gt;é¢å‘å¯¹è±¡æ€§èƒ½æ¯”é¢å‘è¿‡ç¨‹ä½&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‚è§ issue : &lt;a href=&quot;https://github.com/Snailclimb/JavaGuide/issues/431&quot;&gt;é¢å‘è¿‡ç¨‹ ï¼šé¢å‘è¿‡ç¨‹æ€§èƒ½æ¯”é¢å‘å¯¹è±¡é«˜ï¼Ÿï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™ä¸ªå¹¶ä¸æ˜¯æ ¹æœ¬åŸå› ï¼Œé¢å‘è¿‡ç¨‹ä¹Ÿéœ€è¦åˆ†é…å†…å­˜ï¼Œè®¡ç®—å†…å­˜åç§»é‡ï¼ŒJava æ€§èƒ½å·®çš„ä¸»è¦åŸå› å¹¶ä¸æ˜¯å› ä¸ºå®ƒæ˜¯é¢å‘å¯¹è±¡è¯­è¨€ï¼Œè€Œæ˜¯ Java æ˜¯åŠç¼–è¯‘è¯­è¨€ï¼Œæœ€ç»ˆçš„æ‰§è¡Œä»£ç å¹¶ä¸æ˜¯å¯ä»¥ç›´æ¥è¢« CPU æ‰§è¡Œçš„äºŒè¿›åˆ¶æœºæ¢°ç ã€‚&lt;/p&gt;
&lt;p&gt;è€Œé¢å‘è¿‡ç¨‹è¯­è¨€å¤§å¤šéƒ½æ˜¯ç›´æ¥ç¼–è¯‘æˆæœºæ¢°ç åœ¨ç”µè„‘ä¸Šæ‰§è¡Œï¼Œå¹¶ä¸”å…¶å®ƒä¸€äº›é¢å‘è¿‡ç¨‹çš„è„šæœ¬è¯­è¨€æ€§èƒ½ä¹Ÿå¹¶ä¸ä¸€å®šæ¯” Java å¥½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="java" scheme="http://yifanzhang13.github.io/categories/java/"/>
    
    
      <category term="java" scheme="http://yifanzhang13.github.io/tags/java/"/>
    
      <category term="basics" scheme="http://yifanzhang13.github.io/tags/basics/"/>
    
  </entry>
  
  <entry>
    <title>Usage Of Volatile In Java</title>
    <link href="http://yifanzhang13.github.io/2019/12/02/Usage-Of-Volatile-In-Java/"/>
    <id>http://yifanzhang13.github.io/2019/12/02/Usage-Of-Volatile-In-Java/</id>
    <published>2019-12-02T13:23:30.000Z</published>
    <updated>2020-04-02T15:31:13.183Z</updated>
    
    <content type="html"><![CDATA[<p>Volatileç”¨åœ¨å¤šçº¿ç¨‹ï¼ŒåŒæ­¥å˜é‡ã€‚ çº¿ç¨‹ä¸ºäº†æé«˜æ•ˆç‡ï¼Œå°†æŸæˆå‘˜å˜é‡(å¦‚A)æ‹·è´äº†ä¸€ä»½ï¼ˆå¦‚Bï¼‰ï¼Œçº¿ç¨‹ä¸­å¯¹Açš„è®¿é—®å…¶å®è®¿é—®çš„æ˜¯Bã€‚åªåœ¨æŸäº›åŠ¨ä½œæ—¶æ‰è¿›è¡ŒAå’ŒBçš„åŒæ­¥ã€‚å› æ­¤å­˜åœ¨Aå’ŒBä¸ä¸€è‡´çš„æƒ…å†µã€‚volatileå°±æ˜¯ç”¨æ¥é¿å…è¿™ç§æƒ…å†µçš„ã€‚volatileå‘Šè¯‰jvmï¼Œ å®ƒæ‰€ä¿®é¥°çš„å˜é‡ä¸ä¿ç•™æ‹·è´ï¼Œç›´æ¥è®¿é—®ä¸»å†…å­˜ä¸­çš„ï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢è¯´çš„A)</p><p>åœ¨Javaå†…å­˜æ¨¡å‹ä¸­ï¼Œæœ‰main memoryï¼Œæ¯ä¸ªçº¿ç¨‹ä¹Ÿæœ‰è‡ªå·±çš„memory (ä¾‹å¦‚å¯„å­˜å™¨)ã€‚ä¸ºäº†æ€§èƒ½ï¼Œä¸€ä¸ªçº¿ç¨‹ä¼šåœ¨è‡ªå·±çš„memoryä¸­ä¿æŒè¦è®¿é—®çš„å˜é‡çš„å‰¯æœ¬ã€‚è¿™æ ·å°±ä¼šå‡ºç°åŒä¸€ä¸ªå˜é‡åœ¨æŸä¸ªç¬é—´ï¼Œåœ¨ä¸€ä¸ªçº¿ç¨‹çš„memoryä¸­çš„å€¼å¯èƒ½ä¸å¦å¤–ä¸€ä¸ªçº¿ç¨‹memoryä¸­çš„å€¼ï¼Œæˆ–è€…main memoryä¸­çš„å€¼ä¸ä¸€è‡´çš„æƒ…å†µã€‚</p><a id="more"></a><p>ä¸€ä¸ªå˜é‡å£°æ˜ä¸ºvolatileï¼Œå°±æ„å‘³ç€è¿™ä¸ªå˜é‡æ˜¯éšæ—¶ä¼šè¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹çš„ï¼Œå› æ­¤ä¸èƒ½å°†å®ƒcacheåœ¨çº¿ç¨‹memoryä¸­ã€‚ä»¥ä¸‹ä¾‹å­å±•ç°äº†volatileçš„ä½œç”¨ï¼š</p><p>public class StoppableTask extends Thread {  </p><p>  private volatile boolean pleaseStop;  </p><p>  public void run() {  </p><pre><code>while (!pleaseStop) {   // do some stuff...  }  </code></pre><p> }  </p><p>  public void tellMeToStop() {  </p><p>   pleaseStop = true;  </p><p>  }  </p><p>}  </p><p>å‡å¦‚pleaseStopæ²¡æœ‰è¢«å£°æ˜ä¸ºvolatileï¼Œçº¿ç¨‹æ‰§è¡Œrunçš„æ—¶å€™æ£€æŸ¥çš„æ˜¯è‡ªå·±çš„å‰¯æœ¬ï¼Œå°±ä¸èƒ½åŠæ—¶å¾—çŸ¥å…¶ä»–çº¿ç¨‹å·²ç»è°ƒç”¨tellMeToStop()ä¿®æ”¹äº†pleaseStopçš„å€¼ã€‚</p><p>Volatileä¸€èˆ¬æƒ…å†µä¸‹ä¸èƒ½ä»£æ›¿sychronizedï¼Œå› ä¸ºvolatileä¸èƒ½ä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œå³ä½¿åªæ˜¯i++ï¼Œå®é™…ä¸Šä¹Ÿæ˜¯ç”±å¤šä¸ªåŸå­æ“ä½œç»„æˆï¼šread i; inc; write iï¼Œå‡å¦‚å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œi++ï¼Œvolatileåªèƒ½ä¿è¯ä»–ä»¬æ“ä½œçš„iæ˜¯åŒä¸€å—å†…å­˜ï¼Œä½†ä¾ç„¶å¯èƒ½å‡ºç°å†™å…¥è„æ•°æ®çš„æƒ…å†µã€‚å¦‚æœé…åˆJava 5å¢åŠ çš„atomic wrapper classesï¼Œå¯¹å®ƒä»¬çš„increaseä¹‹ç±»çš„æ“ä½œå°±ä¸éœ€è¦sychronizedã€‚</p><p>Referenceï¼š<br><a href="http://www.javamex.com/tutorials/synchronization_volatile.shtml">http://www.javamex.com/tutorials/synchronization_volatile.shtml</a><br><a href="http://www.javamex.com/tutorials/synchronization_volatile_java_5.shtml">http://www.javamex.com/tutorials/synchronization_volatile_java_5.shtml</a><br><a href="http://www.ibm.com/developerworks/cn/java/j-jtp06197.html">http://www.ibm.com/developerworks/cn/java/j-jtp06197.html</a><br>ææ€•æ¯”è¾ƒä¸€ä¸‹volatileå’Œsynchronizedçš„ä¸åŒæ˜¯æœ€å®¹æ˜“è§£é‡Šæ¸…æ¥šçš„ã€‚volatileæ˜¯å˜é‡ä¿®é¥°ç¬¦ï¼Œè€Œsynchronizedåˆ™ä½œç”¨äºä¸€æ®µä»£ç æˆ–æ–¹æ³•ï¼›çœ‹å¦‚ä¸‹ä¸‰å¥getä»£ç ï¼š</p><p>int i1;<br>int geti1() {return i1;}<br>volatile int i2;<br>int geti2()<br>{return i2;}<br>int i3;<br>synchronized int geti3() {return i3;}<br>ã€€ã€€geti1()  </p><p>å¾—åˆ°å­˜å‚¨åœ¨å½“å‰çº¿ç¨‹ä¸­i1çš„æ•°å€¼ã€‚å¤šä¸ªçº¿ç¨‹æœ‰å¤šä¸ªi1å˜é‡æ‹·è´ï¼Œè€Œä¸”è¿™äº›i1ä¹‹é—´å¯ä»¥äº’ä¸ç›¸åŒã€‚æ¢å¥è¯è¯´ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¯èƒ½å·²ç»æ”¹å˜äº†å®ƒçº¿ç¨‹å†…çš„i1å€¼ï¼Œè€Œè¿™ä¸ªå€¼å¯ä»¥å’Œå½“å‰çº¿ç¨‹ä¸­çš„i1å€¼ä¸ç›¸åŒã€‚äº‹å®ä¸Šï¼ŒJavaæœ‰ä¸ªæ€æƒ³å«â€œä¸»â€å†…å­˜åŒºåŸŸï¼Œè¿™é‡Œå­˜æ”¾äº†å˜é‡ç›®å‰çš„â€œå‡†ç¡®å€¼â€ã€‚æ¯ä¸ªçº¿ç¨‹å¯ä»¥æœ‰å®ƒè‡ªå·±çš„å˜é‡æ‹·è´ï¼Œè€Œè¿™ä¸ªå˜é‡æ‹·è´å€¼å¯ä»¥å’Œâ€œä¸»â€å†…å­˜åŒºåŸŸé‡Œå­˜æ”¾çš„ä¸åŒã€‚å› æ­¤å®é™…ä¸Šå­˜åœ¨ä¸€ç§å¯èƒ½ï¼šâ€œä¸»â€å†…å­˜åŒºåŸŸé‡Œçš„i1å€¼æ˜¯1ï¼Œçº¿ç¨‹1é‡Œçš„i1å€¼æ˜¯2ï¼Œçº¿ç¨‹2é‡Œçš„i1å€¼æ˜¯3â€”â€”è¿™åœ¨çº¿ç¨‹1å’Œçº¿ç¨‹2éƒ½æ”¹å˜äº†å®ƒä»¬å„è‡ªçš„i1å€¼ï¼Œè€Œä¸”è¿™ä¸ªæ”¹å˜è¿˜æ²¡æ¥å¾—åŠä¼ é€’ç»™â€œä¸»â€å†…å­˜åŒºåŸŸæˆ–å…¶ä»–çº¿ç¨‹æ—¶å°±ä¼šå‘ç”Ÿã€‚<br>ã€€ã€€è€Œ geti2()å¾—åˆ°çš„æ˜¯â€œä¸»â€å†…å­˜åŒºåŸŸçš„i2æ•°å€¼ã€‚ç”¨volatileä¿®é¥°åçš„å˜é‡ä¸å…è®¸æœ‰ä¸åŒäºâ€œä¸»â€å†…å­˜åŒºåŸŸçš„å˜é‡æ‹·è´ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªå˜é‡ç» volatileä¿®é¥°ååœ¨æ‰€æœ‰çº¿ç¨‹ä¸­å¿…é¡»æ˜¯åŒæ­¥çš„ï¼›ä»»ä½•çº¿ç¨‹ä¸­æ”¹å˜äº†å®ƒçš„å€¼ï¼Œæ‰€æœ‰å…¶ä»–çº¿ç¨‹ç«‹å³è·å–åˆ°äº†ç›¸åŒçš„å€¼ã€‚ç†æ‰€å½“ç„¶çš„ï¼Œvolatileä¿®é¥°çš„å˜é‡å­˜å–æ—¶æ¯”ä¸€èˆ¬å˜é‡æ¶ˆè€—çš„èµ„æºè¦å¤šä¸€ç‚¹ï¼Œå› ä¸ºçº¿ç¨‹æœ‰å®ƒè‡ªå·±çš„å˜é‡æ‹·è´æ›´ä¸ºé«˜æ•ˆã€‚<br>ã€€ã€€æ—¢ç„¶volatileå…³é”®å­—å·²ç»å®ç°äº†çº¿ç¨‹é—´æ•°æ®åŒæ­¥ï¼Œåˆè¦ synchronizedå¹²ä»€ä¹ˆå‘¢ï¼Ÿå‘µå‘µï¼Œå®ƒä»¬ä¹‹é—´æœ‰ä¸¤ç‚¹ä¸åŒã€‚é¦–å…ˆï¼Œsynchronizedè·å¾—å¹¶é‡Šæ”¾ç›‘è§†å™¨â€”â€”å¦‚æœä¸¤ä¸ªçº¿ç¨‹ä½¿ç”¨äº†åŒä¸€ä¸ªå¯¹è±¡é”ï¼Œç›‘è§†å™¨èƒ½å¼ºåˆ¶ä¿è¯ä»£ç å—åŒæ—¶åªè¢«ä¸€ä¸ªçº¿ç¨‹æ‰€æ‰§è¡Œâ€”â€”è¿™æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„äº‹å®ã€‚ä½†æ˜¯ï¼Œsynchronizedä¹ŸåŒæ­¥å†…å­˜ï¼šäº‹å®ä¸Šï¼Œsynchronizedåœ¨â€œ ä¸»â€å†…å­˜åŒºåŸŸåŒæ­¥æ•´ä¸ªçº¿ç¨‹çš„å†…å­˜ã€‚å› æ­¤ï¼Œæ‰§è¡Œgeti3()æ–¹æ³•åšäº†å¦‚ä¸‹å‡ æ­¥ï¼š</p><pre><code>çº¿ç¨‹è¯·æ±‚è·å¾—ç›‘è§†thiså¯¹è±¡çš„å¯¹è±¡é”ï¼ˆå‡è®¾æœªè¢«é”ï¼Œå¦åˆ™çº¿ç¨‹ç­‰å¾…ç›´åˆ°é”é‡Šæ”¾ï¼‰çº¿ç¨‹å†…å­˜çš„æ•°æ®è¢«æ¶ˆé™¤ï¼Œä»â€œä¸»â€å†…å­˜åŒºåŸŸä¸­è¯»å…¥ï¼ˆJavaè™šæ‹Ÿæœºèƒ½ä¼˜åŒ–æ­¤æ­¥ã€‚ã€‚ã€‚[åé¢çš„ä¸çŸ¥é“æ€ä¹ˆè¡¨è¾¾,æ±—]ï¼‰ä»£ç å—è¢«æ‰§è¡Œå¯¹äºå˜é‡çš„ä»»ä½•æ”¹å˜ç°åœ¨å¯ä»¥å®‰å…¨åœ°å†™åˆ°â€œä¸»â€å†…å­˜åŒºåŸŸä¸­ï¼ˆä¸è¿‡geti3()æ–¹æ³•ä¸ä¼šæ”¹å˜å˜é‡å€¼ï¼‰çº¿ç¨‹é‡Šæ”¾ç›‘è§†thiså¯¹è±¡çš„å¯¹è±¡é”ã€€ã€€å› æ­¤volatileåªæ˜¯åœ¨çº¿ç¨‹å†…å­˜å’Œâ€œä¸»â€å†…å­˜é—´åŒæ­¥æŸä¸ªå˜é‡çš„å€¼ï¼Œè€Œsynchronizedé€šè¿‡é”å®šå’Œè§£é”æŸä¸ªç›‘è§†å™¨åŒæ­¥æ‰€æœ‰å˜é‡çš„å€¼ã€‚æ˜¾ç„¶synchronizedè¦æ¯”volatileæ¶ˆè€—æ›´å¤šèµ„æºã€‚volatileå…³é”®å­—ç›¸ä¿¡äº†è§£Javaå¤šçº¿ç¨‹çš„è¯»è€…éƒ½å¾ˆæ¸…æ¥šå®ƒçš„ä½œç”¨ã€‚volatileå…³é”®å­—ç”¨äºå£°æ˜ç®€å•ç±»å‹å˜é‡ï¼Œå¦‚intã€floatã€ booleanç­‰æ•°æ®ç±»å‹ã€‚å¦‚æœè¿™äº›ç®€å•æ•°æ®ç±»å‹å£°æ˜ä¸ºvolatileï¼Œå¯¹å®ƒä»¬çš„æ“ä½œå°±ä¼šå˜æˆåŸå­çº§åˆ«çš„ã€‚ä½†è¿™æœ‰ä¸€å®šçš„é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä¾‹å­ä¸­çš„nå°±ä¸æ˜¯åŸå­çº§åˆ«çš„ï¼š</code></pre><p>package  mythread;  </p><p>public   class  JoinThread  extends  Thread<br>{<br>     public   static volatile int  n  =   0 ;<br>    public   void  run()<br>    {<br>         for  ( int  i  =   0 ; i  &lt;   10 ; i ++ )<br>             try<br>        {<br>                n  =  n  +   1 ;<br>                sleep( 3 );  //  ä¸ºäº†ä½¿è¿è¡Œç»“æœæ›´éšæœºï¼Œå»¶è¿Ÿ3æ¯«ç§’   </p><pre><code>        }           catch  (Exception e)          {          }  }   public   static   void  main(String[] args)  throws  Exception  {      Thread threads[]  =   new  Thread[ 100 ];       for  ( int  i  =   0 ; i  &lt;  threads.length; i ++ )           //  å»ºç«‹100ä¸ªçº¿ç¨‹           threads[i]  =   new  JoinThread();       for  ( int  i  =   0 ; i  &lt;  threads.length; i ++ )           //  è¿è¡Œåˆšæ‰å»ºç«‹çš„100ä¸ªçº¿ç¨‹           threads[i].start();       for  ( int  i  =   0 ; i  &lt;  threads.length; i ++ )           //  100ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œå®Œåç»§ç»­           threads[i].join();      System.out.println( &quot; n= &quot;   +  JoinThread.n);  }  </code></pre><p>}   </p><p>å¦‚æœå¯¹nçš„æ“ä½œæ˜¯åŸå­çº§åˆ«çš„ï¼Œæœ€åè¾“å‡ºçš„ç»“æœåº”è¯¥ä¸ºn=1000ï¼Œè€Œåœ¨æ‰§è¡Œä¸Šé¢ç§¯ä»£ç æ—¶ï¼Œå¾ˆå¤šæ—¶ä¾¯è¾“å‡ºçš„néƒ½å°äº1000ï¼Œè¿™è¯´æ˜n=n+1ä¸æ˜¯åŸå­çº§åˆ«çš„æ“ä½œã€‚åŸå› æ˜¯å£°æ˜ä¸ºvolatileçš„ç®€å•å˜é‡å¦‚æœå½“å‰å€¼ç”±è¯¥å˜é‡ä»¥å‰çš„å€¼ç›¸å…³ï¼Œé‚£ä¹ˆvolatileå…³é”®å­—ä¸èµ·ä½œç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚ä¸‹çš„è¡¨è¾¾å¼éƒ½ä¸æ˜¯åŸå­æ“ä½œï¼š</p><p>n  =  n  +   1 ;<br>n ++ ; </p><p>å¦‚æœè¦æƒ³ä½¿è¿™ç§æƒ…å†µå˜æˆåŸå­æ“ä½œï¼Œéœ€è¦ä½¿ç”¨synchronizedå…³é”®å­—ï¼Œå¦‚ä¸Šçš„ä»£ç å¯ä»¥æ”¹æˆå¦‚ä¸‹çš„å½¢å¼ï¼š</p><p>package  mythread;  </p><p>public   class  JoinThread  extends  Thread<br>{<br>     public   static int  n  =   0 ;  </p><pre><code> public static   synchronized   void  inc()  {      n ++ ;  }   public   void  run()  {       for  ( int  i  =   0 ; i  &lt;   10 ; i ++ )           try           {              inc();  //  n = n + 1 æ”¹æˆäº† inc();               sleep( 3 );  //  ä¸ºäº†ä½¿è¿è¡Œç»“æœæ›´éšæœºï¼Œå»¶è¿Ÿ3æ¯«ç§’           }           catch  (Exception e)          {          }  }   public   static   void  main(String[] args)  throws  Exception  {      Thread threads[]  =   new  Thread[ 100 ];       for  ( int  i  =   0 ; i  &lt;  threads.length; i ++ )           //  å»ºç«‹100ä¸ªçº¿ç¨‹           threads[i]  =   new  JoinThread();       for  ( int  i  =   0 ; i  &lt;  threads.length; i ++ )           //  è¿è¡Œåˆšæ‰å»ºç«‹çš„100ä¸ªçº¿ç¨‹           threads[i].start();       for  ( int  i  =   0 ; i  &lt;  threads.length; i ++ )           //  100ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œå®Œåç»§ç»­           threads[i].join();      System.out.println( &quot; n= &quot;   +  JoinThread.n);  }  </code></pre><p>}   </p><p>ä¸Šé¢çš„ä»£ç å°†n=n+1æ”¹æˆäº†inc()ï¼Œå…¶ä¸­incæ–¹æ³•ä½¿ç”¨äº†synchronizedå…³é”®å­—è¿›è¡Œæ–¹æ³•åŒæ­¥ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨volatileå…³é”®å­—æ—¶è¦æ…é‡ï¼Œå¹¶ä¸æ˜¯åªè¦ç®€å•ç±»å‹å˜é‡ä½¿ç”¨volatileä¿®é¥°ï¼Œå¯¹è¿™ä¸ªå˜é‡çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸæ¥æ“ä½œï¼Œå½“å˜é‡çš„å€¼ç”±è‡ªèº«çš„ä¸Šä¸€ä¸ªå†³å®šæ—¶ï¼Œå¦‚n=n+1ã€n++ ç­‰ï¼Œvolatileå…³é”®å­—å°†å¤±æ•ˆï¼Œåªæœ‰å½“å˜é‡çš„å€¼å’Œè‡ªèº«ä¸Šä¸€ä¸ªå€¼æ— å…³æ—¶å¯¹è¯¥å˜é‡çš„æ“ä½œæ‰æ˜¯åŸå­çº§åˆ«çš„ï¼Œå¦‚n = m + 1ï¼Œè¿™ä¸ªå°±æ˜¯åŸçº§åˆ«çš„ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨volatileå…³é”®æ—¶ä¸€å®šè¦è°¨æ…ï¼Œå¦‚æœè‡ªå·±æ²¡æœ‰æŠŠæ¡ï¼Œå¯ä»¥ä½¿ç”¨synchronizedæ¥ä»£æ›¿volatileã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Volatileç”¨åœ¨å¤šçº¿ç¨‹ï¼ŒåŒæ­¥å˜é‡ã€‚ çº¿ç¨‹ä¸ºäº†æé«˜æ•ˆç‡ï¼Œå°†æŸæˆå‘˜å˜é‡(å¦‚A)æ‹·è´äº†ä¸€ä»½ï¼ˆå¦‚Bï¼‰ï¼Œçº¿ç¨‹ä¸­å¯¹Açš„è®¿é—®å…¶å®è®¿é—®çš„æ˜¯Bã€‚åªåœ¨æŸäº›åŠ¨ä½œæ—¶æ‰è¿›è¡ŒAå’ŒBçš„åŒæ­¥ã€‚å› æ­¤å­˜åœ¨Aå’ŒBä¸ä¸€è‡´çš„æƒ…å†µã€‚volatileå°±æ˜¯ç”¨æ¥é¿å…è¿™ç§æƒ…å†µçš„ã€‚volatileå‘Šè¯‰jvmï¼Œ å®ƒæ‰€ä¿®é¥°çš„å˜é‡ä¸ä¿ç•™æ‹·è´ï¼Œç›´æ¥è®¿é—®ä¸»å†…å­˜ä¸­çš„ï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢è¯´çš„A)&lt;/p&gt;
&lt;p&gt;åœ¨Javaå†…å­˜æ¨¡å‹ä¸­ï¼Œæœ‰main memoryï¼Œæ¯ä¸ªçº¿ç¨‹ä¹Ÿæœ‰è‡ªå·±çš„memory (ä¾‹å¦‚å¯„å­˜å™¨)ã€‚ä¸ºäº†æ€§èƒ½ï¼Œä¸€ä¸ªçº¿ç¨‹ä¼šåœ¨è‡ªå·±çš„memoryä¸­ä¿æŒè¦è®¿é—®çš„å˜é‡çš„å‰¯æœ¬ã€‚è¿™æ ·å°±ä¼šå‡ºç°åŒä¸€ä¸ªå˜é‡åœ¨æŸä¸ªç¬é—´ï¼Œåœ¨ä¸€ä¸ªçº¿ç¨‹çš„memoryä¸­çš„å€¼å¯èƒ½ä¸å¦å¤–ä¸€ä¸ªçº¿ç¨‹memoryä¸­çš„å€¼ï¼Œæˆ–è€…main memoryä¸­çš„å€¼ä¸ä¸€è‡´çš„æƒ…å†µã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="java" scheme="http://yifanzhang13.github.io/categories/java/"/>
    
    
      <category term="concurrency" scheme="http://yifanzhang13.github.io/tags/concurrency/"/>
    
  </entry>
  
  <entry>
    <title>First Blog</title>
    <link href="http://yifanzhang13.github.io/2019/11/14/First-Blog/"/>
    <id>http://yifanzhang13.github.io/2019/11/14/First-Blog/</id>
    <published>2019-11-14T02:32:05.000Z</published>
    <updated>2020-04-01T00:43:59.736Z</updated>
    
    <content type="html"><![CDATA[<p>Hello World!</p><p>Personal Blog Test!</p><p>Done!</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hello World!&lt;/p&gt;
&lt;p&gt;Personal Blog Test!&lt;/p&gt;
&lt;p&gt;Done!&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="Hello World!" scheme="http://yifanzhang13.github.io/categories/Hello-World/"/>
    
    
      <category term="Hello World!" scheme="http://yifanzhang13.github.io/tags/Hello-World/"/>
    
  </entry>
  
</feed>
